<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Régua de Comunicação CS | Wise Up</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<!-- SheetJS for Excel export -->
<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
<!-- Chart.js for charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
/* ═══════════════════════════════════════════════════════════
   TOKENS – WISE UP BLUE RETRO-FUTURISTIC THEME
   ═══════════════════════════════════════════════════════════ */
:root {
  /* Wise Up Blue Palette */
  --wu-blue: #0066FF;
  --wu-blue-dark: #0052CC;
  --wu-blue-light: #3385FF;
  --wu-blue-glow: rgba(0, 102, 255, 0.4);
  --wu-cyan: #00D9FF;
  --wu-cyan-glow: rgba(0, 217, 255, 0.3);
  
  /* Background & Surfaces */
  --bg: #0A0E1A;
  --bg-pattern: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 102, 255, 0.03) 2px,
    rgba(0, 102, 255, 0.03) 4px
  );
  --surface: #0F1525;
  --card: #141B2E;
  --card-hi: #1A2339;
  --card-glow: rgba(0, 102, 255, 0.1);
  
  /* Borders & Separators */
  --border: rgba(0, 102, 255, 0.15);
  --border-hi: rgba(0, 102, 255, 0.35);
  --border-glow: rgba(0, 217, 255, 0.5);
  
  /* Text */
  --txt1: #E8F0FF;
  --txt2: #94A8D8;
  --txt3: #5A6B8F;
  
  /* Accent Colors */
  --accent: var(--wu-blue);
  --accent-lo: rgba(0, 102, 255, 0.12);
  --accent-hi: var(--wu-blue-light);
  
  /* Semantic Colors - Integrados ao tema azul futurista */
  --green: #00FFB3;
  --green-lo: rgba(0, 255, 179, 0.12);
  --green-glow: rgba(0, 255, 179, 0.3);
  --amber: #FFD700;
  --amber-lo: rgba(255, 215, 0, 0.12);
  --amber-glow: rgba(255, 215, 0, 0.3);
  --rose: #FF3366;
  --rose-lo: rgba(255, 51, 102, 0.12);
  --rose-glow: rgba(255, 51, 102, 0.3);
  --purple: #9D5CFF;
  --purple-lo: rgba(157, 92, 255, 0.12);
  --teal: #00DDB3;
  --teal-lo: rgba(0, 221, 179, 0.12);
  
  /* Cenários de Frequência */
  --cenario-alta: var(--green);
  --cenario-alta-bg: rgba(0, 255, 179, 0.08);
  --cenario-alta-border: rgba(0, 255, 179, 0.3);
  
  --cenario-baixa: var(--amber);
  --cenario-baixa-bg: rgba(255, 215, 0, 0.08);
  --cenario-baixa-border: rgba(255, 215, 0, 0.3);
  
  --cenario-zero: var(--rose);
  --cenario-zero-bg: rgba(255, 51, 102, 0.08);
  --cenario-zero-border: rgba(255, 51, 102, 0.3);
  
  /* Holographic Effects */
  --holo-gradient: linear-gradient(
    135deg,
    var(--wu-blue) 0%,
    var(--wu-cyan) 50%,
    var(--purple) 100%
  );
  --holo-border: linear-gradient(
    90deg,
    transparent,
    var(--wu-cyan),
    transparent
  );
  
  /* Grid Pattern */
  --grid-pattern: 
    linear-gradient(var(--border) 1px, transparent 1px),
    linear-gradient(90deg, var(--border) 1px, transparent 1px);
  --grid-size: 40px 40px;
  
  /* Shadows */
  --shadow-sm: 0 2px 8px rgba(0, 102, 255, 0.1);
  --shadow-md: 0 4px 16px rgba(0, 102, 255, 0.15);
  --shadow-lg: 0 8px 32px rgba(0, 102, 255, 0.2);
  --glow: 0 0 20px var(--wu-blue-glow);
}

:root.light {
  --bg: #F5F8FF;
  --bg-pattern: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 102, 255, 0.02) 2px,
    rgba(0, 102, 255, 0.02) 4px
  );
  --surface: #FFFFFF;
  --card: #FFFFFF;
  --card-hi: #F0F4FF;
  --card-glow: rgba(0, 102, 255, 0.05);
  
  --border: rgba(0, 102, 255, 0.12);
  --border-hi: rgba(0, 102, 255, 0.25);
  --border-glow: rgba(0, 217, 255, 0.4);
  
  --txt1: #0A1633;
  --txt2: #3D5280;
  --txt3: #7A8BAD;
  
  --accent: var(--wu-blue);
  --accent-lo: rgba(0, 102, 255, 0.08);
  
  --cenario-alta-bg: rgba(0, 255, 179, 0.1);
  --cenario-baixa-bg: rgba(255, 215, 0, 0.1);
  --cenario-zero-bg: rgba(255, 51, 102, 0.1);
  
  --shadow-sm: 0 2px 8px rgba(0, 102, 255, 0.08);
  --shadow-md: 0 4px 16px rgba(0, 102, 255, 0.12);
  --shadow-lg: 0 8px 32px rgba(0, 102, 255, 0.15);
  --glow: 0 0 20px rgba(0, 102, 255, 0.2);
}

/* ═══════════════════════════════════════════════════════════
   RESET & BASE
   ═══════════════════════════════════════════════════════════ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  font-family: 'Outfit', sans-serif;
  background: var(--bg);
  color: var(--txt1);
  min-height: 100vh;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  padding: 24px 18px 80px;
  transition: background 0.4s ease, color 0.4s ease;
  position: relative;
  overflow-x: hidden;
}

/* Grid Pattern Background */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--bg-pattern);
  background-size: var(--grid-size);
  opacity: 1;
  pointer-events: none;
  z-index: 0;
}

body::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--grid-pattern);
  background-size: var(--grid-size);
  opacity: 0.3;
  pointer-events: none;
  z-index: 0;
  animation: gridPulse 4s ease-in-out infinite;
}

@keyframes gridPulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.1; }
}

.wrap {
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
  z-index: 1;
}

code, .mono {
  font-family: 'JetBrains Mono', monospace;
}

/* ═══════════════════════════════════════════════════════════
   HEADER
   ═══════════════════════════════════════════════════════════ */
.header {
  text-align: center;
  padding: 40px 20px 32px;
  position: relative;
  margin-bottom: 32px;
}

.header::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 300px;
  height: 300px;
  background: radial-gradient(circle, var(--wu-blue-glow) 0%, transparent 70%);
  filter: blur(60px);
  opacity: 0.3;
  animation: headerGlow 3s ease-in-out infinite;
  pointer-events: none;
}

@keyframes headerGlow {
  0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
  50% { opacity: 0.5; transform: translate(-50%, -50%) scale(1.1); }
}

.header h1 {
  font-family: 'Outfit', sans-serif;
  font-size: 3rem;
  font-weight: 800;
  background: var(--holo-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: -1px;
  margin-bottom: 8px;
  position: relative;
  animation: titleGlow 2s ease-in-out infinite;
}

@keyframes titleGlow {
  0%, 100% { filter: drop-shadow(0 0 10px var(--wu-blue-glow)); }
  50% { filter: drop-shadow(0 0 20px var(--wu-cyan-glow)); }
}

.header .subtitle {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.85rem;
  color: var(--txt3);
  letter-spacing: 2px;
  text-transform: uppercase;
  font-weight: 500;
}

.header-line {
  width: 60px;
  height: 3px;
  background: var(--holo-gradient);
  margin: 20px auto 0;
  border-radius: 3px;
  box-shadow: var(--glow);
  animation: lineSlide 2s ease-in-out infinite;
}

@keyframes lineSlide {
  0%, 100% { width: 60px; }
  50% { width: 80px; }
}

/* ═══════════════════════════════════════════════════════════
   TOP BAR & THEME TOGGLE
   ═══════════════════════════════════════════════════════════ */
.top-bar {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 16px;
  gap: 12px;
}

.theme-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 8px 16px;
  cursor: pointer;
  color: var(--txt2);
  font-size: 0.85rem;
  font-weight: 500;
  transition: all 0.3s ease;
  font-family: inherit;
  position: relative;
  overflow: hidden;
}

.theme-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: var(--holo-border);
  transition: left 0.3s ease;
}

.theme-btn:hover::before {
  left: 100%;
}

.theme-btn:hover {
  border-color: var(--border-hi);
  color: var(--txt1);
  box-shadow: var(--shadow-sm);
}

/* ═══════════════════════════════════════════════════════════
   TABS
   ═══════════════════════════════════════════════════════════ */
.tabs {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 6px;
  margin-bottom: 32px;
  box-shadow: var(--shadow-sm);
  position: relative;
}

.tabs::before {
  content: '';
  position: absolute;
  inset: -1px;
  background: var(--holo-gradient);
  border-radius: 16px;
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: -1;
}

.tabs:hover::before {
  opacity: 0.1;
}

.tab {
  text-align: center;
  padding: 12px 8px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--txt3);
  transition: all 0.3s ease;
  border: 1px solid transparent;
  user-select: none;
  position: relative;
  overflow: hidden;
}

.tab::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--accent-lo);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.tab:hover {
  color: var(--txt2);
  background: var(--card);
}

.tab.active {
  background: var(--card);
  color: var(--accent);
  border-color: var(--border-hi);
  box-shadow: var(--shadow-md), inset 0 0 20px var(--card-glow);
}

.tab.active::before {
  opacity: 1;
}

/* Tab Content */
.tab-content {
  display: none;
  animation: fadeUp 0.4s ease;
}

.tab-content.active {
  display: block;
}

@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ═══════════════════════════════════════════════════════════
   CARDS & SECTIONS
   ═══════════════════════════════════════════════════════════ */
.section-title {
  font-family: 'Outfit', sans-serif;
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 8px;
  background: var(--holo-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.section-subtitle {
  color: var(--txt3);
  font-size: 0.95rem;
  margin-bottom: 24px;
  line-height: 1.7;
}

.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 16px;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 2px;
  height: 100%;
  background: var(--holo-gradient);
  transition: left 0.5s ease;
}

.card:hover::before {
  left: 100%;
}

.card:hover {
  border-color: var(--border-hi);
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

/* ═══════════════════════════════════════════════════════════
   HERO SECTION (RESUMO TAB)
   ═══════════════════════════════════════════════════════════ */
.hero-section {
  background: var(--card);
  border: 1px solid var(--border-hi);
  border-radius: 20px;
  padding: 40px 32px;
  margin-bottom: 32px;
  position: relative;
  overflow: hidden;
}

.hero-section::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 100%;
  height: 100%;
  background: radial-gradient(circle, var(--wu-cyan-glow) 0%, transparent 70%);
  animation: heroFloat 6s ease-in-out infinite;
  pointer-events: none;
}

@keyframes heroFloat {
  0%, 100% { transform: translate(0, 0); }
  50% { transform: translate(-20px, -20px); }
}

.hero-section h2 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 16px;
  color: var(--txt1);
}

.hero-section p {
  color: var(--txt2);
  font-size: 1.05rem;
  line-height: 1.8;
  margin-bottom: 16px;
}

.hero-highlights {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-top: 24px;
}

.highlight-item {
  background: var(--card-hi);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px;
  text-align: center;
  transition: all 0.3s ease;
}

.highlight-item:hover {
  border-color: var(--accent);
  box-shadow: 0 0 20px var(--accent-lo);
  transform: translateY(-4px);
}

.highlight-icon {
  font-size: 1.5rem;
  margin-bottom: 6px;
  filter: drop-shadow(0 0 10px var(--wu-blue-glow));
}

.highlight-label {
  font-size: 0.7rem;
  color: var(--txt3);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 600;
  margin-bottom: 4px;
}

.highlight-value {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--accent);
  font-family: 'JetBrains Mono', monospace;
}

/* Responsive */
@media (max-width: 768px) {
  .hero-highlights {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ═══════════════════════════════════════════════════════════
   FILTERS (LINHA DO TEMPO)
   ═══════════════════════════════════════════════════════════ */
.filter-bar {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  padding: 16px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 14px;
  flex-wrap: wrap;
  align-items: center;
}

.filter-label {
  font-size: 0.8rem;
  color: var(--txt3);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-family: 'JetBrains Mono', monospace;
}

.filter-btn {
  padding: 8px 16px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--card);
  color: var(--txt2);
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: inherit;
  position: relative;
  overflow: hidden;
}

.filter-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--accent-lo);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.filter-btn:hover {
  border-color: var(--border-hi);
  color: var(--txt1);
}

.filter-btn.active {
  background: var(--accent-lo);
  border-color: var(--accent);
  color: var(--accent);
  box-shadow: 0 0 20px var(--accent-lo);
}

.filter-btn.active::before {
  opacity: 1;
}

/* ═══════════════════════════════════════════════════════════
   RESPONSIVE
   ═══════════════════════════════════════════════════════════ */
@media (max-width: 768px) {
  .header h1 {
    font-size: 2rem;
  }
  
  .tabs {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .hero-section {
    padding: 24px 20px;
  }
  
  .filter-bar {
    flex-direction: column;
    align-items: stretch;
  }
  
  .filter-btn {
    width: 100%;
  }
}

@media (max-width: 480px) {
  body {
    padding: 16px 12px 60px;
  }
  
  .header h1 {
    font-size: 1.75rem;
  }
  
  .tabs {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  /* Força 1 coluna em telas pequenas para os cards de implementação */
  [style*="grid-template-columns:repeat(auto-fit,minmax(320px,1fr))"] {
    grid-template-columns: 1fr !important;
  }
}

/* ═══════════════════════════════════════════════════════════
   PHASE TIMELINE
   ═══════════════════════════════════════════════════════════ */
.phase {
  margin-bottom: 32px;
  padding-left: 32px;
  position: relative;
}

.phase::before {
  content: '';
  position: absolute;
  left: 12px;
  top: 24px;
  bottom: 0;
  width: 2px;
  background: linear-gradient(to bottom, var(--phase-color), transparent);
  opacity: 0.3;
}

.phase::after {
  content: '';
  position: absolute;
  left: 7px;
  top: 19px;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--phase-color);
  box-shadow: 0 0 15px var(--phase-color);
  z-index: 1;
  animation: phasePulse 2s ease-in-out infinite;
}

@keyframes phasePulse {
  0%, 100% { box-shadow: 0 0 15px var(--phase-color); }
  50% { box-shadow: 0 0 25px var(--phase-color); }
}

.phase-pre { --phase-color: var(--green); }
.phase-zero { --phase-color: var(--wu-blue); }
.phase-30 { --phase-color: var(--amber); }
.phase-marcos { --phase-color: var(--purple); }
.phase-nutricao { --phase-color: var(--rose); }

.phase-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 12px;
}

.phase-title {
  font-family: 'Outfit', sans-serif;
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--txt1);
}

.phase-badge {
  font-size: 0.75rem;
  font-weight: 600;
  padding: 4px 12px;
  border-radius: 20px;
  color: var(--phase-color);
  background: color-mix(in srgb, var(--phase-color) 15%, transparent);
  border: 1px solid color-mix(in srgb, var(--phase-color) 30%, transparent);
  font-family: 'JetBrains Mono', monospace;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* ═══════════════════════════════════════════════════════════
   MESSAGE CARDS
   ═══════════════════════════════════════════════════════════ */
.msg-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 20px;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.msg-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 3px;
  height: 100%;
  background: var(--accent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.msg-card:hover {
  border-color: var(--border-hi);
  box-shadow: var(--shadow-md);
  transform: translateX(2px);
}

.msg-card:hover::before {
  opacity: 1;
}

.msg-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  flex-wrap: wrap;
  gap: 12px;
  margin-bottom: 12px;
}

.msg-title {
  font-weight: 600;
  font-size: 0.95rem;
  color: var(--txt1);
}

.msg-timing {
  font-size: 0.75rem;
  color: var(--accent);
  background: var(--accent-lo);
  padding: 4px 12px;
  border-radius: 12px;
  font-weight: 600;
  font-family: 'JetBrains Mono', monospace;
  border: 1px solid var(--accent);
  box-shadow: 0 0 10px var(--accent-lo);
}

.msg-meta {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 12px;
  align-items: center;
}

.msg-channel {
  font-size: 0.75rem;
  color: var(--green);
  background: var(--green-lo);
  padding: 4px 10px;
  border-radius: 8px;
  font-weight: 600;
  font-family: 'JetBrains Mono', monospace;
  border: 1px solid var(--green);
}

.msg-body {
  color: var(--txt2);
  font-size: 0.9rem;
  line-height: 1.8;
  margin-bottom: 12px;
}

.msg-text {
  position: relative;
  background: var(--card-hi);
  border-left: 3px solid var(--accent);
  border-radius: 0 12px 12px 0;
  padding: 16px;
  margin-top: 12px;
  color: var(--txt2);
  font-size: 0.9rem;
  line-height: 1.8;
  font-style: italic;
}

/* ═══════════════════════════════════════════════════════════
   TAGS
   ═══════════════════════════════════════════════════════════ */
.tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 0.7rem;
  font-weight: 700;
  padding: 3px 10px;
  border-radius: 8px;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  font-family: 'JetBrains Mono', monospace;
  border: 1px solid;
}

.tag-celebracao { color: var(--amber); background: var(--amber-lo); border-color: var(--amber); }
.tag-Celebração { color: var(--amber); background: var(--amber-lo); border-color: var(--amber); }
.tag-dica { color: var(--wu-blue); background: var(--accent-lo); border-color: var(--accent); }
.tag-Dica { color: var(--wu-blue); background: var(--accent-lo); border-color: var(--accent); }
.tag-lembrete { color: var(--purple); background: var(--purple-lo); border-color: var(--purple); }
.tag-Lembrete { color: var(--purple); background: var(--purple-lo); border-color: var(--purple); }
.tag-engajamento { color: var(--teal); background: var(--teal-lo); border-color: var(--teal); }
.tag-Engajamento { color: var(--teal); background: var(--teal-lo); border-color: var(--teal); }
.tag-checkpoint { color: var(--accent); background: var(--accent-lo); border-color: var(--accent); }
.tag-noticias { color: var(--rose); background: var(--rose-lo); border-color: var(--rose); }
.tag-operacional { color: var(--green); background: var(--green-lo); border-color: var(--green); }
.tag-Operacional { color: var(--green); background: var(--green-lo); border-color: var(--green); }
.tag-GATILHO { color: var(--amber); background: var(--amber-lo); border-color: var(--amber); }
.tag-COMPORTAMENTAL { color: var(--amber); background: var(--amber-lo); border-color: var(--amber); }
.tag-GATILHO-COMPORTAMENTAL { color: var(--amber); background: var(--amber-lo); border-color: var(--amber); font-size: 0.65rem; }

/* ═══════════════════════════════════════════════════════════
   GATILHOS & RECUPERAÇÃO
   ═══════════════════════════════════════════════════════════ */
.gatilho-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-left: 4px solid var(--amber);
  border-radius: 14px;
  padding: 20px;
  margin-bottom: 16px;
  transition: all 0.3s ease;
}

.gatilho-card:hover {
  border-color: var(--amber);
  box-shadow: 0 0 20px var(--amber-lo);
  transform: translateX(4px);
}

/* ═══════════════════════════════════════════════════════════
   CENÁRIOS DE FREQUÊNCIA
   ═══════════════════════════════════════════════════════════ */
.cenarios-container {
  margin-top: 20px;
  display: grid;
  gap: 12px;
}

.cenario-card {
  background: var(--card-hi);
  border: 2px solid;
  border-radius: 12px;
  padding: 16px;
  transition: all 0.3s ease;
  position: relative;
}

.cenario-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.cenario-alta {
  border-color: var(--cenario-alta-border);
  background: var(--cenario-alta-bg);
}

.cenario-alta:hover {
  box-shadow: 0 4px 16px var(--green-glow);
}

.cenario-baixa {
  border-color: var(--cenario-baixa-border);
  background: var(--cenario-baixa-bg);
}

.cenario-baixa:hover {
  box-shadow: 0 4px 16px var(--amber-glow);
}

.cenario-zero {
  border-color: var(--cenario-zero-border);
  background: var(--cenario-zero-bg);
}

.cenario-zero:hover {
  box-shadow: 0 4px 16px var(--rose-glow);
}

.cenario-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
}

.cenario-icon {
  font-size: 1.5rem;
  line-height: 1;
}

.cenario-title {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--txt1);
  font-family: 'Outfit', sans-serif;
}

.cenario-condition {
  font-size: 0.75rem;
  color: var(--txt3);
  font-family: 'JetBrains Mono', monospace;
  margin-top: 2px;
}

.cenario-message {
  font-size: 0.9rem;
  color: var(--txt2);
  line-height: 1.6;
  margin-bottom: 12px;
  padding: 12px;
  background: var(--card);
  border-radius: 8px;
}

.collapse-btn {
  transition: all 0.3s ease;
}

/* ═══════════════════════════════════════════════════════════
   NOVO LAYOUT - JORNADA COMPLETA INTERATIVA
   ═══════════════════════════════════════════════════════════ */

.journey-phase {
  margin-bottom: 32px;
}

.phase-header-new {
  background: linear-gradient(135deg, var(--card-hi) 0%, var(--card) 100%);
  border: 1px solid var(--border-hi);
  border-radius: 12px;
  padding: 16px 20px;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 16px;
  box-shadow: var(--shadow-sm);
  position: relative;
  overflow: hidden;
}

.phase-header-new::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  background: var(--holo-gradient);
}

.phase-number-new {
  font-family: 'JetBrains Mono', monospace;
  font-size: 1.5rem;
  font-weight: 700;
  background: var(--holo-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  min-width: 80px;
}

/* Badge de Semanas Livres */
.free-weeks-badge {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.75rem;
  padding: 6px 12px;
  border-radius: 6px;
  background: var(--surface);
  border: 1px dashed var(--border);
  color: var(--txt3);
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 6px;
  opacity: 0.7;
  transition: opacity 0.3s ease;
}

.free-weeks-badge:hover {
  opacity: 1;
  border-color: var(--border-hi);
}

/* Modal de Observações */
.obs-modal-content {
  background: var(--card);
  border: 1px solid var(--border-hi);
  border-radius: 16px;
  max-width: 600px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: var(--shadow-lg);
  animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.obs-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 24px;
  border-bottom: 1px solid var(--border);
  background: linear-gradient(135deg, var(--card-hi) 0%, var(--card) 100%);
  border-radius: 16px 16px 0 0;
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--txt1);
}

.obs-modal-close {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--txt2);
  font-size: 1.5rem;
  line-height: 1;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.obs-modal-close:hover {
  background: var(--rose);
  color: white;
  border-color: var(--rose);
  transform: scale(1.1);
}

.obs-modal-body {
  padding: 24px;
  color: var(--txt2);
  line-height: 1.8;
  font-size: 0.95rem;
}

.phase-info-new {
  flex: 1;
}

.phase-name-new {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 4px;
}

.phase-period-new {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.85rem;
  color: var(--txt3);
}

.week-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 12px;
}

/* Card de Mensagem Compacto */
.message-card-compact {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 14px;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.message-card-compact::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 3px;
  height: 100%;
  background: var(--accent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.message-card-compact:hover {
  border-color: var(--border-hi);
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.message-card-compact:hover::before {
  opacity: 1;
}

.message-header-compact {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 10px;
  gap: 8px;
}

.message-week {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.75rem;
  color: var(--txt3);
  background: var(--surface);
  padding: 3px 8px;
  border-radius: 4px;
  border: 1px solid var(--border);
  white-space: nowrap;
}

.message-actions {
  display: flex;
  gap: 6px;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.message-card-compact:hover .message-actions {
  opacity: 1;
}

.action-btn {
  width: 24px;
  height: 24px;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--txt2);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  transition: all 0.2s ease;
}

.action-btn:hover {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
  transform: scale(1.1);
}

.message-title-compact {
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 8px;
  line-height: 1.3;
}

.message-meta-compact {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 10px;
}

.meta-badge {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.7rem;
  padding: 3px 8px;
  border-radius: 4px;
  border: 1px solid;
  display: flex;
  align-items: center;
  gap: 4px;
  white-space: nowrap;
}

.meta-badge.timing {
  background: var(--purple-lo);
  border-color: var(--purple);
  color: var(--purple);
}

.meta-badge.channel {
  background: var(--accent-lo);
  border-color: var(--accent);
  color: var(--accent);
}

.meta-badge.audience {
  background: var(--teal-lo);
  border-color: var(--teal);
  color: var(--teal);
}

.meta-badge.objective {
  background: var(--green-lo);
  border-color: var(--green);
  color: var(--green);
}

.message-tags-compact {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin-bottom: 10px;
}

.tag-badge-compact {
  font-size: 0.7rem;
  padding: 2px 6px;
  border-radius: 4px;
  background: var(--accent-lo);
  color: var(--accent);
  border: 1px solid var(--border);
}

.message-preview {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.4;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  margin-bottom: 8px;
  cursor: pointer;
  transition: color 0.2s ease;
}

.message-preview:hover {
  color: var(--txt1);
}

.message-preview.expanded {
  -webkit-line-clamp: unset;
}

/* Semana Vazia */
.empty-week {
  background: transparent;
  border: 1px dashed var(--border);
  border-radius: 8px;
  padding: 12px 8px;
  text-align: center;
  opacity: 0.35;
  transition: opacity 0.3s ease;
  min-height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.empty-week:hover {
  opacity: 0.6;
}

.empty-week-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.7rem;
  color: var(--txt3);
}

/* Gatilho Card (Minimizável) */
.trigger-card {
  background: var(--card);
  border: 1px solid var(--amber);
  border-radius: 10px;
  padding: 12px;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.trigger-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 3px;
  height: 100%;
  background: var(--amber);
}

.trigger-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  padding: 4px 0;
  user-select: none;
}

.trigger-title {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--txt1);
  display: flex;
  align-items: center;
  gap: 8px;
}

.trigger-week-badge {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.7rem;
  color: var(--amber);
  background: var(--amber-lo);
  padding: 2px 6px;
  border-radius: 4px;
  border: 1px solid var(--amber);
}

.trigger-toggle {
  width: 24px;
  height: 24px;
  border-radius: 6px;
  background: var(--surface);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  color: var(--txt2);
  transition: all 0.3s ease;
}

.trigger-card.expanded .trigger-toggle {
  transform: rotate(180deg);
  background: var(--amber-lo);
  border-color: var(--amber);
  color: var(--amber);
}

.trigger-scenarios {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
}

.trigger-card.expanded .trigger-scenarios {
  max-height: 2000px;
  margin-top: 12px;
}

.scenario-item {
  background: var(--surface);
  border: 1px solid;
  border-radius: 8px;
  padding: 10px;
  margin-bottom: 8px;
}

.scenario-item:last-child {
  margin-bottom: 0;
}

.scenario-item.alta {
  border-color: var(--cenario-alta-border);
  background: var(--cenario-alta-bg);
}

.scenario-item.baixa {
  border-color: var(--cenario-baixa-border);
  background: var(--cenario-baixa-bg);
}

.scenario-item.zero {
  border-color: var(--cenario-zero-border);
  background: var(--cenario-zero-bg);
}

.scenario-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 8px;
}

.scenario-badge {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.7rem;
  padding: 3px 8px;
  border-radius: 4px;
  font-weight: 600;
  border: 1px solid;
}

.scenario-badge.alta {
  background: var(--cenario-alta);
  border-color: var(--cenario-alta);
  color: var(--card);
}

.scenario-badge.baixa {
  background: var(--cenario-baixa);
  border-color: var(--cenario-baixa);
  color: var(--card);
}

.scenario-badge.zero {
  background: var(--cenario-zero);
  border-color: var(--cenario-zero);
  color: white;
}

.scenario-preview {
  font-size: 0.8rem;
  color: var(--txt2);
  line-height: 1.3;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.scenario-meta {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
  margin-top: 6px;
}

/* Responsivo */
@media (max-width: 768px) {
  .week-grid {
    grid-template-columns: 1fr;
  }
  
  .phase-header-new {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .phase-number-new {
    min-width: auto;
  }
}

/* Animações Toast */
@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideOut {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(100px);
  }
}

.collapse-btn:hover {
  background: var(--accent-lo) !important;
  border-color: var(--accent) !important;
  color: var(--accent) !important;
}


.recuperacao-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-left: 4px solid var(--rose);
  border-radius: 14px;
  padding: 20px;
  margin-bottom: 16px;
  transition: all 0.3s ease;
}

.recuperacao-card:hover {
  border-color: var(--rose);
  box-shadow: 0 0 20px var(--rose-lo);
  transform: translateX(4px);
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  flex-wrap: wrap;
  gap: 12px;
}

.card-title {
  font-weight: 600;
  font-size: 0.95rem;
  color: var(--txt1);
  display: flex;
  align-items: center;
  gap: 8px;
}

/* ═══════════════════════════════════════════════════════════
   MESSAGE VARIANTS (Multiple options)
   ═══════════════════════════════════════════════════════════ */
.msg-variants {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

.variant-label {
  font-size: 0.8rem;
  color: var(--txt3);
  font-weight: 600;
  margin-bottom: 12px;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-family: 'JetBrains Mono', monospace;
}

.variant-option {
  background: var(--card-hi);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px 16px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
}

.variant-option::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--accent);
  opacity: 0;
  transition: opacity 0.3s ease;
  border-radius: 10px 0 0 10px;
}

.variant-option:hover {
  border-color: var(--accent);
  background: var(--card);
  transform: translateX(4px);
}

.variant-option:hover::before {
  opacity: 1;
}

.variant-option.selected {
  border-color: var(--accent);
  background: var(--accent-lo);
}

.variant-option.selected::before {
  opacity: 1;
}

.variant-number {
  display: inline-block;
  width: 24px;
  height: 24px;
  line-height: 24px;
  text-align: center;
  background: var(--accent-lo);
  color: var(--accent);
  border-radius: 50%;
  font-size: 0.75rem;
  font-weight: 700;
  margin-right: 8px;
  font-family: 'JetBrains Mono', monospace;
}

.variant-text {
  color: var(--txt2);
  font-size: 0.85rem;
  line-height: 1.7;
}

/* ═══════════════════════════════════════════════════════════
   COPY BUTTON
   ═══════════════════════════════════════════════════════════ */
.copy-btn {
  position: absolute;
  top: 12px;
  right: 12px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 0.75rem;
  color: var(--txt3);
  transition: all 0.3s ease;
  font-family: 'JetBrains Mono', monospace;
  opacity: 0;
  pointer-events: none;
}

.msg-text:hover .copy-btn,
.variant-option:hover .copy-btn {
  opacity: 1;
  pointer-events: auto;
}

.copy-btn:hover {
  background: var(--accent-lo);
  border-color: var(--accent);
  color: var(--accent);
  transform: scale(1.05);
}

.copy-btn.copied {
  background: var(--green-lo);
  border-color: var(--green);
  color: var(--green);
}

/* Export Button */
.export-btn {
  background: var(--green);
  border-color: var(--green);
  color: var(--bg);
  font-weight: 700;
  padding: 12px 24px;
  font-size: 0.95rem;
  border-radius: 10px;
  border: 1px solid var(--green);
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.export-btn:hover {
  background: var(--teal);
  border-color: var(--teal);
  box-shadow: 0 0 30px rgba(0, 255, 136, 0.4);
  transform: translateY(-2px);
}

/* Summary Stats Grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.stat-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  position: relative;
  overflow: hidden;
  transition: all 0.3s ease;
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: var(--holo-gradient);
  transition: width 0.3s ease;
}

.stat-card:hover {
  border-color: var(--border-hi);
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.stat-card:hover::before {
  width: 100%;
  opacity: 0.1;
}

.stat-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
}

.stat-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.3rem;
  background: var(--accent-lo);
  border: 1px solid var(--wu-blue);
}

.stat-label {
  font-size: 0.85rem;
  color: var(--txt3);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stat-value {
  font-size: 2rem;
  font-weight: 800;
  color: var(--txt1);
  font-family: 'JetBrains Mono', monospace;
  line-height: 1;
  margin-bottom: 6px;
}

.stat-detail {
  font-size: 0.8rem;
  color: var(--txt3);
}

/* Channel Breakdown */
.channel-breakdown {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 10px;
  margin-top: 16px;
}

/* Tags Breakdown - forçar 1 linha */
.channel-breakdown.tags-single-line {
  grid-template-columns: repeat(8, 1fr);
  gap: 8px;
}

.channel-breakdown.tags-single-line .channel-item {
  padding: 10px;
}

.channel-breakdown.tags-single-line .channel-icon {
  font-size: 1.2rem;
}

.channel-breakdown.tags-single-line .channel-name {
  font-size: 0.7rem;
}

.channel-breakdown.tags-single-line .channel-count {
  font-size: 1.1rem;
}

@media (max-width: 1100px) {
  .channel-breakdown.tags-single-line {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 768px) {
  .channel-breakdown.tags-single-line {
    grid-template-columns: repeat(2, 1fr);
  }
}

.channel-item {
  background: var(--card-hi);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s ease;
}

.channel-item:hover {
  border-color: var(--border-hi);
  transform: translateY(-2px);
}

.channel-icon {
  font-size: 1.3rem;
}

.channel-info {
  flex: 1;
}

.channel-name {
  font-size: 0.75rem;
  color: var(--txt3);
  margin-bottom: 3px;
}

.channel-count {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--txt1);
  font-family: 'JetBrains Mono', monospace;
}

@media (max-width: 768px) {
  .channel-breakdown {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Timeline Chart */
.timeline-chart {
  background: var(--card-hi);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  margin-top: 16px;
}

.timeline-bar {
  display: flex;
  align-items: center;
  margin-bottom: 16px;
}

.timeline-label {
  width: 200px;
  font-size: 0.85rem;
  color: var(--txt2);
  font-weight: 600;
}

.timeline-bar-container {
  flex: 1;
  height: 32px;
  background: var(--card);
  border-radius: 8px;
  overflow: hidden;
  position: relative;
}

.timeline-bar-fill {
  height: 100%;
  background: var(--holo-gradient);
  border-radius: 8px;
  transition: width 0.6s ease;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding-right: 10px;
}

.timeline-bar-value {
  color: white;
  font-weight: 700;
  font-size: 0.85rem;
  font-family: 'JetBrains Mono', monospace;
}

/* Summary Section */
.summary-section {
  margin-bottom: 32px;
}

/* Toggle Switch */
.toggle-switch {
  width: 40px;
  height: 22px;
  background: var(--wu-blue);
  border-radius: 11px;
  position: relative;
  cursor: pointer;
  transition: all 0.3s ease;
}

.toggle-switch[data-active="false"] {
  background: var(--txt3);
  opacity: 0.4;
}

.toggle-slider {
  width: 18px;
  height: 18px;
  background: white;
  border-radius: 50%;
  position: absolute;
  right: 2px;
  top: 2px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
}

.toggle-switch[data-active="false"] .toggle-slider {
  right: auto;
  left: 2px;
}

.summary-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 2px solid var(--border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  transition: all 0.3s ease;
}

.summary-title:hover {
  color: var(--wu-blue-light);
}

.summary-toggle {
  font-size: 1.2rem;
  transition: transform 0.3s ease;
  color: var(--txt3);
}

.summary-toggle.collapsed {
  transform: rotate(-90deg);
}

.summary-content {
  max-height: 2000px;
  overflow: hidden;
  transition: max-height 0.4s ease, opacity 0.3s ease;
  opacity: 1;
}

/* ═══════════════════════════════════════════════════════════
   ANALYTICS DASHBOARD
   ═══════════════════════════════════════════════════════════ */
.analytics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.metric-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  position: relative;
  overflow: hidden;
  transition: all 0.3s ease;
  cursor: pointer;
}

.metric-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background: var(--holo-gradient);
  transform: scaleX(0);
  transition: transform 0.3s ease;
}

.metric-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
  border-color: var(--border-hi);
}

.metric-card:hover::before {
  transform: scaleX(1);
}

.metric-label {
  font-size: 0.8rem;
  color: var(--txt3);
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
  margin-bottom: 8px;
  font-family: 'JetBrains Mono', monospace;
}

.metric-value {
  font-size: 2.2rem;
  font-weight: 800;
  color: var(--txt1);
  margin-bottom: 4px;
  font-family: 'Outfit', sans-serif;
}

.metric-trend {
  font-size: 0.85rem;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border-radius: 6px;
}

.metric-trend.up {
  color: var(--green);
  background: var(--green-lo);
}

.metric-trend.down {
  color: var(--rose);
  background: var(--rose-lo);
}

.metric-trend.neutral {
  color: var(--txt3);
  background: var(--card-hi);
}

.chart-container {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 24px;
}

.chart-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.bar-chart {
  display: grid;
  gap: 16px;
}

.bar-group {
  display: grid;
  grid-template-columns: 100px 1fr;
  gap: 12px;
  align-items: center;
}

.bar-label {
  font-size: 0.85rem;
  color: var(--txt2);
  font-weight: 600;
  text-align: right;
  font-family: 'JetBrains Mono', monospace;
}

.bar-stack {
  display: flex;
  height: 32px;
  background: var(--card-hi);
  border-radius: 8px;
  overflow: hidden;
  position: relative;
  border: 1px solid var(--border);
}

.bar-segment {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--bg);
  transition: all 0.3s ease;
  position: relative;
  cursor: pointer;
}

.bar-segment:hover {
  filter: brightness(1.2);
  z-index: 1;
}

.bar-segment::after {
  content: attr(data-value);
  position: absolute;
  font-family: 'JetBrains Mono', monospace;
}

.performance-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 8px;
}

.performance-table th {
  text-align: left;
  padding: 12px;
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--txt3);
  font-weight: 700;
  font-family: 'JetBrains Mono', monospace;
  border-bottom: 2px solid var(--border);
}

.performance-table td {
  padding: 12px;
  background: var(--card);
  font-size: 0.9rem;
  color: var(--txt2);
  border-top: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
}

.performance-table tr td:first-child {
  border-left: 1px solid var(--border);
  border-radius: 8px 0 0 8px;
  font-weight: 700;
  color: var(--txt1);
}

.performance-table tr td:last-child {
  border-right: 1px solid var(--border);
  border-radius: 0 8px 8px 0;
}

.performance-table tr:hover td {
  background: var(--card-hi);
  border-color: var(--border-hi);
}

.top-messages-grid {
  display: grid;
  gap: 8px;
}

.top-message-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px 14px;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: all 0.3s ease;
  cursor: pointer;
}

.top-message-card:hover {
  border-color: var(--border-hi);
  transform: translateX(4px);
  box-shadow: var(--shadow-md);
}

.message-rank {
  font-size: 1.5rem;
  font-weight: 900;
  color: var(--txt3);
  font-family: 'Outfit', sans-serif;
  min-width: 35px;
  text-align: center;
}

.message-rank.gold { color: #FFD700; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
.message-rank.silver { color: #C0C0C0; text-shadow: 0 0 10px rgba(192, 192, 192, 0.5); }
.message-rank.bronze { color: #CD7F32; text-shadow: 0 0 10px rgba(205, 127, 50, 0.5); }

.message-info {
  flex: 1;
}

.message-name {
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 4px;
  font-size: 0.9rem;
}

.message-stats {
  display: flex;
  gap: 12px;
  font-size: 0.75rem;
}

.message-stat {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--txt3);
  font-family: 'JetBrains Mono', monospace;
}

.message-stat strong {
  color: var(--txt1);
  font-weight: 700;
}

.ab-test-grid {
  display: grid;
  gap: 16px;
}

.ab-test-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  transition: all 0.3s ease;
}

.ab-test-card:hover {
  border-color: var(--border-hi);
  box-shadow: var(--shadow-md);
}

.ab-test-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  gap: 12px;
  flex-wrap: wrap;
}

.ab-test-title {
  font-weight: 700;
  color: var(--txt1);
  font-size: 1rem;
  margin-bottom: 4px;
  word-wrap: break-word;
  overflow-wrap: break-word;
  hyphens: auto;
}

.ab-test-subtitle {
  font-size: 0.85rem;
  color: var(--txt3);
  font-family: 'JetBrains Mono', monospace;
}

.ab-test-badge {
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-family: 'JetBrains Mono', monospace;
  flex-shrink: 0;
  white-space: nowrap;
}

.ab-test-info {
  flex: 1;
  min-width: 0;
}

.ab-test-badge.active {
  background: var(--green-lo);
  color: var(--green);
  border: 1px solid var(--green);
}

.ab-variants {
  display: grid;
  gap: 12px;
  margin-bottom: 12px;
}

.ab-variant {
  background: var(--card-hi);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 14px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.3s ease;
}

.ab-variant:hover {
  border-color: var(--border-hi);
  transform: translateX(2px);
}

.ab-variant.winner {
  border-color: var(--green);
  background: var(--green-lo);
}

.ab-variant-label {
  font-weight: 600;
  color: var(--txt1);
  font-size: 0.9rem;
  display: flex;
  align-items: center;
  gap: 8px;
}

.ab-variant-value {
  font-size: 1.4rem;
  font-weight: 800;
  color: var(--txt1);
  font-family: 'Outfit', sans-serif;
}

.ab-variant.winner .ab-variant-value {
  color: var(--green);
}

.ab-confidence {
  text-align: center;
  padding-top: 12px;
  border-top: 1px solid var(--border);
  font-size: 0.85rem;
  color: var(--txt3);
  font-family: 'JetBrains Mono', monospace;
}

.ab-confidence strong {
  color: var(--txt1);
  font-weight: 700;
}

.legend {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  margin-bottom: 16px;
  padding: 12px;
  background: var(--card-hi);
  border-radius: 8px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.85rem;
  color: var(--txt2);
  font-weight: 600;
}

.legend-color {
  width: 20px;
  height: 20px;
  border-radius: 4px;
  border: 1px solid var(--border);
}

.summary-content.collapsed {
  max-height: 0;
  opacity: 0;
}

/* Stats Grid Compact */
.stats-grid.compact {
  grid-template-columns: repeat(6, 1fr);
  gap: 8px;
}

.stats-grid.compact .stat-card {
  padding: 10px;
}

.stats-grid.compact .stat-value {
  font-size: 1.5rem;
}

.stats-grid.compact .stat-icon {
  width: 30px;
  height: 30px;
  font-size: 0.95rem;
}

.stats-grid.compact .stat-label {
  font-size: 0.65rem;
  line-height: 1.2;
}

.stats-grid.compact .stat-detail {
  font-size: 0.65rem;
  line-height: 1.3;
}

/* Responsive - apenas para telas muito pequenas */
@media (max-width: 900px) {
  .stats-grid.compact {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 600px) {
  .stats-grid.compact {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ═══════════════════════════════════════════════════════════
   ESTILOS PARA NOVA ESTRUTURA DE FASES
   ═══════════════════════════════════════════════════════════ */

.msg-week {
  font-size: 0.75rem;
  color: var(--txt3);
  font-family: 'JetBrains Mono', monospace;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.msg-meta {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin: 12px 0;
  align-items: center;
}

.meta-item {
  font-size: 0.85rem;
  color: var(--txt2);
  background: var(--card-hi);
  padding: 4px 10px;
  border-radius: 6px;
  border: 1px solid var(--border);
}

.tag {
  font-size: 0.75rem;
  padding: 4px 10px;
  border-radius: 6px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.tag-tipo {
  background: var(--accent-lo);
  color: var(--accent);
  border: 1px solid var(--accent);
}

.tag-gatilho {
  background: var(--amber-lo);
  color: var(--amber);
  border: 1px solid var(--amber);
}

.msg-objetivo {
  font-size: 0.9rem;
  color: var(--txt2);
  margin: 12px 0;
  padding: 10px;
  background: var(--card-hi);
  border-radius: 8px;
  border-left: 3px solid var(--accent);
}

.msg-text {
  font-size: 0.95rem;
  color: var(--txt1);
  line-height: 1.7;
  margin: 12px 0;
  padding: 14px;
  background: var(--surface);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.msg-actions {
  display: flex;
  gap: 8px;
  margin-top: 12px;
  align-items: center;
}

.copy-btn {
  background: var(--accent);
  color: var(--bg);
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: inherit;
}

.copy-btn:hover {
  background: var(--accent-hi);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px var(--accent-lo);
}

.info-btn {
  background: var(--card-hi);
  color: var(--txt2);
  border: 1px solid var(--border);
  padding: 8px 12px;
  border-radius: 8px;
  font-size: 0.85rem;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: inherit;
}

.info-btn:hover {
  background: var(--accent-lo);
  color: var(--accent);
  border-color: var(--accent);
}

/* Gatilho Slot */
.gatilho-slot {
  border-left: 4px solid var(--amber) !important;
  background: linear-gradient(135deg, var(--card) 0%, var(--card-hi) 100%);
}

.toggle-btn {
  background: var(--card-hi);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 8px 16px;
  cursor: pointer;
  color: var(--txt2);
  font-size: 0.85rem;
  font-weight: 600;
  transition: all 0.3s ease;
  font-family: inherit;
}

.toggle-btn:hover {
  background: var(--accent-lo);
  border-color: var(--accent);
  color: var(--accent);
}

.gatilho-cenarios {
  margin-top: 16px;
  display: grid;
  gap: 12px;
}

/* Cenários coloridos */
.cenario-card {
  background: var(--card-hi);
  border: 2px solid;
  border-radius: 12px;
  padding: 16px;
  transition: all 0.3s ease;
}

.cenario-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.cenario-alta {
  border-color: var(--cenario-alta-border);
  background: var(--cenario-alta-bg);
}

.cenario-alta:hover {
  box-shadow: 0 4px 16px var(--green-glow);
}

.cenario-baixa {
  border-color: var(--cenario-baixa-border);
  background: var(--cenario-baixa-bg);
}

.cenario-baixa:hover {
  box-shadow: 0 4px 16px var(--amber-glow);
}

.cenario-zero {
  border-color: var(--cenario-zero-border);
  background: var(--cenario-zero-bg);
}

.cenario-zero:hover {
  box-shadow: 0 4px 16px var(--rose-glow);
}

.cenario-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
}

.cenario-icon {
  font-size: 1.5rem;
  line-height: 1;
}

.cenario-title {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--txt1);
  font-family: 'Outfit', sans-serif;
}

.cenario-condition {
  font-size: 0.75rem;
  color: var(--txt3);
  font-family: 'JetBrains Mono', monospace;
  margin-top: 2px;
}

.cenario-message {
  font-size: 0.9rem;
  color: var(--txt2);
  line-height: 1.6;
  margin-bottom: 12px;
  padding: 12px;
  background: var(--card);
  border-radius: 8px;
}


/* ═══════════════════════════════════════════════════════════
   CSS ADICIONAL - RESUMO COM ANÁLISE DE VOLUME
   ═══════════════════════════════════════════════════════════ */

/* Stats Grid 3 Colunas */
.stats-grid-3col {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 20px;
}

@media (max-width: 768px) {
  .stats-grid-3col {
    grid-template-columns: 1fr;
  }
}

.stat-card-detailed {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  transition: all 0.3s ease;
}

.stat-card-detailed:hover {
  border-color: var(--border-hi);
  transform: translateY(-4px);
  box-shadow: var(--shadow-md);
}

.stat-icon-large {
  font-size: 2.5rem;
  margin-bottom: 12px;
  filter: drop-shadow(0 0 10px var(--wu-blue-glow));
}

.stat-title {
  font-size: 0.85rem;
  color: var(--txt3);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 600;
  margin-bottom: 8px;
}

.stat-number {
  font-size: 2rem;
  font-weight: 700;
  color: var(--accent);
  font-family: 'JetBrains Mono', monospace;
  margin-bottom: 4px;
}

.stat-subtitle {
  font-size: 0.8rem;
  color: var(--txt3);
}

/* Info Box */
.info-box {
  background: var(--card-hi);
  border-left: 3px solid var(--accent);
  border-radius: 0 8px 8px 0;
  padding: 16px 20px;
  margin-top: 20px;
  color: var(--txt2);
  line-height: 1.7;
}

.info-note {
  background: var(--accent-lo);
  border-radius: 8px;
  padding: 12px 16px;
  margin-top: 12px;
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.6;
}

/* Period Comparison */
.period-comparison {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
  margin-bottom: 20px;
}

@media (max-width: 768px) {
  .period-comparison {
    grid-template-columns: 1fr;
  }
}

.period-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  transition: all 0.3s ease;
}

.period-card:hover {
  border-color: var(--border-hi);
  box-shadow: var(--shadow-md);
}

.period-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.period-icon {
  font-size: 1.5rem;
}

.period-name {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--txt1);
}

.period-stats {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.period-stat {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background: var(--surface);
  border-radius: 6px;
}

.period-label {
  font-size: 0.85rem;
  color: var(--txt3);
  font-weight: 500;
}

.period-value {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.9rem;
  color: var(--txt1);
  font-weight: 600;
}

/* Chart Container */
.chart-container {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
  margin: 20px 0;
  height: 350px;
}

.chart-description {
  background: var(--surface);
  border-left: 3px solid var(--wu-blue);
  border-radius: 0 8px 8px 0;
  padding: 12px 16px;
  margin-bottom: 20px;
  font-size: 0.9rem;
  color: var(--txt2);
  line-height: 1.6;
}

.chart-legend {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 16px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.85rem;
  color: var(--txt2);
}

.legend-color {
  width: 16px;
  height: 16px;
  border-radius: 3px;
  flex-shrink: 0;
}

.legend-label {
  line-height: 1.4;
}

/* Peak Analysis */
.peak-analysis {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 20px;
}

@media (max-width: 900px) {
  .peak-analysis {
    grid-template-columns: 1fr;
  }
}

.peak-card {
  background: var(--card);
  border: 2px solid var(--green);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  transition: all 0.3s ease;
}

.peak-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(0, 255, 179, 0.2);
}

.peak-card.peak-warning {
  border-color: var(--amber);
}

.peak-card.peak-warning:hover {
  box-shadow: 0 8px 24px rgba(255, 215, 0, 0.2);
}

.peak-card.peak-danger {
  border-color: var(--rose);
}

.peak-card.peak-danger:hover {
  box-shadow: 0 8px 24px rgba(255, 51, 102, 0.2);
}

.peak-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 12px;
}

.peak-icon {
  font-size: 1.2rem;
}

.peak-title {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--txt1);
}

.peak-value {
  font-size: 2rem;
  font-weight: 700;
  font-family: 'JetBrains Mono', monospace;
  color: var(--accent);
  margin-bottom: 8px;
}

.peak-description {
  font-size: 0.8rem;
  color: var(--txt3);
  line-height: 1.4;
}

/* Scenario Details */
.scenario-details {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.scenario-card {
  background: var(--card);
  border: 2px solid;
  border-radius: 14px;
  padding: 24px;
  transition: all 0.3s ease;
}

.scenario-card.scenario-success {
  border-color: var(--green);
}

.scenario-card.scenario-warning {
  border-color: var(--amber);
}

.scenario-card.scenario-danger {
  border-color: var(--rose);
}

.scenario-card:hover {
  box-shadow: var(--shadow-lg);
  transform: translateY(-2px);
}

.scenario-header {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.scenario-icon {
  font-size: 2rem;
}

.scenario-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--txt1);
}

.scenario-subtitle {
  font-size: 0.85rem;
  color: var(--txt3);
  margin-top: 2px;
}

.scenario-breakdown {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.breakdown-period {
  background: var(--surface);
  border-radius: 10px;
  padding: 16px;
}

.breakdown-title {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border);
}

.breakdown-items {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.breakdown-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 10px;
  font-size: 0.85rem;
}

.breakdown-item span {
  color: var(--txt2);
}

.breakdown-item strong {
  color: var(--txt1);
  font-family: 'JetBrains Mono', monospace;
}

.breakdown-item.total {
  background: var(--card-hi);
  border-radius: 6px;
  padding: 10px;
  margin-top: 4px;
  font-weight: 600;
}

.breakdown-item.total span {
  color: var(--txt1);
  font-weight: 600;
}

.breakdown-item.alert {
  background: rgba(255, 51, 102, 0.1);
  border-radius: 6px;
  padding: 8px 10px;
}

.breakdown-simple {
  background: var(--surface);
  border-radius: 10px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.scenario-total {
  background: var(--card-hi);
  border-radius: 10px;
  padding: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 1rem;
  font-weight: 600;
}

.scenario-total span {
  color: var(--txt1);
}

.scenario-total strong {
  color: var(--accent);
  font-family: 'JetBrains Mono', monospace;
  font-size: 1.2rem;
}

.scenario-total.alert {
  background: rgba(255, 51, 102, 0.15);
  border: 1px solid var(--rose);
}

.scenario-total.alert strong {
  color: var(--rose);
}

/* Recommendations */
.recommendations {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
}

@media (max-width: 900px) {
  .recommendations {
    grid-template-columns: 1fr;
  }
}

.rec-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  display: flex;
  gap: 16px;
  transition: all 0.3s ease;
}

.rec-card:hover {
  border-color: var(--accent);
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.rec-icon {
  font-size: 2rem;
  flex-shrink: 0;
  filter: drop-shadow(0 0 10px var(--wu-blue-glow));
}

.rec-content {
  flex: 1;
}

.rec-title {
  font-size: 1rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 8px;
}

.rec-text {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.6;
}


/* ═══════════════════════════════════════════════════════════
   CSS DASHBOARD DE ANÁLISE
   ═══════════════════════════════════════════════════════════ */

/* Scenario Selector */
.scenario-selector {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  flex-wrap: wrap;
}

.scenario-btn {
  flex: 1;
  min-width: 200px;
  padding: 14px 20px;
  border: 2px solid var(--border);
  border-radius: 10px;
  background: var(--card);
  color: var(--txt2);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: 'Outfit', sans-serif;
}

.scenario-btn:hover {
  border-color: var(--accent);
  color: var(--txt1);
  transform: translateY(-2px);
}

.scenario-btn.active {
  border-color: var(--accent);
  background: var(--accent);
  color: white;
  box-shadow: 0 0 20px var(--wu-blue-glow);
}

/* Chart Containers */
.chart-container-large {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
  margin: 20px 0;
  height: 400px;
}

.chart-container-medium {
  background: var(--surface);
  border-radius: 10px;
  padding: 20px;
  height: 280px;
}

.chart-info {
  margin-top: 16px;
}

.info-card {
  display: flex;
  gap: 12px;
  padding: 16px;
  background: var(--card-hi);
  border-left: 3px solid var(--accent);
  border-radius: 0 8px 8px 0;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.info-text {
  flex: 1;
  font-size: 0.9rem;
  color: var(--txt2);
  line-height: 1.6;
}

/* Distribution Grid */
.distribution-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-top: 20px;
}

@media (max-width: 900px) {
  .distribution-grid {
    grid-template-columns: 1fr;
  }
}

.dist-column {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
}

.dist-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.dist-icon {
  font-size: 1.5rem;
}

.dist-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--txt1);
}

.dist-stats {
  margin-top: 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.dist-stat {
  display: flex;
  justify-content: space-between;
  padding: 8px 12px;
  background: var(--surface);
  border-radius: 6px;
  font-size: 0.85rem;
}

.dist-stat span {
  color: var(--txt3);
}

.dist-stat strong {
  color: var(--txt1);
  font-family: 'JetBrains Mono', monospace;
}

.dist-stat.highlight {
  background: var(--accent-lo);
  border: 1px solid var(--accent);
}

.dist-stat.highlight span,
.dist-stat.highlight strong {
  color: var(--accent);
}

/* Peaks Analysis */
.peaks-analysis {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.peak-insight {
  background: linear-gradient(135deg, var(--card-hi) 0%, var(--card) 100%);
  border: 2px solid var(--green);
  border-radius: 14px;
  padding: 24px;
}

.peak-insight-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.peak-insight-icon {
  font-size: 2rem;
}

.peak-insight-title {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--txt1);
}

.peak-insight-body {
  font-size: 0.95rem;
  color: var(--txt2);
  line-height: 1.8;
}

.peak-insight-body p {
  margin-bottom: 12px;
}

.peak-insight-body strong {
  color: var(--txt1);
}

.peak-breakdown {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
}

.peak-breakdown-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.peak-scenarios {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
}

@media (max-width: 768px) {
  .peak-scenarios {
    grid-template-columns: 1fr;
  }
}

.peak-scenario {
  background: var(--surface);
  border: 2px solid var(--green);
  border-radius: 10px;
  padding: 16px;
}

.peak-scenario.alert {
  border-color: var(--rose);
}

.peak-scenario-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  font-weight: 600;
  color: var(--txt1);
}

.peak-count {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.85rem;
  color: var(--txt3);
}

.peak-scenario-detail {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.6;
}

/* Executive Summary */
.executive-summary {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

@media (max-width: 900px) {
  .executive-summary {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .executive-summary {
    grid-template-columns: 1fr;
  }
}

.exec-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  transition: all 0.3s ease;
}

.exec-card:hover {
  border-color: var(--accent);
  transform: translateY(-4px);
  box-shadow: var(--shadow-md);
}

.exec-number {
  font-size: 2.5rem;
  font-weight: 700;
  font-family: 'JetBrains Mono', monospace;
  background: var(--holo-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

.exec-label {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 8px;
}

.exec-detail {
  font-size: 0.8rem;
  color: var(--txt3);
  line-height: 1.4;
}

.exec-conclusion {
  background: linear-gradient(135deg, var(--card-hi) 0%, var(--card) 100%);
  border: 2px solid var(--accent);
  border-radius: 14px;
  padding: 24px;
}

.conclusion-title {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.conclusion-text {
  font-size: 0.95rem;
  color: var(--txt2);
  line-height: 1.8;
}

.conclusion-text ul {
  margin: 16px 0;
  padding-left: 20px;
}

.conclusion-text li {
  margin-bottom: 8px;
}

.conclusion-text strong {
  color: var(--txt1);
}

/* Insights Grid */
.insights-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
}

@media (max-width: 900px) {
  .insights-grid {
    grid-template-columns: 1fr;
  }
}

.insight-card {
  background: var(--card);
  border: 2px solid;
  border-radius: 12px;
  padding: 20px;
  display: flex;
  gap: 16px;
  transition: all 0.3s ease;
}

.insight-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-md);
}

.insight-card.insight-success {
  border-color: var(--green);
}

.insight-card.insight-info {
  border-color: var(--wu-blue);
}

.insight-card.insight-warning {
  border-color: var(--amber);
}

.insight-card.insight-action {
  border-color: var(--purple);
}

.insight-icon {
  font-size: 2rem;
  flex-shrink: 0;
}

.insight-content {
  flex: 1;
}

.insight-title {
  font-size: 1rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 8px;
}

.insight-text {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.6;
}




/* ═══════════════════════════════════════════════════════════
   PRÓXIMOS PASSOS DETALHADOS
   ═══════════════════════════════════════════════════════════ */

.proximos-passos {
  background: var(--card);
  border: 2px solid var(--green);
  border-radius: 14px;
  padding: 24px;
  margin-top: 32px;
}

.passos-header {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 2px solid var(--border);
}

.passos-icon {
  font-size: 1.8rem;
}

.passos-content {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.passo-card {
  background: var(--surface);
  border: 2px solid;
  border-radius: 12px;
  padding: 24px;
  transition: all 0.3s ease;
}

.passo-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.passo-card.passo-success {
  border-color: var(--green);
  background: linear-gradient(135deg, var(--green-lo) 0%, var(--surface) 100%);
}

.passo-card.passo-warning {
  border-color: var(--amber);
  background: linear-gradient(135deg, var(--amber-lo) 0%, var(--surface) 100%);
}

.passo-card.passo-danger {
  border-color: var(--rose);
  background: linear-gradient(135deg, var(--rose-lo) 0%, var(--surface) 100%);
}

.passo-header {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.passo-icon-large {
  font-size: 3rem;
  flex-shrink: 0;
}

.passo-title-group {
  flex: 1;
}

.passo-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 4px;
}

.passo-subtitle {
  font-size: 0.9rem;
  color: var(--txt3);
  font-style: italic;
}

.passo-checklist {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.passo-check-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 14px;
  background: var(--card);
  border-radius: 8px;
  border: 1px solid var(--border);
  transition: all 0.3s ease;
}

.passo-check-item:hover {
  border-color: var(--accent);
  box-shadow: var(--shadow-sm);
}

.passo-check-item.highlight {
  border-color: var(--green);
  background: linear-gradient(135deg, var(--green-lo) 0%, var(--card) 100%);
}

.check-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
  line-height: 1;
}

.check-content {
  flex: 1;
}

.check-content strong {
  display: block;
  font-size: 0.95rem;
  color: var(--txt1);
  margin-bottom: 6px;
  font-weight: 600;
}

.check-content p {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.7;
  margin: 0;
}

.check-content code {
  font-family: 'JetBrains Mono', monospace;
  background: var(--surface);
  padding: 2px 6px;
  border-radius: 4px;
  color: var(--accent);
  border: 1px solid var(--border);
  font-size: 0.85rem;
}

.mercury-link {
  color: var(--accent);
  text-decoration: none;
  font-weight: 600;
  border-bottom: 1px dashed var(--accent);
  transition: all 0.2s ease;
  word-break: break-all;
}

.mercury-link:hover {
  color: var(--wu-blue);
  border-bottom-style: solid;
}

.exemplo-mensagem {
  margin-top: 10px;
  padding: 12px;
  background: var(--surface);
  border-left: 3px solid var(--green);
  border-radius: 0 6px 6px 0;
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.6;
  font-style: italic;
}

/* Responsive Próximos Passos */
@media (max-width: 768px) {
  .passo-header {
    flex-direction: column;
    align-items: flex-start;
    text-align: left;
  }
  
  .passo-icon-large {
    font-size: 2.5rem;
  }
}


/* ═══════════════════════════════════════════════════════════
   CSS - RÉGUA DE RECUPERAÇÃO
   ═══════════════════════════════════════════════════════════ */

/* Header da Recuperação */
.recuperacao-header {
  background: linear-gradient(135deg, var(--card-hi) 0%, var(--card) 100%);
  border: 2px solid var(--rose);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
}

.recuperacao-title {
  display: flex;
  align-items: flex-start;
  gap: 16px;
}

.recuperacao-icon {
  font-size: 2.5rem;
  flex-shrink: 0;
}

.recuperacao-title h3 {
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 8px;
}

.recuperacao-title p {
  font-size: 0.9rem;
  color: var(--txt2);
  line-height: 1.6;
}

/* Regras da Régua */
.regras-recuperacao {
  background: var(--card);
  border: 2px solid var(--amber);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 32px;
}

.regras-header {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.regras-header span {
  font-size: 1.5rem;
}

.regras-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}

@media (max-width: 900px) {
  .regras-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .regras-grid {
    grid-template-columns: 1fr;
  }
}

.regra-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  transition: all 0.3s ease;
}

.regra-item:hover {
  border-color: var(--amber);
  transform: translateY(-2px);
  box-shadow: var(--shadow-sm);
}

.regra-icon {
  font-size: 1.8rem;
  flex-shrink: 0;
}

.regra-content {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.regra-content strong {
  font-size: 0.85rem;
  color: var(--txt1);
  font-weight: 600;
}

.regra-content span {
  font-size: 0.8rem;
  color: var(--txt3);
}

/* Timeline de Recuperação */
.recuperacao-timeline {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.rec-day-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
}

.rec-day-card:hover {
  border-color: var(--border-hi);
  box-shadow: var(--shadow-md);
}

.rec-day-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  background: linear-gradient(135deg, var(--card-hi) 0%, var(--card) 100%);
  border-bottom: 1px solid var(--border);
  cursor: pointer;
  user-select: none;
}

.rec-day-info {
  display: flex;
  align-items: center;
  gap: 20px;
  flex: 1;
}

.rec-day-number {
  font-family: 'JetBrains Mono', monospace;
  font-size: 1.5rem;
  font-weight: 700;
  background: var(--holo-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  min-width: 70px;
}

.rec-day-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
  flex: 1;
}

.rec-fase {
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--txt1);
}

.rec-fase.abordagem-gentil {
  color: var(--green);
}

.rec-fase.aumenta-urgência {
  color: var(--amber);
}

.rec-fase.última-chance,
.rec-fase.encerramento {
  color: var(--rose);
}

.rec-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  font-size: 0.8rem;
  color: var(--txt3);
  font-family: 'JetBrains Mono', monospace;
}

.rec-tentativas {
  background: var(--accent-lo);
  color: var(--accent);
  padding: 2px 8px;
  border-radius: 4px;
  border: 1px solid var(--accent);
  font-weight: 600;
}

.rec-separator {
  color: var(--border);
}

.rec-horario,
.rec-canal {
  color: var(--txt3);
}

.rec-expand-btn {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--txt2);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  transition: all 0.3s ease;
  flex-shrink: 0;
}

.rec-expand-btn:hover {
  background: var(--accent-lo);
  border-color: var(--accent);
  color: var(--accent);
  transform: scale(1.1);
}

.rec-day-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
}

.rec-variantes-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 16px 20px;
  background: var(--surface);
  border-bottom: 1px solid var(--border);
}

.variantes-icon {
  font-size: 1.2rem;
}

.variantes-title {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--txt1);
}

.rec-variantes-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  padding: 20px;
}

@media (max-width: 1200px) {
  .rec-variantes-grid {
    grid-template-columns: 1fr;
  }
}

.rec-variante-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 16px;
  transition: all 0.3s ease;
}

.rec-variante-card:hover {
  border-color: var(--accent);
  box-shadow: var(--shadow-sm);
  transform: translateY(-2px);
}

.rec-variante-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.variante-number {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--accent);
  background: var(--accent-lo);
  padding: 4px 10px;
  border-radius: 6px;
  border: 1px solid var(--accent);
}

.rec-variante-actions {
  opacity: 0;
  transition: opacity 0.3s ease;
}

.rec-variante-card:hover .rec-variante-actions {
  opacity: 1;
}

.rec-variante-text {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.7;
  white-space: pre-wrap;
}

/* Observações */
.rec-observacoes {
  background: var(--card);
  border: 2px solid var(--wu-blue);
  border-radius: 14px;
  padding: 24px;
  margin-top: 32px;
  margin-bottom: 24px;
}

.obs-header {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.obs-icon {
  font-size: 1.5rem;
}

.obs-content {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.obs-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  font-size: 0.9rem;
  color: var(--txt2);
  line-height: 1.7;
}

.obs-bullet {
  color: var(--green);
  font-size: 1.1rem;
  font-weight: 700;
  flex-shrink: 0;
}

.obs-item strong {
  color: var(--txt1);
}

/* Fluxo de Decisão */
.rec-fluxo {
  background: var(--card);
  border: 2px solid var(--purple);
  border-radius: 14px;
  padding: 24px;
  margin-top: 24px;
}

.fluxo-header {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.fluxo-icon {
  font-size: 1.5rem;
}

.fluxo-content {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.fluxo-scenario {
  background: var(--surface);
  border: 2px solid;
  border-radius: 10px;
  padding: 16px;
}

.fluxo-scenario.fluxo-success {
  border-color: var(--green);
  background: linear-gradient(135deg, var(--green-lo) 0%, var(--surface) 100%);
}

.fluxo-scenario.fluxo-warning {
  border-color: var(--amber);
  background: linear-gradient(135deg, var(--amber-lo) 0%, var(--surface) 100%);
}

.fluxo-scenario.fluxo-danger {
  border-color: var(--rose);
  background: linear-gradient(135deg, var(--rose-lo) 0%, var(--surface) 100%);
}

.fluxo-scenario-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 12px;
}

.fluxo-scenario-icon {
  font-size: 1.5rem;
}

.fluxo-scenario-title {
  font-size: 1rem;
  font-weight: 600;
  color: var(--txt1);
}

.fluxo-scenario-text {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.7;
}

/* Responsive */
@media (max-width: 768px) {
  .rec-day-info {
    flex-direction: column;
    gap: 12px;
  }
  
  .rec-day-number {
    min-width: auto;
  }
  
  .rec-meta {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .rec-separator {
    display: none;
  }
}

/* ═══════════════════════════════════════════════════════════
   PRÓXIMOS PASSOS - VERSÃO COMPACTA
   ═══════════════════════════════════════════════════════════ */

.proximos-passos-compact {
  background: var(--card);
  border: 2px solid var(--accent);
  border-radius: 12px;
  padding: 20px;
  margin-top: 24px;
}

.passos-header-compact {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--txt1);
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.passos-icon {
  font-size: 1.5rem;
}

.passos-grid-compact {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}

@media (max-width: 900px) {
  .passos-grid-compact {
    grid-template-columns: 1fr;
  }
}

.passo-compact {
  background: var(--surface);
  border: 2px solid;
  border-radius: 10px;
  padding: 16px;
  display: flex;
  gap: 12px;
  transition: all 0.3s ease;
}

.passo-compact:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.passo-compact.passo-success {
  border-color: var(--green);
}

.passo-compact.passo-warning {
  border-color: var(--amber);
}

.passo-compact.passo-danger {
  border-color: var(--rose);
}

.passo-icon-compact {
  font-size: 2rem;
  flex-shrink: 0;
  line-height: 1;
}

.passo-content-compact {
  flex: 1;
}

.passo-title-compact {
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--txt1);
  margin-bottom: 8px;
}

.passo-actions-compact {
  font-size: 0.85rem;
  color: var(--txt2);
  line-height: 1.7;
}

.passo-actions-compact code {
  font-family: 'JetBrains Mono', monospace;
  background: var(--card-hi);
  padding: 2px 6px;
  border-radius: 4px;
  color: var(--accent);
  border: 1px solid var(--border);
  font-size: 0.8rem;
}

.link-mercury {
  color: var(--accent);
  text-decoration: none;
  font-weight: 600;
  border-bottom: 1px dashed var(--accent);
  transition: all 0.2s ease;
}

.link-mercury:hover {
  color: var(--wu-blue);
  border-bottom-style: solid;
}

</style>
</head>
<body>

<div class="wrap">
  <!-- TOP BAR -->
  <div class="top-bar">
    <button class="theme-btn" onclick="toggleTheme()">
      <span id="themeIcon">🌙</span>
      <span id="themeLabel">Modo Claro</span>
    </button>
  </div>

  <!-- HEADER -->
  <div class="header">
    <h1>Régua de Comunicação CS</h1>
    <div class="subtitle" style="font-size: 1.1rem; font-weight: 600; letter-spacing: 1px; color: var(--wu-blue-light);">Wise Up Live | CxTech</div>
    <div class="header-line"></div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <div class="tab active" onclick="showTab('resumo', this)">📊 Resumo</div>
    <div class="tab" onclick="showTab('timeline', this)">📅 Linha do Tempo</div>
    <div class="tab" onclick="showTab('simulador', this)">🎯 Simulador</div>
  </div>

  <!-- TAB: RESUMO -->
  <div id="resumo" class="tab-content active">
    <div class="hero-section">
      <h2>🎯 O que é a Régua de Comunicação CS?</h2>
      <p>
        A <strong>Régua de Comunicação de Customer Success</strong> é um sistema estratégico de mensagens automáticas e personalizadas 
        que acompanha o aluno desde a matrícula até sua jornada de aprendizado, garantindo engajamento, suporte proativo e 
        retenção de longo prazo.
      </p>
      <p>
        Desenvolvida para o time de CS da Wise Up, esta régua combina <strong>ciência de dados</strong>, 
        <strong>psicologia comportamental</strong> e <strong>automação inteligente</strong> para criar touchpoints relevantes 
        em momentos estratégicos da jornada do aluno.
      </p>
      
      <div class="hero-highlights">
        <div class="highlight-item">
          <div class="highlight-icon">🎓</div>
          <div class="highlight-label">Objetivo</div>
          <div class="highlight-value">Sucesso do Aluno</div>
        </div>
        <div class="highlight-item">
          <div class="highlight-icon">💙</div>
          <div class="highlight-label">Foco</div>
          <div class="highlight-value">Experiência</div>
        </div>
        <div class="highlight-item">
          <div class="highlight-icon">📈</div>
          <div class="highlight-label">Resultado</div>
          <div class="highlight-value">Retenção</div>
        </div>
        <div class="highlight-item">
          <div class="highlight-icon">🤖</div>
          <div class="highlight-label">Método</div>
          <div class="highlight-value">Automação</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-title" style="font-size:1.5rem;margin-bottom:16px">🎯 Objetivos do Customer Success</div>
      <div class="section-subtitle">
        O time de CS da Wise Up é responsável por garantir que cada aluno alcance seus objetivos de aprendizado e 
        tenha uma experiência excepcional ao longo de toda a jornada.
      </div>
      
      <div style="display:grid;gap:16px;margin-top:20px">
        <div style="display:flex;gap:12px;align-items:flex-start">
          <div style="font-size:1.5rem;flex-shrink:0">✨</div>
          <div>
            <div style="font-weight:600;color:var(--txt1);margin-bottom:4px">Onboarding de Excelência</div>
            <div style="color:var(--txt2);font-size:0.9rem">Garantir que todo aluno comece sua jornada com o pé direito, entendendo a plataforma e criando hábitos de estudo desde o dia zero.</div>
          </div>
        </div>
        
        <div style="display:flex;gap:12px;align-items:flex-start">
          <div style="font-size:1.5rem;flex-shrink:0">🎯</div>
          <div>
            <div style="font-weight:600;color:var(--txt1);margin-bottom:4px">Engajamento Contínuo</div>
            <div style="color:var(--txt2);font-size:0.9rem">Manter os alunos motivados e engajados através de comunicação relevante, celebração de conquistas e suporte proativo.</div>
          </div>
        </div>
        
        <div style="display:flex;gap:12px;align-items:flex-start">
          <div style="font-size:1.5rem;flex-shrink:0">🚨</div>
          <div>
            <div style="font-weight:600;color:var(--txt1);margin-bottom:4px">Prevenção de Churn</div>
            <div style="color:var(--txt2);font-size:0.9rem">Identificar sinais de inatividade precocemente e intervir com estratégias de recuperação antes que o aluno cancele.</div>
          </div>
        </div>
        
        <div style="display:flex;gap:12px;align-items:flex-start">
          <div style="font-size:1.5rem;flex-shrink:0">💫</div>
          <div>
            <div style="font-weight:600;color:var(--txt1);margin-bottom:4px">Jornada Personalizada</div>
            <div style="color:var(--txt2);font-size:0.9rem">Adaptar a comunicação ao perfil, ritmo e necessidades de cada aluno, criando uma experiência única e humanizada.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- DASHBOARD ANALYTICS & PERFORMANCE -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        📊 Analytics & Performance
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        
        <!-- Aviso de Implementação Futura -->
        <div style="background:var(--card-hi);border:1px solid var(--border);border-radius:10px;padding:14px 18px;margin-bottom:24px;border-left:3px solid var(--amber)">
          <div style="display:flex;align-items:flex-start;gap:12px">
            <div style="font-size:1.2rem;flex-shrink:0">ℹ️</div>
            <div style="color:var(--txt3);font-size:0.85rem;line-height:1.6">
              <strong style="color:var(--txt2)">Dashboard em desenvolvimento:</strong> Os dados apresentados abaixo são simulados para demonstração. 
              Para métricas reais, será necessária integração com CRM e canais de comunicação (WhatsApp Business API, plataforma de e-mail, etc.).
            </div>
          </div>
        </div>

        <!-- KPIs Principais -->
        <div class="analytics-grid" id="analyticsKPIs">
          <!-- Will be populated by JavaScript -->
        </div>

        <!-- Gráfico: Mensagens por Semana -->
        <div class="chart-container">
          <div class="chart-title">
            📅 Mensagens Enviadas por Semana (Últimas 4 semanas)
          </div>
          <div class="legend" id="chartLegend">
            <!-- Will be populated by JavaScript -->
          </div>
          <div class="bar-chart" id="weeklyChart">
            <!-- Will be populated by JavaScript -->
          </div>
        </div>

        <!-- Performance por Fase -->
        <div class="chart-container">
          <div class="chart-title">
            🎯 Performance por Fase da Jornada
          </div>
          <table class="performance-table" id="performanceTable">
            <thead>
              <tr>
                <th>Fase</th>
                <th>Mensagens</th>
                <th>Taxa Abertura</th>
                <th>Taxa Clique</th>
                <th>Conversão</th>
              </tr>
            </thead>
            <tbody id="performanceBody">
              <!-- Will be populated by JavaScript -->
            </tbody>
          </table>
        </div>

        <!-- Top 5 Mensagens -->
        <div class="chart-container">
          <div class="chart-title">
            🏆 Top 5 Mensagens com Melhor Performance
          </div>
          <div class="top-messages-grid" id="topMessages">
            <!-- Will be populated by JavaScript -->
          </div>
        </div>

        <!-- A/B Testing -->
        <div class="chart-container">
          <div class="chart-title">
            🧪 Testes A/B em Andamento
          </div>
          <div class="ab-test-grid" id="abTests">
            <!-- Will be populated by JavaScript -->
          </div>
        </div>

      </div>
    </div>

    <!-- Estatísticas continuam aqui... -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        📊 Visão Geral da Régua
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="stats-grid compact" id="statsGrid">
          <!-- Stats will be populated by JavaScript -->
        </div>
      </div>
    </div>

    <!-- NOVA SEÇÃO: ANÁLISE DE IMPACTO FINANCEIRO -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        💰 Análise de Impacto Financeiro
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="card" style="border:2px solid var(--border-hi)">
          <div class="section-subtitle" style="margin-bottom:24px">
            Comparação de cenários de comunicação baseado no status de pagamento do aluno
          </div>

          <!-- Alerta Importante -->
          <div style="background:var(--amber-lo);border:1px solid var(--amber);border-radius:12px;padding:16px;margin-bottom:24px;display:flex;gap:12px;align-items:flex-start">
            <div style="font-size:1.3rem;flex-shrink:0">⚠️</div>
            <div style="color:var(--txt1);font-size:0.9rem;line-height:1.7">
              <strong style="color:var(--amber)">Atenção:</strong> Quando um aluno fica inadimplente, o <strong>time Financeiro</strong> envia 
              <strong style="color:var(--amber)">1 mensagem por dia</strong> até regularização. Isso aumenta drasticamente o volume de comunicação.
            </div>
          </div>

          <!-- Grid de Cenários -->
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-bottom:32px" id="cenariosFinanceiros">
            <!-- Will be populated by JavaScript -->
          </div>

          <!-- Gráfico de Comparação -->
          <div style="background:var(--card-hi);border-radius:12px;padding:24px;margin-top:24px">
            <div style="font-size:1.1rem;font-weight:700;color:var(--txt1);margin-bottom:20px;display:flex;align-items:center;gap:10px">
              <span>📊</span>
              <span>Comparação Anual de Mensagens</span>
            </div>
            <div id="comparisonChart" style="min-height:300px">
              <!-- Chart will be populated by JavaScript -->
            </div>
          </div>

          <!-- Breakdown Detalhado -->
          <div style="margin-top:32px">
            <div style="font-size:1.1rem;font-weight:700;color:var(--txt1);margin-bottom:16px">
              📋 Breakdown Detalhado por Cenário
            </div>
            <div style="display:grid;gap:16px">
              <!-- Cenário 1 -->
              <div style="background:var(--green-lo);border:1px solid var(--green);border-radius:10px;padding:16px">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
                  <span style="font-size:1.5rem">✅</span>
                  <span style="font-size:1rem;font-weight:700;color:var(--green)">Aluno em Dia (Cenário Ideal)</span>
                </div>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;font-size:0.85rem">
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Customer Success</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--txt1)" id="cenario1-cs">44</div>
                    <div style="color:var(--txt3);font-size:0.75rem">mensagens/ano</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Time Financeiro</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--green)">0</div>
                    <div style="color:var(--txt3);font-size:0.75rem">mensagens/ano</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Total Anual</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--green)" id="cenario1-total">44</div>
                    <div style="color:var(--txt3);font-size:0.75rem">mensagens/ano</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Média Semanal</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--green)" id="cenario1-semanal">0.8</div>
                    <div style="color:var(--txt3);font-size:0.75rem">msgs/semana</div>
                  </div>
                </div>
              </div>

              <!-- Cenário 2 -->
              <div style="background:var(--amber-lo);border:1px solid var(--amber);border-radius:10px;padding:16px">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
                  <span style="font-size:1.5rem">⚠️</span>
                  <span style="font-size:1rem;font-weight:700;color:var(--amber)">Devendo 1 Mensalidade (30 dias)</span>
                </div>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;font-size:0.85rem">
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Customer Success</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--txt1)" id="cenario2-cs">44</div>
                    <div style="color:var(--txt3);font-size:0.75rem">mensagens/ano</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Time Financeiro</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--amber)" id="cenario2-fin">30</div>
                    <div style="color:var(--txt3);font-size:0.75rem">1 msg/dia × 30 dias</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Total Anual</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--amber)" id="cenario2-total">74</div>
                    <div style="color:var(--txt3);font-size:0.75rem">+68% vs. aluno em dia</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Média Semanal</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--amber)" id="cenario2-semanal">1.4</div>
                    <div style="color:var(--txt3);font-size:0.75rem">msgs/semana</div>
                  </div>
                </div>
              </div>

              <!-- Cenário 3 -->
              <div style="background:var(--rose-lo);border:1px solid var(--rose);border-radius:10px;padding:16px">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
                  <span style="font-size:1.5rem">🚨</span>
                  <span style="font-size:1rem;font-weight:700;color:var(--rose)">Devedor Crônico (5 mensalidades = 150 dias)</span>
                </div>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;font-size:0.85rem">
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Customer Success</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--txt1)" id="cenario3-cs">44</div>
                    <div style="color:var(--txt3);font-size:0.75rem">mensagens/ano</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Time Financeiro</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--rose)" id="cenario3-fin">150</div>
                    <div style="color:var(--txt3);font-size:0.75rem">1 msg/dia × 150 dias</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Total Anual</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--rose)" id="cenario3-total">194</div>
                    <div style="color:var(--txt3);font-size:0.75rem">+341% vs. aluno em dia</div>
                  </div>
                  <div style="padding:10px;background:var(--card);border-radius:8px">
                    <div style="color:var(--txt3);margin-bottom:4px">Média Semanal</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--rose)" id="cenario3-semanal">3.7</div>
                    <div style="color:var(--txt3);font-size:0.75rem">msgs/semana</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Insights -->
          <div style="margin-top:32px;background:var(--wu-blue-glow);border:1px solid var(--accent);border-radius:12px;padding:20px">
            <div style="font-size:1.1rem;font-weight:700;color:var(--txt1);margin-bottom:16px;display:flex;align-items:center;gap:10px">
              <span>💡</span>
              <span>Insights Estratégicos</span>
            </div>
            <div style="display:grid;gap:12px">
              <div style="display:flex;gap:12px;align-items:flex-start">
                <div style="font-size:1.2rem;flex-shrink:0">📊</div>
                <div style="color:var(--txt1);font-size:0.9rem">
                  <strong>Volume de CS é consistente:</strong> As <strong>44 mensagens anuais</strong> do CS são planejadas e estratégicas, 
                  independente do status de pagamento do aluno.
                </div>
              </div>
              <div style="display:flex;gap:12px;align-items:flex-start">
                <div style="font-size:1.2rem;flex-shrink:0">⚠️</div>
                <div style="color:var(--txt1);font-size:0.9rem">
                  <strong>Inadimplência aumenta sobrecarga:</strong> Um aluno devendo 1 mês recebe <strong>+68% mais mensagens</strong>, 
                  podendo gerar fadiga de comunicação.
                </div>
              </div>
              <div style="display:flex;gap:12px;align-items:flex-start">
                <div style="font-size:1.2rem;flex-shrink:0">🚨</div>
                <div style="color:var(--txt1);font-size:0.9rem">
                  <strong>Devedores crônicos:</strong> Recebem <strong>quase 4 mensagens por semana</strong> (194/ano), sendo 77% do financeiro. 
                  Isso pode deteriorar a relação com a marca.
                </div>
              </div>
              <div style="display:flex;gap:12px;align-items:flex-start">
                <div style="font-size:1.2rem;flex-shrink:0">✅</div>
                <div style="color:var(--txt1);font-size:0.9rem">
                  <strong>Recomendação:</strong> Coordenar com o time Financeiro para evitar sobreposição de mensagens e garantir 
                  experiência mais equilibrada para alunos em recuperação de dívida.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        📅 Linha do Tempo de Mensagens
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="timeline-chart" id="timelineChart">
          <!-- Timeline chart will be populated by JavaScript -->
        </div>
      </div>
    </div>

    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        🏷️ Canais & Cenários
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="channel-breakdown tags-single-line" id="tagBreakdown">
          <!-- Tag breakdown will be populated by JavaScript -->
        </div>
      </div>
    </div>

    <!-- CALENDÁRIO APROXIMADO -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        📅 Calendário Aproximado
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="card" style="border:2px solid var(--border-hi)">
          <div class="section-subtitle" style="margin-bottom:24px">
            Frequência de comunicação ao longo da jornada do aluno
          </div>

      <div style="display:grid;gap:20px">
        <!-- Mês 1 -->
        <div style="background:var(--card-hi);border-left:4px solid var(--rose);padding:20px;border-radius:12px">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
            <div style="font-size:2rem">🔥</div>
            <div>
              <div style="font-size:1.2rem;font-weight:700;color:var(--txt1)">Mês 1 (Critical Window)</div>
              <div style="font-size:0.85rem;color:var(--rose);font-weight:600;font-family:'JetBrains Mono',monospace">10–12 contatos</div>
            </div>
          </div>
          <ul style="list-style:none;padding:0;margin:0;display:grid;gap:8px">
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              <strong style="color:var(--txt1)">Dia 0:</strong> Boas-vindas + Agendamento
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              <strong style="color:var(--txt1)">Dia 1–2:</strong> Aula Zero + Follow-up
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              <strong style="color:var(--txt1)">Dia 3:</strong> Check-in inicial
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              <strong style="color:var(--txt1)">Dia 7:</strong> Check-in semanal
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              <strong style="color:var(--txt1)">Dia 14:</strong> Dica de estudo
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              <strong style="color:var(--txt1)">Dia 30:</strong> Revisão do mês
            </li>
            <li style="padding:8px 12px;background:var(--accent-lo);border-radius:8px;font-size:0.9rem;color:var(--accent);border:1px solid var(--accent)">
              <strong>+ Gatilhos:</strong> 1ª aula, 5ª aula, streak
            </li>
          </ul>
        </div>

        <!-- Meses 2-3 -->
        <div style="background:var(--card-hi);border-left:4px solid var(--amber);padding:20px;border-radius:12px">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
            <div style="font-size:2rem">📈</div>
            <div>
              <div style="font-size:1.2rem;font-weight:700;color:var(--txt1)">Meses 2–3</div>
              <div style="font-size:0.85rem;color:var(--amber);font-weight:600;font-family:'JetBrains Mono',monospace">4–6 contatos/mês</div>
            </div>
          </div>
          <ul style="list-style:none;padding:0;margin:0;display:grid;gap:8px">
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Check-in mensal leve
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Dica quinzenal
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Checkpoint Trimestral (mês 3)
            </li>
            <li style="padding:8px 12px;background:var(--accent-lo);border-radius:8px;font-size:0.9rem;color:var(--accent);border:1px solid var(--accent)">
              <strong>+ Gatilhos:</strong> Performance e marcos
            </li>
          </ul>
        </div>

        <!-- Meses 4-12 -->
        <div style="background:var(--card-hi);border-left:4px solid var(--wu-blue);padding:20px;border-radius:12px">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
            <div style="font-size:2rem">🎯</div>
            <div>
              <div style="font-size:1.2rem;font-weight:700;color:var(--txt1)">Meses 4–12</div>
              <div style="font-size:0.85rem;color:var(--wu-blue);font-weight:600;font-family:'JetBrains Mono',monospace">2–3 contatos/mês</div>
            </div>
          </div>
          <ul style="list-style:none;padding:0;margin:0;display:grid;gap:8px">
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Check-in mensal
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Conteúdo de valor (dicas, curiosidades, notícias)
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Checkpoints trimestrais (meses 6, 9, 12)
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Certificados de módulo (50h) + Aniversários
            </li>
          </ul>
        </div>

        <!-- Meses 13-24 -->
        <div style="background:var(--card-hi);border-left:4px solid var(--green);padding:20px;border-radius:12px">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
            <div style="font-size:2rem">🚀</div>
            <div>
              <div style="font-size:1.2rem;font-weight:700;color:var(--txt1)">Meses 13–24</div>
              <div style="font-size:0.85rem;color:var(--green);font-weight:600;font-family:'JetBrains Mono',monospace">2 contatos/mês</div>
            </div>
          </div>
          <ul style="list-style:none;padding:0;margin:0;display:grid;gap:8px">
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Check-in mensal leve + Conteúdo de valor
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Checkpoints trimestrais (meses 15, 18, 21, 24)
            </li>
            <li style="padding:8px 12px;background:var(--card);border-radius:8px;font-size:0.9rem;color:var(--txt2)">
              Celebrações de marcos + Renovação
            </li>
          </ul>
        </div>
      </div>
        </div>
      </div>
    </div>

    <!-- PRÓXIMAS IMPLEMENTAÇÕES -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        🚀 Próximas Implementações
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="card" style="background:linear-gradient(135deg,var(--card) 0%,var(--card-hi) 100%);border:2px solid var(--border-hi)">
          <div style="font-size:0.9rem;color:var(--txt3);margin-bottom:20px">Roadmap de evolução da régua de comunicação</div>

      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:16px">
        <!-- Preferências do Aluno - Mockup Mobile (Full Width) -->
        <div style="background:var(--card);border:1px solid var(--border-hi);border-radius:12px;padding:20px;grid-column:1/-1">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
            <div style="font-size:1.3rem">⚙️</div>
            <div style="font-size:1rem;font-weight:600;color:var(--txt1)">Preferências de Comunicação — Tela Pós-Matrícula</div>
          </div>
          <div style="color:var(--txt3);font-size:0.8rem;line-height:1.5;margin-bottom:20px">
            Mockup da interface que o aluno veria no app após se matricular. Essas configurações personalizariam automaticamente a régua de comunicação.
          </div>
          
          <!-- Container do Mockup Mobile -->
          <div style="max-width:420px;margin:0 auto">
            <!-- Frame do Celular -->
            <div style="background:var(--bg);border:3px solid var(--border-hi);border-radius:32px;padding:16px 12px;box-shadow:0 10px 40px rgba(0,102,255,0.2)">
              
              <!-- Status Bar -->
              <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 16px;margin-bottom:12px">
                <div style="color:var(--txt2);font-size:0.75rem;font-family:'JetBrains Mono',monospace">9:41</div>
                <div style="display:flex;gap:4px;align-items:center">
                  <div style="color:var(--txt2);font-size:0.75rem">📶</div>
                  <div style="color:var(--txt2);font-size:0.75rem">📡</div>
                  <div style="color:var(--txt2);font-size:0.75rem">🔋</div>
                </div>
              </div>

              <!-- Header do App -->
              <div style="padding:16px 16px 20px;background:var(--card);border-radius:20px 20px 0 0;border-bottom:1px solid var(--border)">
                <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
                  <button style="background:var(--card-hi);border:1px solid var(--border);width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--txt2)">←</button>
                  <div>
                    <div style="font-size:1.1rem;font-weight:700;color:var(--txt1)">Minhas Preferências</div>
                    <div style="font-size:0.75rem;color:var(--txt3)">Personalize sua experiência</div>
                  </div>
                </div>
              </div>

              <!-- Conteúdo Scrollável -->
              <div style="background:var(--card);padding:20px 16px;max-height:520px;overflow-y:auto;border-radius:0 0 20px 20px">
                
                <!-- Seção: Tipos de Notificação -->
                <div style="margin-bottom:24px">
                  <div style="font-size:0.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--txt3);font-weight:700;margin-bottom:12px;font-family:'JetBrains Mono',monospace">📬 Tipos de Notificação</div>
                  
                  <div style="background:var(--card-hi);border:1px solid var(--border);border-radius:12px;overflow:hidden">
                    <!-- Dicas de Estudo -->
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid var(--border)">
                      <div style="display:flex;align-items:center;gap:12px">
                        <span style="font-size:1.3rem">💡</span>
                        <span style="color:var(--txt1);font-size:0.95rem;font-weight:500">Dicas de Estudo</span>
                      </div>
                      <div class="toggle-switch" onclick="togglePreference(this)" data-active="true">
                        <div class="toggle-slider"></div>
                      </div>
                    </div>
                    
                    <!-- Curiosidades -->
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid var(--border)">
                      <div style="display:flex;align-items:center;gap:12px">
                        <span style="font-size:1.3rem">🌍</span>
                        <span style="color:var(--txt1);font-size:0.95rem;font-weight:500">Curiosidades Culturais</span>
                      </div>
                      <div class="toggle-switch" onclick="togglePreference(this)" data-active="true">
                        <div class="toggle-slider"></div>
                      </div>
                    </div>
                    
                    <!-- Celebrações -->
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid var(--border)">
                      <div style="display:flex;align-items:center;gap:12px">
                        <span style="font-size:1.3rem">🎉</span>
                        <span style="color:var(--txt1);font-size:0.95rem;font-weight:500">Celebrações</span>
                      </div>
                      <div class="toggle-switch" onclick="togglePreference(this)" data-active="true">
                        <div class="toggle-slider"></div>
                      </div>
                    </div>
                    
                    <!-- Ofertas -->
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:14px 16px">
                      <div style="display:flex;align-items:center;gap:12px">
                        <span style="font-size:1.3rem">🎁</span>
                        <span style="color:var(--txt1);font-size:0.95rem;font-weight:500">Ofertas e Novidades</span>
                      </div>
                      <div class="toggle-switch" onclick="togglePreference(this)" data-active="true">
                        <div class="toggle-slider"></div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Seção: Frequência -->
                <div style="margin-bottom:24px">
                  <div style="font-size:0.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--txt3);font-weight:700;margin-bottom:8px;font-family:'JetBrains Mono',monospace">📊 Frequência de Mensagens</div>
                  <div style="font-size:0.8rem;color:var(--txt3);margin-bottom:12px">Com que frequência deseja receber conteúdo educacional?</div>
                  
                  <div style="background:var(--card-hi);border:1px solid var(--border);border-radius:12px;padding:4px">
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:4px">
                      <button style="padding:12px;background:var(--card);border:1px solid var(--border);border-radius:8px;color:var(--txt2);font-size:0.85rem;font-weight:600;cursor:pointer;transition:all 0.3s ease">
                        <div style="margin-bottom:4px">📅</div>
                        <div>Semanal</div>
                        <div style="font-size:0.7rem;color:var(--txt3);margin-top:2px">1x/sem</div>
                      </button>
                      <button style="padding:12px;background:var(--accent);border:1px solid var(--accent);border-radius:8px;color:var(--bg);font-size:0.85rem;font-weight:700;cursor:pointer;box-shadow:0 0 12px var(--accent-lo)">
                        <div style="margin-bottom:4px">📆</div>
                        <div>Quinzenal</div>
                        <div style="font-size:0.7rem;opacity:0.9;margin-top:2px">2x/mês</div>
                      </button>
                      <button style="padding:12px;background:var(--card);border:1px solid var(--border);border-radius:8px;color:var(--txt2);font-size:0.85rem;font-weight:600;cursor:pointer;transition:all 0.3s ease">
                        <div style="margin-bottom:4px">📋</div>
                        <div>Mensal</div>
                        <div style="font-size:0.7rem;color:var(--txt3);margin-top:2px">1x/mês</div>
                      </button>
                    </div>
                  </div>
                </div>

                <!-- Seção: Canal Preferido -->
                <div style="margin-bottom:24px">
                  <div style="font-size:0.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--txt3);font-weight:700;margin-bottom:8px;font-family:'JetBrains Mono',monospace">📱 Canal Preferido</div>
                  <div style="font-size:0.8rem;color:var(--txt3);margin-bottom:12px">Onde prefere receber nossas mensagens?</div>
                  
                  <div style="background:var(--card-hi);border:1px solid var(--border);border-radius:12px;overflow:hidden">
                    <label style="display:flex;align-items:center;gap:12px;padding:14px 16px;border-bottom:1px solid var(--border);cursor:pointer">
                      <input type="radio" name="channelPref" checked style="width:20px;height:20px;accent-color:var(--wu-blue)">
                      <span style="font-size:1.3rem">💬</span>
                      <span style="flex:1;color:var(--txt1);font-size:0.95rem;font-weight:500">WhatsApp</span>
                    </label>
                    <label style="display:flex;align-items:center;gap:12px;padding:14px 16px;border-bottom:1px solid var(--border);cursor:pointer">
                      <input type="radio" name="channelPref" style="width:20px;height:20px;accent-color:var(--wu-blue)">
                      <span style="font-size:1.3rem">📧</span>
                      <span style="flex:1;color:var(--txt1);font-size:0.95rem;font-weight:500">E-mail</span>
                    </label>
                    <label style="display:flex;align-items:center;gap:12px;padding:14px 16px;border-bottom:1px solid var(--border);cursor:pointer">
                      <input type="radio" name="channelPref" style="width:20px;height:20px;accent-color:var(--wu-blue)">
                      <span style="font-size:1.3rem">🔔</span>
                      <span style="flex:1;color:var(--txt1);font-size:0.95rem;font-weight:500">Push Notification</span>
                    </label>
                    <label style="display:flex;align-items:center;gap:12px;padding:14px 16px;cursor:pointer">
                      <input type="radio" name="channelPref" style="width:20px;height:20px;accent-color:var(--wu-blue)">
                      <span style="font-size:1.3rem">📱</span>
                      <span style="flex:1;color:var(--txt1);font-size:0.95rem;font-weight:500">SMS</span>
                    </label>
                  </div>
                </div>

                <!-- Seção: Horário Preferido -->
                <div style="margin-bottom:20px">
                  <div style="font-size:0.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--txt3);font-weight:700;margin-bottom:8px;font-family:'JetBrains Mono',monospace">🕐 Melhor Horário</div>
                  <div style="font-size:0.8rem;color:var(--txt3);margin-bottom:12px">Quando você geralmente tem mais tempo?</div>
                  
                  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
                    <button style="padding:14px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt2);font-size:0.85rem;font-weight:600;cursor:pointer;text-align:center">
                      <div style="font-size:1.5rem;margin-bottom:6px">🌅</div>
                      <div>Manhã</div>
                      <div style="font-size:0.7rem;color:var(--txt3);margin-top:2px">7h-12h</div>
                    </button>
                    <button style="padding:14px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt2);font-size:0.85rem;font-weight:600;cursor:pointer;text-align:center">
                      <div style="font-size:1.5rem;margin-bottom:6px">☀️</div>
                      <div>Tarde</div>
                      <div style="font-size:0.7rem;color:var(--txt3);margin-top:2px">12h-18h</div>
                    </button>
                    <button style="padding:14px;background:var(--accent);border:1px solid var(--accent);border-radius:10px;color:var(--bg);font-size:0.85rem;font-weight:700;cursor:pointer;text-align:center;box-shadow:0 0 12px var(--accent-lo)">
                      <div style="font-size:1.5rem;margin-bottom:6px">🌙</div>
                      <div>Noite</div>
                      <div style="font-size:0.7rem;opacity:0.9;margin-top:2px">18h-23h</div>
                    </button>
                  </div>
                </div>

                <!-- Botão Salvar -->
                <button style="width:100%;padding:16px;background:var(--green);border:none;border-radius:12px;color:var(--bg);font-size:1rem;font-weight:700;cursor:pointer;box-shadow:0 4px 16px rgba(0,255,136,0.3);margin-top:8px">
                  Salvar Preferências
                </button>

              </div>
            </div>
          </div>
        </div>

        <!-- Integração CRM -->
        <div style="background:var(--card);border:1px solid var(--border-hi);border-radius:12px;padding:18px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
            <div style="font-size:1.5rem">🔗</div>
            <div style="font-size:1.1rem;font-weight:600;color:var(--txt1)">Integração com CRM</div>
          </div>
          <div style="color:var(--txt2);font-size:0.9rem;line-height:1.7;margin-bottom:12px">
            Conexão direta com ferramentas de gestão de relacionamento:
          </div>
          <div style="display:grid;gap:8px">
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--green);font-weight:700">✓</div>
              <div style="color:var(--txt2);font-size:0.85rem"><strong style="color:var(--txt1)">Automação Total:</strong> Disparo automático via Zapier, Make ou API nativa</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--green);font-weight:700">✓</div>
              <div style="color:var(--txt2);font-size:0.85rem"><strong style="color:var(--txt1)">Sincronização Automática:</strong> Atualização periódica de dados com a plataforma de ensino</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--green);font-weight:700">✓</div>
              <div style="color:var(--txt2);font-size:0.85rem"><strong style="color:var(--txt1)">Tracking de Engajamento:</strong> Taxa de abertura, cliques e respostas por canal</div>
            </div>
          </div>
        </div>

        <!-- Templates Editáveis -->
        <div style="background:var(--card);border:1px solid var(--border-hi);border-radius:12px;padding:18px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
            <div style="font-size:1.5rem">📝</div>
            <div style="font-size:1.1rem;font-weight:600;color:var(--txt1)">Biblioteca de Templates</div>
          </div>
          <div style="color:var(--txt2);font-size:0.9rem;line-height:1.7;margin-bottom:12px">
            Editor de mensagens com personalização avançada:
          </div>
          <div style="display:grid;gap:8px">
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--purple);font-weight:700">→</div>
              <div style="color:var(--txt2);font-size:0.85rem">Interface visual para edição de templates</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--purple);font-weight:700">→</div>
              <div style="color:var(--txt2);font-size:0.85rem">Variáveis dinâmicas ([Nome], [Aulas], [Horas], etc.)</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--purple);font-weight:700">→</div>
              <div style="color:var(--txt2);font-size:0.85rem">Versionamento e histórico de alterações</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--purple);font-weight:700">→</div>
              <div style="color:var(--txt2);font-size:0.85rem">Preview em tempo real para cada canal</div>
            </div>
          </div>
        </div>

        <!-- Analytics & A/B Testing -->
        <div style="background:var(--card);border:1px solid var(--border-hi);border-radius:12px;padding:18px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
            <div style="font-size:1.5rem">📊</div>
            <div style="font-size:1.1rem;font-weight:600;color:var(--txt1)">Analytics & A/B Testing</div>
          </div>
          <div style="color:var(--txt2);font-size:0.9rem;line-height:1.7;margin-bottom:12px">
            Métricas e otimização baseada em dados:
          </div>
          <div style="display:grid;gap:8px">
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--amber);font-weight:700">📈</div>
              <div style="color:var(--txt2);font-size:0.85rem"><strong style="color:var(--txt1)">KPIs:</strong> Taxa de resposta, engajamento, NPS, churn prevention rate</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--amber);font-weight:700">🧪</div>
              <div style="color:var(--txt2);font-size:0.85rem"><strong style="color:var(--txt1)">Testes A/B:</strong> Comparar variantes de mensagens automaticamente</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--amber);font-weight:700">🎯</div>
              <div style="color:var(--txt2);font-size:0.85rem"><strong style="color:var(--txt1)">Recomendações:</strong> IA sugere melhor timing e canal por perfil</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--amber);font-weight:700">📉</div>
              <div style="color:var(--txt2);font-size:0.85rem"><strong style="color:var(--txt1)">Predição de Churn:</strong> Score de risco baseado em padrões</div>
            </div>
          </div>
        </div>

        <!-- Inteligência Artificial -->
        <div style="background:var(--card);border:1px solid var(--border-hi);border-radius:12px;padding:18px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
            <div style="font-size:1.5rem">🤖</div>
            <div style="font-size:1.1rem;font-weight:600;color:var(--txt1)">Inteligência Artificial</div>
          </div>
          <div style="color:var(--txt2);font-size:0.9rem;line-height:1.7;margin-bottom:12px">
            Personalização avançada com machine learning:
          </div>
          <div style="display:grid;gap:8px">
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--teal);font-weight:700">★</div>
              <div style="color:var(--txt2);font-size:0.85rem">Geração automática de variantes de mensagens</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--teal);font-weight:700">★</div>
              <div style="color:var(--txt2);font-size:0.85rem">Adaptação de tom e linguagem por perfil do aluno</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--teal);font-weight:700">★</div>
              <div style="color:var(--txt2);font-size:0.85rem">Previsão do melhor horário de envio individual</div>
            </div>
            <div style="display:flex;gap:10px;align-items:flex-start">
              <div style="color:var(--teal);font-weight:700">★</div>
              <div style="color:var(--txt2);font-size:0.85rem">Análise de sentimento nas respostas dos alunos</div>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top:24px;padding:16px;background:var(--accent-lo);border-radius:10px;border:1px solid var(--accent)">
        <div style="color:var(--accent);font-size:0.85rem;line-height:1.7;text-align:center;word-wrap:break-word;overflow-wrap:break-word;max-width:100%">
          💡 <strong>Roadmap em constante evolução.</strong> Sugestões e feedback são sempre bem-vindos para tornar a régua ainda mais eficaz!
        </div>
      </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TAB: LINHA DO TEMPO -->
  <div id="timeline" class="tab-content">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; flex-wrap: wrap; gap: 12px;">
      <div>
        <div class="section-title">Linha do Tempo</div>
        <div class="section-subtitle">
          Visualize toda a jornada de comunicação do aluno em diferentes contextos
        </div>
      </div>
      <button class="export-btn" onclick="exportToExcel()">📥 Exportar para Excel</button>
    </div>

    <!-- Filtros -->
    <div class="filter-bar">
      <span class="filter-label">Visualizar:</span>
      <button class="filter-btn active" data-view="fases" onclick="filterTimeline('fases', this)">🌱 Fases da Jornada</button>
      <button class="filter-btn" data-view="gatilhos" onclick="filterTimeline('gatilhos', this)">⚡ Gatilhos Comportamentais</button>
      <button class="filter-btn" data-view="recuperacao" onclick="filterTimeline('recuperacao', this)">🚨 Recuperação</button>
    </div>

    <!-- Conteúdo será preenchido via JavaScript -->
    <div id="timelineContent"></div>
  </div>

  <!-- TAB: SIMULADOR -->
  <div id="simulador" class="tab-content">
    <div class="section-title">Simulador de Régua</div>
    <div class="section-subtitle">
      Simule quais mensagens um aluno receberia baseado em seu perfil e comportamento
    </div>
    
    <!-- Formulário -->
    <div class="card" style="margin-bottom:24px">
      <div class="variant-label" style="margin-bottom:16px">👤 Dados do Aluno</div>
      
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:16px">
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Nome do Aluno</label>
          <input type="text" id="simNome" placeholder="Ex: João Silva" value="João Silva" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
        </div>
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Data de Matrícula</label>
          <input type="date" id="simMatricula" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
        </div>
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Data de Nascimento</label>
          <input type="date" id="simNascimento" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
        </div>
      </div>
      
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:16px">
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Último Login</label>
          <input type="date" id="simUltimoLogin" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
        </div>
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Aulas Realizadas</label>
          <input type="number" id="simAulas" placeholder="Ex: 8" value="8" min="0" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
        </div>
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Horas Completadas</label>
          <input type="number" id="simHoras" placeholder="Ex: 25" value="25" min="0" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
        </div>
      </div>
      
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:20px">
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Canal Preferencial</label>
          <select id="simCanal" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
            <option value="WhatsApp">📱 WhatsApp</option>
            <option value="Email">📧 Email</option>
            <option value="SMS">💬 SMS</option>
            <option value="Ligação">📞 Ligação</option>
          </select>
        </div>
        <div>
          <label style="display:block;font-size:0.8rem;color:var(--txt3);margin-bottom:6px;font-weight:600">Status Atual</label>
          <select id="simStatus" style="width:100%;padding:10px 12px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;color:var(--txt1);font-family:inherit;font-size:0.9rem">
            <option value="ativo">✅ Ativo</option>
            <option value="recuperacao">⚠️ Em Recuperação</option>
            <option value="inativo">🔴 Inativo</option>
          </select>
        </div>
      </div>
      
      <!-- Modo de Simulação -->
      <div style="margin-bottom:20px">
        <label style="display:block;font-size:0.9rem;color:var(--txt2);margin-bottom:12px;font-weight:600">Modo de Simulação</label>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <button onclick="setSimulationMode('pontual')" id="btnModoPontual" class="sim-mode-btn active" style="padding:12px;background:var(--accent);color:white;border:none;border-radius:10px;font-size:0.95rem;font-weight:600;cursor:pointer;transition:all 0.3s;font-family:inherit">
            🎯 Simulação Pontual
          </button>
          <button onclick="setSimulationMode('jornada')" id="btnModoJornada" class="sim-mode-btn" style="padding:12px;background:var(--card-hi);color:var(--txt2);border:1px solid var(--border);border-radius:10px;font-size:0.95rem;font-weight:600;cursor:pointer;transition:all 0.3s;font-family:inherit">
            🗓️ Jornada Completa
          </button>
        </div>
        <div id="modoDesc" style="margin-top:10px;padding:12px;background:var(--accent-lo);border-left:3px solid var(--accent);border-radius:8px;font-size:0.85rem;color:var(--txt2)">
          Mostra mensagens pontuais baseadas no perfil atual do aluno (checkpoints, milestones, inatividade)
        </div>
      </div>

      <button onclick="simularRegua()" style="width:100%;padding:14px;background:var(--accent);color:white;border:none;border-radius:12px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.3s;font-family:inherit">
        🎯 Simular
      </button>
    </div>
    
    <!-- Resultados -->
    <div id="simResultados"></div>
  </div>

</div>

<style>
.sim-mode-btn.active {
  background: var(--accent) !important;
  color: white !important;
  border-color: var(--accent) !important;
}
.sim-mode-btn:hover {
  transform: translateY(-2px);
}
</style>


<script>
// ═══════════════════════════════════════════════════════════
// DADOS - MENSAGENS DAS FASES
// ═══════════════════════════════════════════════════════════
let simulationMode = 'pontual'; // 'pontual' ou 'jornada'

function setSimulationMode(mode) {
  simulationMode = mode;
  
  // Atualizar botões
  document.getElementById('btnModoPontual').classList.toggle('active', mode === 'pontual');
  document.getElementById('btnModoJornada').classList.toggle('active', mode === 'jornada');
  
  // Atualizar descrição
  const desc = document.getElementById('modoDesc');
  if (mode === 'pontual') {
    desc.innerHTML = '🎯 Mostra mensagens pontuais baseadas no perfil atual do aluno (checkpoints, milestones, inatividade)';
  } else {
    desc.innerHTML = '🗓️ Mostra TODAS as mensagens da jornada: histórico completo desde a matrícula + próximas mensagens';
  }
}

const MENSAGENS_FASES = [
  {
    fase: "fase-1---onboarding",
    nome: "Fase 1 - Onboarding",
    badge: "Dia 0",
    mensagens: [
      {
        titulo: "Boas-vindas",
        timing: "Dentro de 24h da matrícula",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Primeiro contato + agendamento Aula Zero",
        texto: "Olá, {{nomedoaluno}}. Seja muito bem-vindo(a) ao Wise Up Online! Sou a Cecilia do suporte Live e vou te acompanhar nessa jornada incrível. 🎉 Como parte do processo inicial para novos alunos, precisamos de cerca de 10min com você para verificar o acesso ao Zoom e liberar seu documento de assinatura. Você poderia me informar qual o melhor horário hoje e em qual estado você está, para que eu confira o fuso corretamente?"
      },
    ]
  },
  {
    fase: "fase-10---refinamento",
    nome: "Fase 10 - Refinamento",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Dica Profissional",
        timing: "Semana 67",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Aplicação prática",
        texto: "💼 Dica: Use inglês no trabalho sempre que possível. Emails, apresentações... Cada oportunidade conta!"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo módulo",
        texto: "Bom dia! Novo mês de aprendizado começando 🚀"
      },
      {
        titulo: "Quiz Avançado",
        timing: "Semana 70",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Desafio",
        texto: "🧠 Advanced quiz! \'Neither John ___ Mary came to the party.\' (a) or (b) nor (c) and"
      },
      {
        titulo: "⭐ Lembrete Checkpoint",
        timing: "Dia 18 do mês (~21 meses)",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Lembrar do teste oficial",
        texto: "E aí, [Nome]! 📊 Checkpoint Trimestral já está no ar! Você está quase na reta final. Bora garantir mais um certificado? 70+ pontos! Até dia 27! 🏆"
      },
      {
        titulo: "Milestone 18 Meses",
        timing: "~Mês 18",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Marco 1,5 ano",
        texto: "1 ano e meio! 🎉 Sua evolução é inspiradora. Continue firme nos estudos!"
      },
      {
        titulo: "Dica Cultural Avançada",
        timing: "Semana 75",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Refinamento cultural",
        texto: "🎭 Assista stand-up comedy em inglês. Entender humor é sinal de fluência avançada!"
      },
      {
        titulo: "Quiz Expressões 2",
        timing: "Semana 76",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Idioms avançados",
        texto: "\'It\'s raining cats and dogs\' means: (a) chuva forte (b) chuva leve (c) sem chuva"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo ciclo",
        texto: "Novo mês chegando! Suas aulas ao vivo continuam com ótimo conteúdo 💙"
      },
    ]
  },
  {
    fase: "fase-11---período-renovacao-final",
    nome: "Fase 11 - Período Renovação Final",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "⚠️ BLACKOUT RENOVAÇÃO 24M",
        timing: "Semanas 78-83",
        canal: "🚫 SEM ENVIO",
        tags: ["Operacional"],
        objetivo: "Espaço para time comercial",
        texto: "🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua para alunos de 24 meses próximos da conclusão"
      },
    ]
  },
  {
    fase: "fase-11---reta-final",
    nome: "Fase 11 - Reta Final",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Milestone 20+ Meses",
        timing: "~Semana 84",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Reta final",
        texto: "Você está na reta final! 🏆 Que jornada incrível até aqui. Continue aproveitando cada aula!"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Penúltimo/último mês",
        texto: "Olá! Estamos chegando ao final da jornada juntos 💙 Aproveite cada aula!"
      },
      {
        titulo: "Dica Pós-Curso",
        timing: "Semana 87",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Preparação saída",
        texto: "🌍 Já pensou em fazer intercâmbio ou viagem internacional? Seu inglês está pronto!"
      },
    ]
  },
  {
    fase: "fase-12---conclusao",
    nome: "Fase 12 - Conclusão",
    badge: "Final",
    mensagens: [
      {
        titulo: "Preparação Conclusão",
        timing: "Semana 92",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Certificado/próximos passos",
        texto: "Parabéns por chegar até aqui! Em breve você receberá informações sobre seu certificado de conclusão 🎓"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Último mês",
        texto: "Último mês de jornada formal! 💙 Que orgulho da sua trajetória!"
      },
      {
        titulo: "Milestone 2 ANOS",
        timing: "~Mês 24",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "CONCLUSÃO 24 MESES",
        texto: "🎉🎓 PARABÉNS! 2 ANOS DE DEDICAÇÃO COMPLETOS! Você transformou completamente seu inglês. Essa conquista é gigante e você deve se orgulhar muito! 🏆"
      },
      {
        titulo: "Pesquisa Satisfação",
        timing: "Pós-conclusão +2 dias",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "NPS/Feedback",
        texto: "Olá! Gostaríamos muito de saber sobre sua experiência conosco. Pode responder nossa breve pesquisa de satisfação? Sua opinião é muito importante! [link]"
      },
    ]
  },
  {
    fase: "fase-2---primeiros-30-dias",
    nome: "Fase 2 - Primeiros 30 Dias",
    badge: "Mês 1",
    mensagens: [
      {
        titulo: "Check-in Inicial",
        timing: "Dia 9 após matrícula",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Verificar exploração do material",
        texto: "Oi {{nomedoaluno}}! Passando só pra saber se já explorou o Material Didático? Tem alguma dúvida que eu possa te ajudar?"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês seguinte",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Motivar início de módulo",
        texto: "Passando pra te desejar um ótimo começo de mês! 😊 As aulas ao vivo iniciam nessa primeira semana com um novo conteúdo. Corre conferir qual módulo será abordado e inicie suas preparações para a primeira aula!"
      },
    ]
  },
  {
    fase: "fase-3---consolidacao",
    nome: "Fase 3 - Consolidação",
    badge: "Mês 2-3",
    mensagens: [
      {
        titulo: "Dica de Estudo",
        timing: "Semana 6",
        canal: "📱 WhatsApp",
        tags: ["Engajamento"],
        objetivo: "Engajamento educacional",
        texto: "Dica da semana! 💡 Sabia que revisar o material antes da aula aumenta em 40% sua retenção? Dá uma olhadinha nas preparações da próxima aula. Você vai arrasar! 🌟"
      },
      {
        titulo: "Milestone 45 Dias",
        timing: "~Dia 45",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Reconhecimento",
        texto: "Você já completou 45+ dias no seu curso de inglês! Continue firme, cada dia conta na sua evolução. 🎉"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo módulo",
        texto: "Um novo mês começou 🌟 E com ele, um novo módulo nas aulas ao vivo de inglês, perfeito pra dar mais um passo na sua evolução."
      },
    ]
  },
  {
    fase: "fase-4---marcos-da-jornada",
    nome: "Fase 4 - Marcos da Jornada",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Dica Prática",
        timing: "Semana 12",
        canal: "📱 WhatsApp",
        tags: ["Engajamento"],
        objetivo: "Engajamento cultural",
        texto: "Dica 💡 Mudar o idioma do celular para inglês ajuda muito na familiaridade com palavras do dia a dia."
      },
      {
        titulo: "⭐ Lembrete Checkpoint",
        timing: "Dia 18 do mês (~3,5 meses)",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Lembrar do teste oficial",
        texto: "Oi [Nome]! 📊 Seu Checkpoint Trimestral já está liberado na página inicial até o dia 27! É a chance de testar seus conhecimentos e, com 70 pontos ou mais, você avança de nível e recebe seu certificado. Bora lá! 🎓"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo conteúdo",
        texto: "[Nome], um novo mês começou! As aulas ao vivo já estão rolando com conteúdo novo preparado pra você 💙"
      },
      {
        titulo: "Quiz Interativo",
        timing: "Semana 15",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Interação lúdica",
        texto: "Quiz time 🎯 Complete: \'This week, I ___ study English.\' (a) will (b) am (c) did. Responde aqui 😊"
      },
    ]
  },
  {
    fase: "fase-5---nutricao-contínua",
    nome: "Fase 5 - Nutrição Contínua",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Dica Semanal",
        timing: "Semana 17",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Imersão cultural",
        texto: "Dica da Semana! 💡 Assista séries em inglês com legenda em inglês (não em português!). Seu cérebro vai fazer conexões incríveis entre som e escrita. Já tem alguma série favorita?"
      },
      {
        titulo: "Milestone Semestral",
        timing: "~Mês 5",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Reconhecimento",
        texto: "Parabéns! Você completou 5 meses de jornada no inglês 🎉 Cada aula é um tijolo na construção da sua fluência. Continue assim!"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo módulo",
        texto: "Novo mês, nova energia! 🌟 As aulas ao vivo desta semana trazem conteúdo fresquinho. Bora aproveitar?"
      },
      {
        titulo: "Dica Cultural",
        timing: "Semana 23",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Vocabulário expandido",
        texto: "💡 Dica: Siga perfis em inglês nas redes sociais sobre temas que você ama. Aprender fica natural quando é sobre algo que te interessa!"
      },
      {
        titulo: "⭐ Lembrete Checkpoint",
        timing: "Dia 18 do mês (~7 meses)",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Lembrar do teste oficial",
        texto: "Olá [Nome]! 📊 Seu segundo Checkpoint Trimestral está disponível na página inicial! Lembrando: 70 pontos ou mais = novo nível + certificado. Você tem até o dia 27! 💪"
      },
    ]
  },
  {
    fase: "fase-6---rotina-estabelecida",
    nome: "Fase 6 - Rotina Estabelecida",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Quiz Interativo",
        timing: "Semana 26",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Prática rápida",
        texto: "Quick quiz! 🎯 What\'s the past tense of \'go\'? (a) goed (b) went (c) gone. Responde aqui!"
      },
      {
        titulo: "Dica de Pronúncia",
        timing: "Semana 27",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Melhoria técnica",
        texto: "🎙️ Dica de pronúncia: Grave você mesmo falando em inglês e escute depois. Você vai identificar pontos de melhoria rapidinho!"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo ciclo",
        texto: "Olá! Mais um mês de evolução começando 🚀 Seu módulo novo já está liberado nas aulas ao vivo!"
      },
      {
        titulo: "Milestone 8 Meses",
        timing: "~Mês 8",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Reconhecimento evolução",
        texto: "8 meses de dedicação! 🎉 Você já percebeu como está mais confortável com o inglês? Continue, a fluência está cada vez mais próxima!"
      },
      {
        titulo: "Dica Listening",
        timing: "Semana 33",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Compreensão auditiva",
        texto: "💡 Ouça podcasts em inglês enquanto faz outras atividades. Seu ouvido vai se acostumando naturalmente com o idioma!"
      },
    ]
  },
  {
    fase: "fase-7---aprofundamento",
    nome: "Fase 7 - Aprofundamento",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Quiz Cultural",
        timing: "Semana 35",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Curiosidade",
        texto: "🌎 Quiz cultural! In which country do they say \'lift\' instead of \'elevator\'? (a) USA (b) UK (c) Australia"
      },
      {
        titulo: "⭐ Lembrete Checkpoint",
        timing: "Dia 18 do mês (~10,5 meses)",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Lembrar do teste oficial",
        texto: "E aí, [Nome]! 📊 Já viu que seu Checkpoint Trimestral está liberado? É a hora de mostrar tudo que aprendeu! 70+ pontos = próximo nível + certificado. Disponível até dia 27! 🌟"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo módulo",
        texto: "Bom dia! 🌞 Novo mês, novas aulas ao vivo liberadas. Vamos juntos nessa!"
      },
      {
        titulo: "Dica Writing",
        timing: "Semana 39",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Escrita ativa",
        texto: "✍️ Dica: Escreva pequenas anotações do dia a dia em inglês. Lista de compras, lembretes... Tudo conta!"
      },
      {
        titulo: "Milestone 10 Meses",
        timing: "~Mês 10",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Marco importante",
        texto: "10 meses! 🏆 Você está entre os alunos mais dedicados. Sua evolução é inspiradora!"
      },
    ]
  },
  {
    fase: "fase-7---período-renovacao",
    nome: "Fase 7 - Período Renovação",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "⚠️ BLACKOUT RENOVAÇÃO 12M",
        timing: "Semanas 42-47",
        canal: "🚫 SEM ENVIO",
        tags: ["Operacional"],
        objetivo: "Espaço para time comercial",
        texto: "🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua neste período"
      },
    ]
  },
  {
    fase: "fase-8---consolidacao-avancada",
    nome: "Fase 8 - Consolidação Avançada",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Quiz Gramática",
        timing: "Semana 49",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Revisão",
        texto: "Grammar check! 🎯 \'If I ___ you, I would study more.\' (a) was (b) were (c) am"
      },
      {
        titulo: "⭐ Lembrete Checkpoint",
        timing: "Dia 18 do mês (~14 meses)",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Lembrar do teste oficial",
        texto: "Lembrete: O checkpoint Trimestral é liberado na pagina inicial do dia 18/ mês até 27/mês! Bora conquistar mais um certificado? 70+ pontos e você avança!🚀"
      },
    ]
  },
  {
    fase: "fase-8---pós-renovacao-12m",
    nome: "Fase 8 - Pós Renovação 12M",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "🔀 DECISÃO RENOVAÇÃO",
        timing: "Semana 48",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Confirmação status",
        texto: "SE RENOVOU: \'Que alegria saber que você continua conosco! 🎉 Seus próximos 12 meses serão ainda mais incríveis!\' | SE NÃO RENOVOU: Migrar para RÉGUA DE ENCERRAMENTO"
      },
    ]
  },
  {
    fase: "fase-9---ano-2---fluência",
    nome: "Fase 9 - Ano 2 - Fluência",
    badge: "Jornada",
    mensagens: [
      {
        titulo: "Dica Imersão",
        timing: "Semana 52",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Imersão total",
        texto: "🌍 Dica avançada: Tente pensar em inglês durante tarefas simples. É o próximo nível de imersão!"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo módulo",
        texto: "Bom dia! Novo mês chegando com aulas incríveis preparadas pra você 🚀"
      },
      {
        titulo: "Quiz Expressões",
        timing: "Semana 56",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Idioms",
        texto: "💬 What does \'piece of cake\' mean? (a) difícil (b) fácil (c) doce. Responde!"
      },
      {
        titulo: "Dica Avançada",
        timing: "Semana 57",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Refinamento",
        texto: "📖 Já tentou ler um livro inteiro em inglês? Escolha algo que você ama. A fluência vem naturalmente!"
      },
      {
        titulo: "⭐ Lembrete Checkpoint",
        timing: "Dia 18 do mês (~17,5 meses)",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Lembrar do teste oficial",
        texto: "Olá [Nome]! 📊 Mais um Checkpoint Trimestral disponível pra você! Mostre sua evolução: 70+ pontos = certificado + novo nível. Liberado até dia 27! 💪"
      },
      {
        titulo: "Início do Mês",
        timing: "Dia 1 do mês",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Novo ciclo",
        texto: "Olá! Mais um mês iniciando, mais conteúdo novo nas aulas ao vivo 💙"
      },
      {
        titulo: "Milestone 16 Meses",
        timing: "~Mês 16",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Persistência",
        texto: "16 meses de jornada! 🌟 Você está no caminho certo. Fluência é questão de tempo agora!"
      },
      {
        titulo: "Quiz Listening",
        timing: "Semana 64",
        canal: "📱 WhatsApp",
        tags: ["Operacional"],
        objetivo: "Compreensão",
        texto: "🎧 Você tem conseguido entender filmes em inglês sem legenda? (a) Sim (b) Às vezes (c) Ainda não"
      },
    ]
  },
];

const GATILHOS = [
  {
    semana: 3,
    titulo: "Semana 3 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "QUE SEMANA INCRÍVEL, {{nomedoaluno}}! 🔥 Você fez {total_aulas} aulas! Isso é comprometimento de verdade. Continue assim!",
      baixa: "{{nomedoaluno}}, vi que você deu uma olhada na plataforma! 👀 Sabia que se perder alguma aula pode revisitar ela em outra turma dentro da mesma semana? É só acessar a aba live e clicar em \'revisitar aulas\'. 😊",
      zero: "{{nomedoaluno}}, vi que você ainda não começou as aulas. Quer ajuda pra agendar? É super fácil! Posso te mostrar como fazer. 💙"
    },
    variantes: [
      "QUE SEMANA INCRÍVEL, {{nomedoaluno}}! 🔥 Você fez {total_aulas} aulas! Isso é comprometimento de verdade. Continue assim!",
      "{{nomedoaluno}}, vi que você deu uma olhada na plataforma! 👀 Sabia que se perder alguma aula pode revisitar ela em outra turma dentro da mesma semana? É só acessar a aba live e clicar em \'revisitar aulas\'. 😊",
      "{{nomedoaluno}}, vi que você ainda não começou as aulas. Quer ajuda pra agendar? É super fácil! Posso te mostrar como fazer. 💙"
    ]
  },
  {
    semana: 7,
    titulo: "Semana 7 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "Você está VOANDO, {{nomedoaluno}}! 🚀 Seu inglês está ganhando forma a cada estudo! A constância que você vem mantendo é exatamente o que leva à fluência.",
      baixa: "Às vezes a rotina aperta mesmo, né {{nomedoaluno}}? 😊 Que tal a gente conversar pra ajustar o agendamento das suas aulas de inglês pra você conseguir aproveitar mais?",
      zero: "Oi {{nomedoaluno}}! 💙 Quero te ajudar a aproveitar ao máximo seu curso de inglês. Se ainda não conseguiu entrar nas aulas, me conta o que está te travando que a gente resolve juntos."
    },
    variantes: [
      "Você está VOANDO, {{nomedoaluno}}! 🚀 Seu inglês está ganhando forma a cada estudo! A constância que você vem mantendo é exatamente o que leva à fluência.",
      "Às vezes a rotina aperta mesmo, né {{nomedoaluno}}? 😊 Que tal a gente conversar pra ajustar o agendamento das suas aulas de inglês pra você conseguir aproveitar mais?",
      "Oi {{nomedoaluno}}! 💙 Quero te ajudar a aproveitar ao máximo seu curso de inglês. Se ainda não conseguiu entrar nas aulas, me conta o que está te travando que a gente resolve juntos."
    ]
  },
  {
    semana: 10,
    titulo: "Semana 10 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "WOW {{nomedoaluno}}! Que ritmo de estudos é esse?! 🔥 Você está voando! Sua dedicação vai te levar muito longe. Parabéns!",
      baixa: "Oi {{nomedoaluno}}! 💙 Vi que você tem feito poucas aulas ultimamente. Vamos ver juntos como encaixar mais aulas na sua rotina? Sua evolução depende da frequência! 💪",
      zero: "{{nomedoaluno}}, percebi que você está há bastante tempo sem fazer aulas. Vamos conversar? Quero muito te ajudar a retomar. Quando você tem um tempo?"
    },
    variantes: [
      "WOW {{nomedoaluno}}! Que ritmo de estudos é esse?! 🔥 Você está voando! Sua dedicação vai te levar muito longe. Parabéns!",
      "Oi {{nomedoaluno}}! 💙 Vi que você tem feito poucas aulas ultimamente. Vamos ver juntos como encaixar mais aulas na sua rotina? Sua evolução depende da frequência! 💪",
      "{{nomedoaluno}}, percebi que você está há bastante tempo sem fazer aulas. Vamos conversar? Quero muito te ajudar a retomar. Quando você tem um tempo?"
    ]
  },
  {
    semana: 18,
    titulo: "Semana 18 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "{{nomedoaluno}}, que evolução inspiradora! 🌟 Sua frequência nas aulas mostra que você está levando a sério. Continue nesse ritmo!",
      baixa: "{{nomedoaluno}}, percebi que sua frequência caiu um pouco. Tudo bem por aí? Podemos ajustar os horários das aulas para facilitar pra você!",
      zero: "Oi {{nomedoaluno}}, tudo bem? Notei que você ainda não iniciou as aulas. Tem algo que eu possa fazer pra te ajudar a começar? Estou aqui! 💙"
    },
    variantes: [
      "{{nomedoaluno}}, que evolução inspiradora! 🌟 Sua frequência nas aulas mostra que você está levando a sério. Continue nesse ritmo!",
      "{{nomedoaluno}}, percebi que sua frequência caiu um pouco. Tudo bem por aí? Podemos ajustar os horários das aulas para facilitar pra você!",
      "Oi {{nomedoaluno}}, tudo bem? Notei que você ainda não iniciou as aulas. Tem algo que eu possa fazer pra te ajudar a começar? Estou aqui! 💙"
    ]
  },
  {
    semana: 24,
    titulo: "Semana 24 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "Parabéns pela disciplina, {{nomedoaluno}}! 🏆 6 meses de dedicação e você não deixou a peteca cair. Isso é ser vencedor!",
      baixa: "Oi {{nomedoaluno}}! Notei que você tem participado menos das aulas. Vamos achar um jeito de você aproveitar melhor o curso? Estou aqui pra ajudar! 💙",
      zero: "{{nomedoaluno}}, sinto sua falta nas aulas! 💙 Me conta o que está acontecendo? Vamos encontrar uma forma de você começar a estudar?"
    },
    variantes: [
      "Parabéns pela disciplina, {{nomedoaluno}}! 🏆 6 meses de dedicação e você não deixou a peteca cair. Isso é ser vencedor!",
      "Oi {{nomedoaluno}}! Notei que você tem participado menos das aulas. Vamos achar um jeito de você aproveitar melhor o curso? Estou aqui pra ajudar! 💙",
      "{{nomedoaluno}}, sinto sua falta nas aulas! 💙 Me conta o que está acontecendo? Vamos encontrar uma forma de você começar a estudar?"
    ]
  },
  {
    semana: 30,
    titulo: "Semana 30 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "{{nomedoaluno}}, você é exemplo de comprometimento! 💪 Sua constância nas aulas é o diferencial que te levará à fluência.",
      baixa: "{{nomedoaluno}}, a rotina tá pesada? 😊 Vamos tentar reorganizar seus horários de aula pra você conseguir participar mais?",
      zero: "Oi {{nomedoaluno}}! Quero muito te ver nas aulas. O que está impedindo você de começar? Posso te ajudar a resolver! 😊"
    },
    variantes: [
      "{{nomedoaluno}}, você é exemplo de comprometimento! 💪 Sua constância nas aulas é o diferencial que te levará à fluência.",
      "{{nomedoaluno}}, a rotina tá pesada? 😊 Vamos tentar reorganizar seus horários de aula pra você conseguir participar mais?",
      "Oi {{nomedoaluno}}! Quero muito te ver nas aulas. O que está impedindo você de começar? Posso te ajudar a resolver! 😊"
    ]
  },
  {
    semana: 36,
    titulo: "Semana 36 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "Incrível, {{nomedoaluno}}! 9 meses e você segue firme! 🎯 Esse é o caminho do sucesso no inglês!",
      baixa: "Oi {{nomedoaluno}}! Vi que você está com dificuldade pra manter a frequência. Que tal conversarmos sobre isso? Podemos encontrar uma solução juntos!",
      zero: "{{nomedoaluno}}, você tem um curso incrível esperando por você! Me conta o que posso fazer pra te ajudar a dar o primeiro passo?"
    },
    variantes: [
      "Incrível, {{nomedoaluno}}! 9 meses e você segue firme! 🎯 Esse é o caminho do sucesso no inglês!",
      "Oi {{nomedoaluno}}! Vi que você está com dificuldade pra manter a frequência. Que tal conversarmos sobre isso? Podemos encontrar uma solução juntos!",
      "{{nomedoaluno}}, você tem um curso incrível esperando por você! Me conta o que posso fazer pra te ajudar a dar o primeiro passo?"
    ]
  },
  {
    semana: 50,
    titulo: "Semana 50 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "Um ano de excelência, {{nomedoaluno}}! 🎉 Sua frequência exemplar mostra que fluência é resultado de disciplina!",
      baixa: "Oi {{nomedoaluno}}! Um ano se passou e quero te ajudar a aproveitar melhor o curso. Vamos ajustar a rotina de aulas?",
      zero: "{{nomedoaluno}}, um ano se passou e quero muito te ver estudando! Me fala o que posso fazer pra te ajudar a começar? 💙"
    },
    variantes: [
      "Um ano de excelência, {{nomedoaluno}}! 🎉 Sua frequência exemplar mostra que fluência é resultado de disciplina!",
      "Oi {{nomedoaluno}}! Um ano se passou e quero te ajudar a aproveitar melhor o curso. Vamos ajustar a rotina de aulas?",
      "{{nomedoaluno}}, um ano se passou e quero muito te ver estudando! Me fala o que posso fazer pra te ajudar a começar? 💙"
    ]
  },
  {
    semana: 54,
    titulo: "Semana 54 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "{{nomedoaluno}}, você começou o segundo ano com tudo! 🚀 Continue com essa energia incrível!",
      baixa: "{{nomedoaluno}}, você está no segundo ano! Vamos fazer ele ser ainda melhor que o primeiro? Te ajudo a reorganizar os horários!",
      zero: "Oi {{nomedoaluno}}! Você tem mais 12 meses de curso pela frente. Vamos aproveitar esse tempo? Te ajudo a começar!"
    },
    variantes: [
      "{{nomedoaluno}}, você começou o segundo ano com tudo! 🚀 Continue com essa energia incrível!",
      "{{nomedoaluno}}, você está no segundo ano! Vamos fazer ele ser ainda melhor que o primeiro? Te ajudo a reorganizar os horários!",
      "Oi {{nomedoaluno}}! Você tem mais 12 meses de curso pela frente. Vamos aproveitar esse tempo? Te ajudo a começar!"
    ]
  },
  {
    semana: 60,
    titulo: "Semana 60 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "15 meses de consistência! 🏆 {{nomedoaluno}}, você está construindo fluência tijolo por tijolo!",
      baixa: "{{nomedoaluno}}, sinto que você pode aproveitar muito mais o curso. Vamos conversar sobre como aumentar sua frequência?",
      zero: "{{nomedoaluno}}, sinto que você está perdendo uma oportunidade incrível. Vamos conversar sobre como te ajudar a iniciar?"
    },
    variantes: [
      "15 meses de consistência! 🏆 {{nomedoaluno}}, você está construindo fluência tijolo por tijolo!",
      "{{nomedoaluno}}, sinto que você pode aproveitar muito mais o curso. Vamos conversar sobre como aumentar sua frequência?",
      "{{nomedoaluno}}, sinto que você está perdendo uma oportunidade incrível. Vamos conversar sobre como te ajudar a iniciar?"
    ]
  },
  {
    semana: 66,
    titulo: "Semana 66 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "{{nomedoaluno}}, você é prova viva de que dedicação traz resultados! 💙 18 meses de excelência!",
      baixa: "Oi {{nomedoaluno}}! Faltam poucos meses e quero muito ver você aproveitando ao máximo. Podemos ajustar algo?",
      zero: "Oi {{nomedoaluno}}! Ainda dá tempo de aproveitar seu curso. Me conta: o que posso fazer pra você começar?"
    },
    variantes: [
      "{{nomedoaluno}}, você é prova viva de que dedicação traz resultados! 💙 18 meses de excelência!",
      "Oi {{nomedoaluno}}! Faltam poucos meses e quero muito ver você aproveitando ao máximo. Podemos ajustar algo?",
      "Oi {{nomedoaluno}}! Ainda dá tempo de aproveitar seu curso. Me conta: o que posso fazer pra você começar?"
    ]
  },
  {
    semana: 73,
    titulo: "Semana 73 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "{{nomedoaluno}}, faltam poucos meses! 🎯 Sua frequência impecável te trouxe até aqui. Não pare agora!",
      baixa: "{{nomedoaluno}}, você está na reta final! Vamos fazer um esforço juntos pra você terminar com chave de ouro?",
      zero: "{{nomedoaluno}}, você ainda tem alguns meses. Vamos fazer valer a pena? Estou aqui pra te ajudar a dar o primeiro passo!"
    },
    variantes: [
      "{{nomedoaluno}}, faltam poucos meses! 🎯 Sua frequência impecável te trouxe até aqui. Não pare agora!",
      "{{nomedoaluno}}, você está na reta final! Vamos fazer um esforço juntos pra você terminar com chave de ouro?",
      "{{nomedoaluno}}, você ainda tem alguns meses. Vamos fazer valer a pena? Estou aqui pra te ajudar a dar o primeiro passo!"
    ]
  },
  {
    semana: 90,
    titulo: "Semana 90 - Gatilho Comportamental",
    condicao: "Baseado em % de presença do aluno",
    canal: "📱 WhatsApp",
    horario: "Manhã (9h-11h)",
    objetivo: "Mensagem personalizada por cenário",
    tags: ["GATILHO COMPORTAMENTAL"],
    cenarios: {
      alta: "Parabéns! Continue firme! 🎉",
      baixa: "Vamos ajustar sua rotina? 😊",
      zero: "Estou aqui pra te ajudar a começar! 💙"
    },
    variantes: [
      "Parabéns! Continue firme! 🎉",
      "Vamos ajustar sua rotina? 😊",
      "Estou aqui pra te ajudar a começar! 💙"
    ]
  },
];

const RECUPERACAO = [];


// ═══════════════════════════════════════════════════════════
// SIMULADOR - CALCULAR DIAS
// ═══════════════════════════════════════════════════════════
function calcularDias(data1, data2) {
  const diff = data2.getTime() - data1.getTime();
  return Math.floor(diff / (1000 * 60 * 60 * 24));
}

function formatarDataCompleta(data) {
  const dias = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
  const meses = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
  return `${dias[data.getDay()]}, ${data.getDate()} ${meses[data.getMonth()]} ${data.getFullYear()}`;
}

// ═══════════════════════════════════════════════════════════
// SIMULADOR - GERAR MENSAGENS
// ═══════════════════════════════════════════════════════════
function simularRegua() {
  const nome = document.getElementById('simNome').value || 'João Silva';
  const dataMatricula = document.getElementById('simMatricula').value ? new Date(document.getElementById('simMatricula').value) : null;
  
  if (!dataMatricula) {
    alert('Por favor, preencha a data de matrícula!');
    return;
  }
  
  if (simulationMode === 'jornada') {
    simularJornadaCompleta();
  } else {
    simularPontual();
  }
}

// ═══════════════════════════════════════════════════════════
// SIMULADOR - MODO PONTUAL (ORIGINAL MELHORADO)
// ═══════════════════════════════════════════════════════════
function simularPontual() {
  const nome = document.getElementById('simNome').value || 'João Silva';
  const dataMatricula = document.getElementById('simMatricula').value ? new Date(document.getElementById('simMatricula').value) : null;
  const dataNascimento = document.getElementById('simNascimento').value ? new Date(document.getElementById('simNascimento').value) : null;
  const ultimoLogin = document.getElementById('simUltimoLogin').value ? new Date(document.getElementById('simUltimoLogin').value) : null;
  const aulasRealizadas = parseInt(document.getElementById('simAulas').value) || 0;
  const horasCompletadas = parseInt(document.getElementById('simHoras').value) || 0;
  const canalPreferencial = document.getElementById('simCanal').value;
  const status = document.getElementById('simStatus').value;
  
  if (!dataMatricula) {
    alert('Por favor, preencha a data de matrícula!');
    return;
  }
  
  const hoje = new Date();
  const diasDesdeMatricula = calcularDias(dataMatricula, hoje);
  const diasUltimaAula = ultimoLogin ? calcularDias(ultimoLogin, hoje) : null;
  
  const mensagens = [];
  
  // Checkpoint Trimestral (a cada 90 dias)
  const proximoCheckpoint = new Date(dataMatricula);
  while (proximoCheckpoint <= hoje) {
    proximoCheckpoint.setDate(proximoCheckpoint.getDate() + 90);
  }
  const diasAteCheckpoint = calcularDias(hoje, proximoCheckpoint);
  if (diasAteCheckpoint >= 0 && diasAteCheckpoint <= 30) {
    mensagens.push({
      tipo: 'Checkpoint Trimestral',
      data: proximoCheckpoint,
      diasAte: diasAteCheckpoint,
      prioridade: 1,
      tags: ['Celebração'],
      canal: canalPreferencial,
      horario: '10:00',
      mensagem: `📊 Oi ${nome.split(' ')[0]}! Está chegando o seu checkpoint trimestral. Vamos fazer uma avaliação do seu progresso?`
    });
  }
  
  // Milestones de aulas
  if (aulasRealizadas === 5) {
    mensagens.push({
      tipo: 'Milestone 5 Aulas',
      data: hoje,
      diasAte: 0,
      prioridade: 3,
      tags: ['Celebração'],
      canal: canalPreferencial,
      horario: '14:00',
      mensagem: `🏆 Parabéns, ${nome.split(' ')[0]}! Você completou 5 aulas! Continue assim! 🌟`
    });
  }
  
  if (aulasRealizadas === 10) {
    mensagens.push({
      tipo: 'Milestone 10 Aulas',
      data: hoje,
      diasAte: 0,
      prioridade: 3,
      tags: ['Celebração'],
      canal: canalPreferencial,
      horario: '14:00',
      mensagem: `🎉 Uau! 10 aulas completadas, ${nome.split(' ')[0]}! Você está arrasando! 💪`
    });
  }
  
  // Certificado 50h
  if (horasCompletadas >= 50 && horasCompletadas < 55) {
    mensagens.push({
      tipo: 'Certificado 50h',
      data: hoje,
      diasAte: 0,
      prioridade: 2,
      tags: ['Celebração'],
      canal: 'Email',
      horario: '10:00',
      mensagem: `🎓 Parabéns, ${nome.split(' ')[0]}! Você completou 50 horas! Seu certificado está disponível! 🌟`
    });
  }
  
  // Inatividade - 7 dias
  if (diasUltimaAula !== null && diasUltimaAula >= 7 && diasUltimaAula < 14) {
    mensagens.push({
      tipo: 'Inatividade 7 dias',
      data: hoje,
      diasAte: 0,
      prioridade: 2,
      tags: ['Lembrete'],
      canal: 'WhatsApp',
      horario: '10:00',
      mensagem: `Oi ${nome.split(' ')[0]}, tudo bem? 😊 Vi que você não aparece há uns dias... Posso ajudar? 💙`
    });
  }
  
  // Inatividade CRÍTICA - 14 dias
  if (diasUltimaAula !== null && diasUltimaAula >= 14) {
    mensagens.push({
      tipo: 'Inatividade CRÍTICA',
      data: hoje,
      diasAte: 0,
      prioridade: 1,
      tags: ['Lembrete'],
      canal: 'Ligação',
      horario: '10:00',
      mensagem: `🚨 ${nome.split(' ')[0]} está há ${diasUltimaAula} dias sem aula. URGENTE: Ligar para entender e oferecer suporte.`
    });
  }
  
  // Aniversário
  if (dataNascimento) {
    const aniversario = new Date(dataNascimento);
    aniversario.setFullYear(hoje.getFullYear());
    if (aniversario < hoje) {
      aniversario.setFullYear(hoje.getFullYear() + 1);
    }
    const diasAteAniversario = calcularDias(hoje, aniversario);
    if (diasAteAniversario >= 0 && diasAteAniversario <= 30) {
      mensagens.push({
        tipo: 'Aniversário',
        data: aniversario,
        diasAte: diasAteAniversario,
        prioridade: 2,
        tags: ['Celebração'],
        canal: canalPreferencial,
        horario: '09:00',
        mensagem: `🎂 Feliz aniversário, ${nome.split(' ')[0]}! 🎉 Você é especial para nós! 🎈💙`
      });
    }
  }
  
  // Aniversário de Matrícula
  if (diasDesdeMatricula >= 365) {
    const proximoAniversarioMatricula = new Date(dataMatricula);
    proximoAniversarioMatricula.setFullYear(hoje.getFullYear());
    if (proximoAniversarioMatricula < hoje) {
      proximoAniversarioMatricula.setFullYear(hoje.getFullYear() + 1);
    }
    const diasAteAniversarioMatricula = calcularDias(hoje, proximoAniversarioMatricula);
    if (diasAteAniversarioMatricula >= 0 && diasAteAniversarioMatricula <= 30) {
      mensagens.push({
        tipo: 'Aniversário de Matrícula',
        data: proximoAniversarioMatricula,
        diasAte: diasAteAniversarioMatricula,
        prioridade: 1,
        tags: ['Celebração'],
        canal: 'Email',
        horario: '09:00',
        mensagem: `🎊 ${nome.split(' ')[0]}, você completou 1 ano na Wise Up! 🎉 Parabéns pela dedicação! 🌟`
      });
    }
  }
  
  // Dicas semanais (apenas para alunos ativos)
  if (status === 'ativo' && (diasUltimaAula === null || diasUltimaAula < 7)) {
    const proximaSegunda = new Date(hoje);
    const diaAtual = hoje.getDay();
    const diasAteSegunda = diaAtual === 0 ? 1 : diaAtual === 1 ? 7 : 8 - diaAtual;
    proximaSegunda.setDate(hoje.getDate() + diasAteSegunda);
    const diasAteProxSegunda = calcularDias(hoje, proximaSegunda);
    
    if (diasAteProxSegunda >= 0 && diasAteProxSegunda <= 7) {
      mensagens.push({
        tipo: 'Dica Semanal',
        data: proximaSegunda,
        diasAte: diasAteProxSegunda,
        prioridade: 5,
        tags: ['Dica'],
        canal: 'WhatsApp',
        horario: '15:00',
        mensagem: `💡 Dica da semana: Pratique inglês assistindo séries com legendas em inglês! #WiseUpTips`
      });
    }
  }
  
  renderSimuladorResultados(nome, dataMatricula, diasDesdeMatricula, diasUltimaAula, aulasRealizadas, horasCompletadas, status, mensagens);
}

// ═══════════════════════════════════════════════════════════
// SIMULADOR - MODO JORNADA COMPLETA (NOVO)
// ═══════════════════════════════════════════════════════════
function simularJornadaCompleta() {
  const nome = document.getElementById('simNome').value || 'João Silva';
  const dataMatricula = new Date(document.getElementById('simMatricula').value);
  const hoje = new Date();
  
  const diasDesdeMatricula = calcularDias(dataMatricula, hoje);
  const semanasDesdeMatricula = Math.floor(diasDesdeMatricula / 7);
  
  const mensagensHistorico = [];
  const mensagensProximas = [];
  
  // Percorrer todas as semanas do weekMessages
  for (let [semanaKey, msgData] of Object.entries(weekMessages)) {
    const semanaNum = typeof semanaKey === 'string' && semanaKey.includes('+') 
      ? parseInt(semanaKey.replace('+', '')) 
      : parseInt(semanaKey);
    
    // Calcular data de envio da mensagem
    let dataEnvio = new Date(dataMatricula);
    
    // Para checkpoints (com +), enviar no dia 18 do mês correspondente
    if (typeof semanaKey === 'string' && semanaKey.includes('+')) {
      // Adicionar semanas até a semana do checkpoint
      dataEnvio.setDate(dataEnvio.getDate() + (semanaNum * 7));
      
      // Ajustar para o dia 18 do mês
      dataEnvio.setDate(18);
      
      // Se já passou do dia 18 desse mês, ir para o próximo mês
      const mesAtual = new Date(dataMatricula);
      mesAtual.setDate(mesAtual.getDate() + (semanaNum * 7));
      if (mesAtual.getDate() > 18) {
        dataEnvio.setMonth(dataEnvio.getMonth() + 1);
      }
    } else {
      // Mensagem normal - adicionar semanas
      dataEnvio.setDate(dataEnvio.getDate() + (semanaNum * 7));
    }
    
    const mensagem = {
      semana: semanaKey,
      titulo: msgData.title,
      timing: msgData.timing,
      canal: msgData.channel,
      publico: msgData.audience,
      horario: msgData.horario,
      objetivo: msgData.objective,
      tipo: msgData.tipo,
      mensagem: msgData.message.replace(/\{\{nomedoaluno\}\}/g, nome.split(' ')[0]).replace(/\[Nome\]/g, nome.split(' ')[0]),
      obs: msgData.obs,
      dataEnvio: dataEnvio,
      diasAte: calcularDias(hoje, dataEnvio),
      jaEnviada: dataEnvio <= hoje
    };
    
    if (mensagem.jaEnviada) {
      mensagensHistorico.push(mensagem);
    } else {
      mensagensProximas.push(mensagem);
    }
  }
  
  // Ordenar por data
  mensagensHistorico.sort((a, b) => a.dataEnvio - b.dataEnvio);
  mensagensProximas.sort((a, b) => a.dataEnvio - b.dataEnvio);
  
  renderJornadaCompleta(nome, dataMatricula, diasDesdeMatricula, semanasDesdeMatricula, mensagensHistorico, mensagensProximas);
}

// ═══════════════════════════════════════════════════════════
// RENDER - JORNADA COMPLETA
// ═══════════════════════════════════════════════════════════
function renderJornadaCompleta(nome, dataMatricula, diasDesde, semanasDesde, historico, proximas) {
  const container = document.getElementById('simResultados');
  const hoje = new Date();
  
  let html = `
    <div class="card" style="margin-bottom:20px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
        <div>
          <div class="variant-label">📊 Resumo da Jornada</div>
          <div style="color:var(--txt3);font-size:0.85rem;margin-top:4px">
            Matrícula em ${dataMatricula.toLocaleDateString('pt-BR')}
          </div>
        </div>
        <div style="text-align:right">
          <div style="font-size:2rem;font-weight:800;color:var(--accent)">${semanasDesde}</div>
          <div style="color:var(--txt3);font-size:0.85rem">semanas de curso</div>
        </div>
      </div>
      
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
        <div style="padding:16px;background:var(--green-lo);border-left:3px solid var(--green);border-radius:8px">
          <div style="font-size:0.8rem;color:var(--txt3);margin-bottom:4px">✅ Mensagens Enviadas</div>
          <div style="font-size:1.8rem;font-weight:700;color:var(--green)">${historico.length}</div>
        </div>
        <div style="padding:16px;background:var(--accent-lo);border-left:3px solid var(--accent);border-radius:8px">
          <div style="font-size:0.8rem;color:var(--txt3);margin-bottom:4px">⏳ Próximas Mensagens</div>
          <div style="font-size:1.8rem;font-weight:700;color:var(--accent)">${proximas.length}</div>
        </div>
      </div>
    </div>
  `;
  
  // HISTÓRICO
  if (historico.length > 0) {
    html += `
      <div class="card" style="margin-bottom:20px">
        <div class="variant-label" style="margin-bottom:16px">✅ Histórico de Mensagens Enviadas</div>
        <div style="max-height:400px;overflow-y:auto">
    `;
    
    historico.forEach(msg => {
      const isCheckpoint = typeof msg.semana === 'string' && msg.semana.includes('+');
      html += `
        <div style="padding:14px;border-left:3px solid var(--green);background:var(--green-lo);border-radius:8px;margin-bottom:12px">
          <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px">
            <div>
              <div style="font-weight:700;color:var(--txt1);font-size:0.95rem">${isCheckpoint ? '⭐ ' : ''}${msg.titulo}</div>
              <div style="color:var(--txt3);font-size:0.8rem;margin-top:2px">
                Semana ${msg.semana} • ${msg.timing}
              </div>
            </div>
            <div style="text-align:right">
              <div style="font-size:0.75rem;color:var(--green);font-weight:600">ENVIADO</div>
              <div style="font-size:0.75rem;color:var(--txt3)">${msg.dataEnvio.toLocaleDateString('pt-BR')}</div>
            </div>
          </div>
          <div style="padding:10px;background:var(--card);border-radius:6px;margin-bottom:8px">
            <div style="font-size:0.85rem;color:var(--txt2);line-height:1.5">${msg.mensagem}</div>
          </div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <span style="font-size:0.75rem;padding:4px 8px;background:var(--card-hi);border-radius:6px;color:var(--txt2)">${msg.canal}</span>
            <span style="font-size:0.75rem;padding:4px 8px;background:var(--card-hi);border-radius:6px;color:var(--txt2)">${msg.tipo}</span>
            <span style="font-size:0.75rem;padding:4px 8px;background:var(--card-hi);border-radius:6px;color:var(--txt2)">${msg.horario}</span>
          </div>
        </div>
      `;
    });
    
    html += `</div></div>`;
  }
  
  // PRÓXIMAS
  if (proximas.length > 0) {
    html += `
      <div class="card">
        <div class="variant-label" style="margin-bottom:16px">⏳ Próximas Mensagens Programadas</div>
        <div style="max-height:400px;overflow-y:auto">
    `;
    
    proximas.slice(0, 20).forEach(msg => {
      const isCheckpoint = typeof msg.semana === 'string' && msg.semana.includes('+');
      const diasAte = msg.diasAte;
      const corBorda = diasAte <= 7 ? 'var(--amber)' : 'var(--accent)';
      const corBg = diasAte <= 7 ? 'var(--amber-lo)' : 'var(--accent-lo)';
      
      html += `
        <div style="padding:14px;border-left:3px solid ${corBorda};background:${corBg};border-radius:8px;margin-bottom:12px">
          <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px">
            <div>
              <div style="font-weight:700;color:var(--txt1);font-size:0.95rem">${isCheckpoint ? '⭐ ' : ''}${msg.titulo}</div>
              <div style="color:var(--txt3);font-size:0.8rem;margin-top:2px">
                Semana ${msg.semana} • ${msg.timing}
              </div>
            </div>
            <div style="text-align:right">
              <div style="font-size:0.75rem;color:${corBorda};font-weight:600">
                ${diasAte === 0 ? 'HOJE' : diasAte === 1 ? 'AMANHÃ' : `EM ${diasAte} DIAS`}
              </div>
              <div style="font-size:0.75rem;color:var(--txt3)">${msg.dataEnvio.toLocaleDateString('pt-BR')}</div>
            </div>
          </div>
          <div style="padding:10px;background:var(--card);border-radius:6px;margin-bottom:8px">
            <div style="font-size:0.85rem;color:var(--txt2);line-height:1.5">${msg.mensagem}</div>
          </div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <span style="font-size:0.75rem;padding:4px 8px;background:var(--card-hi);border-radius:6px;color:var(--txt2)">${msg.canal}</span>
            <span style="font-size:0.75rem;padding:4px 8px;background:var(--card-hi);border-radius:6px;color:var(--txt2)">${msg.tipo}</span>
            <span style="font-size:0.75rem;padding:4px 8px;background:var(--card-hi);border-radius:6px;color:var(--txt2)">${msg.horario}</span>
          </div>
          ${msg.obs ? `<div style="margin-top:8px;padding:8px;background:var(--rose-lo);border-radius:6px;font-size:0.75rem;color:var(--txt2)">⚠️ ${msg.obs}</div>` : ''}
        </div>
      `;
    });
    
    if (proximas.length > 20) {
      html += `<div style="text-align:center;padding:12px;color:var(--txt3);font-size:0.85rem">... e mais ${proximas.length - 20} mensagens</div>`;
    }
    
    html += `</div></div>`;
  }
  
  container.innerHTML = html;
}

// ═══════════════════════════════════════════════════════════
// SIMULADOR - RENDER RESULTADOS
// ═══════════════════════════════════════════════════════════
function renderSimuladorResultados(nome, dataMatricula, diasDesdeMatricula, diasUltimaAula, aulas, horas, status, mensagens) {
  const hoje = new Date();
  
  // Ordenar por dias até + prioridade
  mensagens.sort((a, b) => a.diasAte - b.diasAte || a.prioridade - b.prioridade);
  
  // Contar por prioridade
  const porPrioridade = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };
  mensagens.forEach(m => porPrioridade[m.prioridade]++);
  
  const prioritarias = porPrioridade[1] + porPrioridade[2];
  
  const badgeClass = status === 'ativo' ? 'badge-ativo' : status === 'recuperacao' ? 'badge-recuperacao' : 'badge-inativo';
  const badgeText = status === 'ativo' ? '✅ ATIVO' : status === 'recuperacao' ? '⚠️ RECUPERAÇÃO' : '🔴 INATIVO';
  
  let html = `
    <!-- Perfil do Aluno -->
    <div class="card" style="background:linear-gradient(135deg,rgba(0,102,255,0.1) 0%,rgba(0,217,255,0.05) 100%)">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:12px">
        <div style="font-size:1.8rem;font-weight:700">${nome}</div>
        <div class="phase-badge ${badgeClass}" style="font-size:0.8rem">${badgeText}</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px">
        <div style="background:var(--card-hi);padding:14px;border-radius:10px;border:1px solid var(--border)">
          <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:6px;text-transform:uppercase;font-weight:600">Dias desde matrícula</div>
          <div style="font-size:1.6rem;font-weight:700;color:var(--accent);font-family:'JetBrains Mono',monospace">${diasDesdeMatricula}</div>
          <div style="font-size:0.8rem;color:var(--txt3);margin-top:4px">${formatarDataCompleta(dataMatricula)}</div>
        </div>
        <div style="background:var(--card-hi);padding:14px;border-radius:10px;border:1px solid var(--border)">
          <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:6px;text-transform:uppercase;font-weight:600">Último login</div>
          <div style="font-size:1.6rem;font-weight:700;color:${diasUltimaAula >= 14 ? 'var(--rose)' : diasUltimaAula >= 7 ? 'var(--amber)' : 'var(--green)'};font-family:'JetBrains Mono',monospace">${diasUltimaAula !== null ? diasUltimaAula + ' dias' : 'N/A'}</div>
        </div>
        <div style="background:var(--card-hi);padding:14px;border-radius:10px;border:1px solid var(--border)">
          <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:6px;text-transform:uppercase;font-weight:600">Aulas realizadas</div>
          <div style="font-size:1.6rem;font-weight:700;color:var(--accent);font-family:'JetBrains Mono',monospace">${aulas}</div>
        </div>
        <div style="background:var(--card-hi);padding:14px;border-radius:10px;border:1px solid var(--border)">
          <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:6px;text-transform:uppercase;font-weight:600">Horas completadas</div>
          <div style="font-size:1.6rem;font-weight:700;color:var(--accent);font-family:'JetBrains Mono',monospace">${horas}h</div>
        </div>
      </div>
    </div>
    
    <!-- Alertas -->
  `;
  
  if (mensagens.length === 0) {
    html += `
      <div style="background:var(--green-lo);border:1px solid var(--green);border-radius:12px;padding:16px;margin-bottom:20px;display:flex;gap:12px;align-items:flex-start">
        <div style="font-size:1.2rem">✅</div>
        <div style="color:var(--green)">Nenhuma mensagem programada para os próximos 30 dias. O aluno está com a régua em dia!</div>
      </div>
    `;
  } else {
    if (prioritarias > 0) {
      html += `
        <div style="background:var(--amber-lo);border:1px solid var(--amber);border-radius:12px;padding:16px;margin-bottom:20px;display:flex;gap:12px;align-items:flex-start">
          <div style="font-size:1.2rem">⚠️</div>
          <div style="color:var(--amber)"><strong>${prioritarias}</strong> mensagem${prioritarias !== 1 ? 'ens' : ''} de alta prioridade detectada${prioritarias !== 1 ? 's' : ''}!</div>
        </div>
      `;
    }
    
    if (mensagens.length > 5) {
      html += `
        <div style="background:var(--amber-lo);border:1px solid var(--amber);border-radius:12px;padding:16px;margin-bottom:20px;display:flex;gap:12px;align-items:flex-start">
          <div style="font-size:1.2rem">📊</div>
          <div style="color:var(--amber)"><strong>${mensagens.length}</strong> mensagens programadas. Considere priorização para evitar sobrecarga.</div>
        </div>
      `;
    }
  }
  
  // Resumo
  html += `
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:24px">
      <div class="card" style="text-align:center">
        <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:8px;text-transform:uppercase;font-weight:600">Total</div>
        <div style="font-size:2.5rem;font-weight:700;color:var(--accent)">${mensagens.length}</div>
        <div style="font-size:0.8rem;color:var(--txt3)">mensagens</div>
      </div>
      <div class="card" style="text-align:center">
        <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:8px;text-transform:uppercase;font-weight:600">Alta Prioridade</div>
        <div style="font-size:2.5rem;font-weight:700;color:var(--rose)">${porPrioridade[1] + porPrioridade[2]}</div>
        <div style="font-size:0.8rem;color:var(--txt3)">urgentes</div>
      </div>
      <div class="card" style="text-align:center">
        <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:8px;text-transform:uppercase;font-weight:600">Média Prioridade</div>
        <div style="font-size:2.5rem;font-weight:700;color:var(--amber)">${porPrioridade[3] + porPrioridade[4]}</div>
        <div style="font-size:0.8rem;color:var(--txt3)">normais</div>
      </div>
      <div class="card" style="text-align:center">
        <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:8px;text-transform:uppercase;font-weight:600">Baixa Prioridade</div>
        <div style="font-size:2.5rem;font-weight:700;color:var(--green)">${porPrioridade[5]}</div>
        <div style="font-size:0.8rem;color:var(--txt3)">opcionais</div>
      </div>
    </div>
  `;
  
  // Timeline
  if (mensagens.length > 0) {
    html += `<div class="card"><div class="variant-label" style="margin-bottom:20px">📅 Cronograma de Mensagens</div>`;
    
    mensagens.forEach(msg => {
      const dataFormatada = formatarDataCompleta(msg.data);
      const diasTexto = msg.diasAte === 0 ? 'Hoje' : 
                        msg.diasAte === 1 ? 'Amanhã' :
                        `Em ${msg.diasAte} dias`;
      
      const prioColor = msg.prioridade === 1 ? 'var(--rose)' : 
                        msg.prioridade === 2 ? 'var(--amber)' : 
                        msg.prioridade === 3 ? 'var(--blue)' :
                        msg.prioridade === 4 ? 'var(--teal)' : 'var(--green)';
      
      html += `
        <div style="padding:16px;background:var(--card-hi);border:1px solid var(--border);border-radius:10px;margin-bottom:12px">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;flex-wrap:wrap;gap:8px">
            <div style="display:flex;align-items:center;gap:8px">
              <div style="width:28px;height:28px;border-radius:8px;background:${prioColor};color:white;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.75rem;font-family:'JetBrains Mono',monospace">P${msg.prioridade}</div>
              <div style="font-weight:600;font-size:0.95rem">${msg.tipo}</div>
            </div>
            <div style="font-size:0.75rem;color:var(--txt3);font-family:'JetBrains Mono',monospace">${diasTexto} · ${dataFormatada}</div>
          </div>
          <div class="msg-meta" style="margin-bottom:10px">
            ${msg.tags.map(tag => {
              const tagClass = tag.replace(/\s+/g, '-');
              return `<span class="tag tag-${tagClass}">${tag}</span>`;
            }).join('')}
          </div>
          <div style="color:var(--txt2);font-size:0.85rem;line-height:1.7;font-style:italic;padding:12px;background:var(--card);border-radius:8px;border-left:3px solid ${prioColor}">
            ${msg.mensagem}
          </div>
          <div style="display:flex;gap:16px;margin-top:10px;font-size:0.75rem;color:var(--txt3)">
            <span>📱 ${msg.canal}</span>
            <span>🕐 ${msg.horario}</span>
          </div>
        </div>
      `;
    });
    
    html += '</div>';
  }
  
  document.getElementById('simResultados').innerHTML = html;
}

// ═══════════════════════════════════════════════════════════
// THEME TOGGLE
// ═══════════════════════════════════════════════════════════
function toggleTheme() {
  const isLight = document.documentElement.classList.toggle('light');
  document.getElementById('themeIcon').textContent = isLight ? '☀️' : '🌙';
  document.getElementById('themeLabel').textContent = isLight ? 'Modo Escuro' : 'Modo Claro';
}

// ═══════════════════════════════════════════════════════════
// TAB SWITCHING
// ═══════════════════════════════════════════════════════════
function showTab(tabName, el) {
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  
  document.getElementById(tabName).classList.add('active');
  el.classList.add('active');
  
  if (tabName === 'timeline') {
    renderTimeline('fases');
  } else if (tabName === 'explorar') {
    renderExplorar();
  } else if (tabName === 'simulador') {
    // Preencher datas padrão
    const hoje = new Date();
    const matricula = new Date(hoje);
    matricula.setDate(hoje.getDate() - 30);
    document.getElementById('simMatricula').value = matricula.toISOString().split('T')[0];
    
    const ultimoLogin = new Date(hoje);
    ultimoLogin.setDate(hoje.getDate() - 3);
    document.getElementById('simUltimoLogin').value = ultimoLogin.toISOString().split('T')[0];
  }
}

// ═══════════════════════════════════════════════════════════
// TIMELINE FILTER
// ═══════════════════════════════════════════════════════════
function filterTimeline(view, el) {
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
  renderTimeline(view);
}

// ═══════════════════════════════════════════════════════════
// RENDER TIMELINE
// ═══════════════════════════════════════════════════════════
function renderTimeline(view) {
  const content = document.getElementById('timelineContent');
  
  if (view === 'fases') {
    renderFasesCompacta(content);  // Nova função compacta
  } else if (view === 'gatilhos') {
    renderGatilhos(content);
  } else if (view === 'recuperacao') {
    renderRecuperacao(content);
  }
}

// ═══════════════════════════════════════════════════════════
// NOVA FUNÇÃO - RENDER FASES COMPACTA E INTERATIVA
// ═══════════════════════════════════════════════════════════

// Dados extraídos da planilha "Fases_da_Jornada_-_ULTIMA_VERSÃO.xlsx"
const weekMessages = {
  0: {
    title: "Boas-vindas",
    timing: "Dentro de 24h da matrícula",
    channel: "📱 WhatsApp",
    audience: "Todos os alunos",
    horario: "Manhã (9h-11h)",
    objective: "Primeiro contato + agendamento Aula Zero",
    tipo: "Operacional",
    message: "Olá, {{nomedoaluno}}. Seja muito bem-vindo(a) ao Wise Up Online! Sou a Cecilia do suporte Live e vou te acompanhar nessa jornada incrível. 🎉 Como parte do processo inicial para novos alunos, precisamos de cerca de 10min com você para verificar o acesso ao Zoom e liberar seu documento de assinatura. Você poderia me informar qual o melhor horário hoje e em qual estado você está, para que eu confira o fuso corretamente?",
    obs: "NÃO ALTERAR - Tour completo na plataforma + liberação documento. Duração: ~10min. ⚠️ Se não responder: Régua de Recuperação (8 dias): Dias 1-5: 1x/dia | Dias 6-7: 2x/dia | Dia 8: 3x/dia. Canais: WhatsApp, Ligação, Email"
  },
    2: {
      title: "Check-in Inicial",
      timing: "Dia 9 após matrícula",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (12h-13h)",
      objective: "Verificar exploração do material",
      tipo: "Operacional",
      message: "Oi {{nomedoaluno}}! Passando só pra saber se já explorou o Material Didático? Tem alguma dúvida que eu possa te ajudar?",
      obs: "Mensagem leve de suporte"
    },
    4: {
      title: "Início do Mês",
      timing: "Envio sempre no primeiro dia do mes",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Motivar início de módulo",
      tipo: "Celebração/Lembrete",
      message: "Passando pra te desejar um ótimo começo de mês! 😊 As aulas ao vivo iniciam nessa primeira semana com um novo conteúdo. Corre conferir qual módulo será abordado e inicie suas preparações para a primeira aula!",
      obs: "Enviar no dia 1 do mês"
    },
    6: {
      title: "Dica de Estudo",
      timing: "Semana 6",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Tarde (14h-16h)",
      objective: "Engajamento educacional",
      tipo: "Dica",
      message: "Dica da semana! 💡 Sabia que revisar o material antes da aula aumenta em 40% sua retenção? Dá uma olhadinha nas preparações da próxima aula. Você vai arrasar! 🌟",
      obs: "Dica prática"
    },
    8: {
      title: "Milestone 45 Dias",
      timing: "~Dia 45",
      channel: "📱 WhatsApp",
      audience: "Todos (filtro: data início)",
      horario: "Tarde (14h-16h)",
      objective: "Celebração de marco temporal",
      tipo: "Celebração",
      message: "45 dias! 🌟 Você completou um mês e meio de aprendizado! Já pode sentir a evolução, não é? Orgulho de você! 💙",
      obs: ""
    },
    9: {
      title: "Início do Mês",
      timing: "Dia 1 do 2º mês completo",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novo módulo liberado nas aulas ao vivo. Que tal conferir o cronograma e já programar sua semana?",
      obs: "Enviar dia 1 do mês"
    },
    12: {
      title: "Início do Mês",
      timing: "Dia 1 do 3º mês",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novo módulo liberado nas aulas ao vivo. Que tal conferir o cronograma e já programar sua semana?",
      obs: "Enviar dia 1 do mês"
    },
    "12+": {
      title: "⭐ Lembrete Checkpoint",
      timing: "Dia 18 do mês (~3,5 meses)",
      channel: "📱 WhatsApp",
      audience: "Alunos com ~3,5 meses",
      horario: "Manhã (9h-11h)",
      objective: "Lembrar do teste oficial",
      tipo: "Operacional",
      message: "Oi [Nome]! 📊 Seu Checkpoint Trimestral já está liberado na página inicial até o dia 27! É a chance de testar seus conhecimentos e, com 70 pontos ou mais, você avança de nível e recebe seu certificado. Bora lá! 🎓",
      obs: "⚠️ Enviar SOMENTE entre dias 18-27 do mês. Este é o teste oficial trimestral"
    },
    13: {
      title: "Milestone 3 Meses",
      timing: "~Dia 90",
      channel: "📱 WhatsApp",
      audience: "Filtro: data matrícula",
      horario: "Tarde (14h-16h)",
      objective: "Celebração trimestral",
      tipo: "Celebração",
      message: "3 meses! 🎯 Um trimestre de dedicação e evolução. {{nomedoaluno}}, você está construindo algo incrível aqui. Continue firme! 💪",
      obs: ""
    },
    15: {
      title: "Dica Conversação",
      timing: "Semana 15",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Tarde (14h-16h)",
      objective: "Engajamento prático",
      tipo: "Dica",
      message: "Dica rápida! 💬 Que tal praticar inglês com você mesmo? Fale em voz alta sobre seu dia enquanto faz tarefas simples. Funciona demais!",
      obs: ""
    },
    17: {
      title: "Início do Mês",
      timing: "Dia 1 do 4º mês",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novo módulo liberado. Vamos juntos nessa! 🚀",
      obs: "Enviar dia 1 do mês"
    },
    20: {
      title: "Milestone 5 Meses",
      timing: "~Dia 150",
      channel: "📱 WhatsApp",
      audience: "Filtro: data matrícula",
      horario: "Tarde (14h-16h)",
      objective: "Celebração temporal",
      tipo: "Celebração",
      message: "5 meses de jornada! 🌟 Você já percorreu metade do primeiro ano. Isso é persistência! Continue assim, {{nomedoaluno}}! 💙",
      obs: ""
    },
    21: {
      title: "Início do Mês",
      timing: "Dia 1 do 5º mês",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novas aulas ao vivo liberadas. Bora! 🎯",
      obs: "Enviar dia 1 do mês"
    },
    23: {
      title: "Dica Listening",
      timing: "Semana 23",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Tarde (14h-16h)",
      objective: "Habilidade auditiva",
      tipo: "Dica",
      message: "Dica de ouro! 🎧 Coloque legendas em inglês quando assistir séries/filmes. Seu cérebro vai conectar som + palavra escrita. Eficiente demais!",
      obs: ""
    },
    "24+": {
      title: "⭐ Lembrete Checkpoint",
      timing: "Dia 18 do mês (~7 meses)",
      channel: "📱 WhatsApp",
      audience: "Alunos com ~7 meses",
      horario: "Manhã (9h-11h)",
      objective: "Lembrar do teste oficial",
      tipo: "Operacional",
      message: "Olá [Nome]! 📊 Seu segundo Checkpoint Trimestral está disponível na página inicial! Lembrando: 70 pontos ou mais = novo nível + certificado. Você tem até o dia 27! 💪",
      obs: "⚠️ Enviar SOMENTE entre dias 18-27 do mês. Checkpoint oficial"
    },
    26: {
      title: "Milestone 6 Meses",
      timing: "~Dia 180",
      channel: "📱 WhatsApp",
      audience: "Filtro: data matrícula",
      horario: "Tarde (14h-16h)",
      objective: "Marco semestral",
      tipo: "Celebração",
      message: "Meio ano! 🎉 6 meses de evolução constante. {{nomedoaluno}}, você está no caminho certo. Orgulho de você! 🏆",
      obs: ""
    },
    27: {
      title: "Início do Mês",
      timing: "Dia 1 do 7º mês",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novas aulas ao vivo liberadas. Vamos juntos nessa! 🚀",
      obs: "Enviar dia 1 do mês"
    },
    29: {
      title: "Dica Vocabulário",
      timing: "Semana 29",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Tarde (14h-16h)",
      objective: "Expansão vocabular",
      tipo: "Dica",
      message: "Dica valiosa! 📝 Anote 3 palavras novas por dia. Não precisa decorar tudo de uma vez. Consistência > volume. 💪",
      obs: ""
    },
    32: {
      title: "Início do Mês",
      timing: "Dia 1 do 8º mês",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novo módulo nas aulas ao vivo. Vem! 🎯",
      obs: "Enviar dia 1 do mês"
    },
    33: {
      title: "Milestone 8 Meses",
      timing: "~Dia 240",
      channel: "📱 WhatsApp",
      audience: "Filtro: data matrícula",
      horario: "Tarde (14h-16h)",
      objective: "Celebração temporal",
      tipo: "Celebração",
      message: "8 meses! 💪 Dois terços do ano completados. {{nomedoaluno}}, sua dedicação é inspiradora! Continue firme! 🌟",
      obs: ""
    },
    35: {
      title: "Dica Reading",
      timing: "Semana 35",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Tarde (14h-16h)",
      objective: "Habilidade leitura",
      tipo: "Dica",
      message: "Dica de leitura! 📚 Leia artigos curtos em inglês sobre assuntos que você AMA. Quando tem interesse, aprende 3x mais rápido!",
      obs: ""
    },
    "36+": {
      title: "⭐ Lembrete Checkpoint",
      timing: "Dia 18 do mês (~10,5 meses)",
      channel: "📱 WhatsApp",
      audience: "Alunos com ~10,5 meses",
      horario: "Manhã (9h-11h)",
      objective: "Lembrar do teste oficial",
      tipo: "Operacional",
      message: "E aí, [Nome]! 📊 Já viu que seu Checkpoint Trimestral está liberado? É a hora de mostrar tudo que aprendeu! 70+ pontos = próximo nível + certificado. Disponível até dia 27! 🌟",
      obs: "⚠️ Enviar SOMENTE entre dias 18-27 do mês. Checkpoint oficial"
    },
    37: {
      title: "Início do Mês",
      timing: "Dia 1 do 9º mês",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novas aulas ao vivo liberadas. Vamos juntos nessa!",
      obs: "Enviar dia 1 do mês"
    },
    39: {
      title: "Dica Writing",
      timing: "Semana 39",
      channel: "📱 WhatsApp",
      audience: "Todos os alunos",
      horario: "Tarde (14h-16h)",
      objective: "Escrita ativa",
      tipo: "Dica",
      message: "✍️ Dica: Escreva pequenas anotações do dia a dia em inglês. Lista de compras, lembretes... Tudo conta!",
      obs: "Prática diária"
    },
    40: {
      title: "Milestone 10 Meses",
      timing: "~Mês 10",
      channel: "📱 WhatsApp",
      audience: "Filtro: data matrícula",
      horario: "Tarde (14h-16h)",
      objective: "Marco importante",
      tipo: "Celebração",
      message: "10 meses! 🏆 Você está entre os alunos mais dedicados. Sua evolução é inspiradora!",
      obs: "🚨 ATENÇÃO: Não mencionar conclusão. Time de renovação entra em ação"
    },
    41: {
      title: "⚠️ BLACKOUT RENOVAÇÃO 12M",
      timing: "Semanas 41-47",
      channel: "🚫 SEM ENVIO",
      audience: "Plano 12 meses",
      horario: "",
      objective: "Espaço para time comercial",
      tipo: "PAUSA ESTRATÉGICA",
      message: "🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua neste período",
      obs: "⚠️ CRÍTICO: Verificar no CRM se aluno está em processo de renovação. Não enviar mensagens do suporte Live para não conflitar com abordagem comercial."
    },
    48: {
      title: "🔀 DECISÃO RENOVAÇÃO",
      timing: "Semana 48",
      channel: "📱 WhatsApp",
      audience: "Filtro: status renovação",
      horario: "Manhã (9h-11h)",
      objective: "Confirmação status",
      tipo: "CONDICIONAL",
      message: "SE RENOVOU: 'Que alegria saber que você continua conosco! 🎉 Seus próximos 12 meses serão ainda mais incríveis!' | SE NÃO RENOVOU: Migrar para RÉGUA DE ENCERRAMENTO",
      obs: "⚠️ PONTO DE DECISÃO: CRM deve ter flag 'RENOVADO=SIM/NÃO'. Se SIM → continua régua principal. Se NÃO → ativa régua encerramento"
    },
    49: {
      title: "Quiz Gramática",
      timing: "Semana 49",
      channel: "📱 WhatsApp",
      audience: "Somente renovados",
      horario: "Tarde (14h-16h)",
      objective: "Revisão",
      tipo: "Engajamento",
      message: "Grammar check! 🎯 'If I ___ you, I would study more.' (a) was (b) were (c) am",
      obs: "Enviar SOMENTE para alunos que renovaram"
    },
    "50+": {
      title: "⭐ Lembrete Checkpoint",
      timing: "Dia 18 do mês (~14 meses)",
      channel: "📱 WhatsApp",
      audience: "Renovados ~14 meses",
      horario: "Manhã (9h-11h)",
      objective: "Lembrar do teste oficial",
      tipo: "Operacional",
      message: "Lembrete: O checkpoint Trimestral é liberado na pagina inicial do dia 18/ mês até 27/mês! Bora conquistar mais um certificado? 70+ pontos e você avança!🚀",
      obs: "⚠️ Checkpoint oficial para renovados e vitalícios"
    },
    52: {
      title: "Dica Imersão",
      timing: "Semana 52",
      channel: "📱 WhatsApp",
      audience: "Somente renovados",
      horario: "Tarde (14h-16h)",
      objective: "Prática avançada",
      tipo: "Dica",
      message: "Um ano! 🎂 Hora de consumir conteúdo 100% em inglês. Séries sem legenda, podcasts, audiobooks. Você consegue!",
      obs: "Apenas renovados"
    },
    53: {
      title: "Milestone 1 Ano",
      timing: "~365 dias",
      channel: "📱 WhatsApp",
      audience: "Renovados (filtro: data início)",
      horario: "Tarde (14h-16h)",
      objective: "Celebração anual",
      tipo: "Celebração",
      message: "1 ANO! 🎉🎂 {{nomedoaluno}}, você completou 365 dias de dedicação ao inglês. Isso é INCRÍVEL! A fluência está cada vez mais perto! 🏆",
      obs: "Marco importantíssimo"
    },
    56: {
      title: "Início do Mês",
      timing: "Dia 1 do 14º mês",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Novo mês, novo módulo liberado! 🌟 Vamos que vamos!",
      obs: "Apenas renovados"
    },
    57: {
      title: "Dica Avançada",
      timing: "Semana 57",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Tarde (14h-16h)",
      objective: "Desafio",
      tipo: "Dica",
      message: "Desafio! 🎯 Tente pensar em inglês durante 5 minutos hoje. Não precisa falar, só PENSAR. É treino mental poderoso!",
      obs: ""
    },
    "60+": {
      title: "⭐ Lembrete Checkpoint",
      timing: "Dia 18 do mês (~17,5 meses)",
      channel: "📱 WhatsApp",
      audience: "Alunos ~17,5 meses",
      horario: "Manhã (9h-11h)",
      objective: "Lembrar do teste oficial",
      tipo: "Operacional",
      message: "Olá [Nome]! 📊 Mais um Checkpoint Trimestral disponível pra você! Mostre sua evolução: 70+ pontos = certificado + novo nível. Liberado até dia 27! 💪",
      obs: "⚠️ Checkpoint oficial"
    },
    61: {
      title: "Início do Mês",
      timing: "Dia 1 do 15º mês",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novas aulas. Vamos! 🚀",
      obs: "Apenas renovados"
    },
    63: {
      title: "Milestone 15 Meses",
      timing: "~15 meses",
      channel: "📱 WhatsApp",
      audience: "Renovados (filtro: data início)",
      horario: "Tarde (14h-16h)",
      objective: "Celebração",
      tipo: "Celebração",
      message: "15 meses! 🌟 Um ano e 3 meses de evolução contínua. {{nomedoaluno}}, você é inspiração! 💪",
      obs: ""
    },
    64: {
      title: "Quiz Cultural",
      timing: "Semana 64",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Tarde (14h-16h)",
      objective: "Engajamento cultural",
      tipo: "Engajamento",
      message: "Pop culture quiz! 🎬 What does 'break a leg' mean? (a) Good luck (b) Be careful (c) Dance well",
      obs: ""
    },
    67: {
      title: "Dica Pronúncia",
      timing: "Semana 67",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Tarde (14h-16h)",
      objective: "Melhoria pronúncia",
      tipo: "Dica",
      message: "Dica de pronúncia! 🗣️ Grave você falando e depois ouça. Incômodo? Normal! Mas você vai identificar pontos de melhoria rapidinho.",
      obs: ""
    },
    69: {
      title: "Início do Mês",
      timing: "Dia 1 do 17º mês",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Novo mês chegando! 🌟 Novas aulas liberadas. Vamos!",
      obs: "Apenas renovados"
    },
    "70+": {
      title: "⭐ Lembrete Checkpoint",
      timing: "Dia 18 do mês (~21 meses)",
      channel: "📱 WhatsApp",
      audience: "Alunos ~21 meses",
      horario: "Manhã (9h-11h)",
      objective: "Lembrar do teste oficial",
      tipo: "Operacional",
      message: "E aí, [Nome]! 📊 Checkpoint Trimestral já está no ar! Você está quase na reta final. Bora garantir mais um certificado? 70+ pontos! Até dia 27! 🏆",
      obs: "⚠️ Checkpoint oficial"
    },
    70: {
      title: "Milestone 18 Meses",
      timing: "~18 meses",
      channel: "📱 WhatsApp",
      audience: "Renovados (filtro: data início)",
      horario: "Tarde (14h-16h)",
      objective: "Celebração",
      tipo: "Celebração",
      message: "18 meses! 🎯 Um ano e meio de jornada. {{nomedoaluno}}, sua persistência é admirável! Continue! 🏆",
      obs: ""
    },
    72: {
      title: "Dica Avançada Speaking",
      timing: "Semana 72",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Tarde (14h-16h)",
      objective: "Fluência oral",
      tipo: "Dica",
      message: "Dica pro! 💬 Participe de grupos de conversação online. Language exchange funciona demais para ganhar fluência!",
      obs: ""
    },
    75: {
      title: "Início do Mês",
      timing: "Dia 1 do 19º mês",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Bom dia! 🌞 Novo mês, novas aulas. Vamos! 🚀",
      obs: "Apenas renovados"
    },
    76: {
      title: "Quiz Idioms",
      timing: "Semana 76",
      channel: "📱 WhatsApp",
      audience: "Renovados",
      horario: "Tarde (14h-16h)",
      objective: "Expressões idiomáticas",
      tipo: "Engajamento",
      message: "Idiom quiz! 🎯 'It's raining cats and dogs' means: (a) Heavy rain (b) Animal chaos (c) Confused situation",
      obs: ""
    },
    77: {
      title: "Milestone 20 Meses",
      timing: "~20 meses",
      channel: "📱 WhatsApp",
      audience: "Renovados (filtro: data início)",
      horario: "Tarde (14h-16h)",
      objective: "Celebração",
      tipo: "Celebração",
      message: "20 meses! 🌟 Quase 2 anos de dedicação. {{nomedoaluno}}, você é exemplo de persistência! 💪",
      obs: ""
    },
    78: {
      title: "⚠️ BLACKOUT RENOVAÇÃO 24M",
      timing: "Semanas 78-83",
      channel: "🚫 SEM ENVIO",
      audience: "Plano 24 meses (vitalícios não)",
      horario: "",
      objective: "Espaço para time comercial",
      tipo: "PAUSA ESTRATÉGICA",
      message: "🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua neste período",
      obs: "⚠️ CRÍTICO: Verificar no CRM. Vitalícios CONTINUAM recebendo mensagens normais."
    },
    84: {
      title: "Dica Avançada",
      timing: "Semana 84",
      channel: "📱 WhatsApp",
      audience: "Renovados/Vitalícios",
      horario: "Tarde (14h-16h)",
      objective: "Desafio avançado",
      tipo: "Dica",
      message: "Desafio top! 🎯 Assista a um TED Talk em inglês SEM legendas. Teste seu nível de compreensão!",
      obs: ""
    },
    85: {
      title: "Início do Mês",
      timing: "Dia 1 do 22º mês",
      channel: "📱 WhatsApp",
      audience: "Renovados/Vitalícios",
      horario: "Manhã (9h-11h)",
      objective: "Novo módulo",
      tipo: "Lembrete",
      message: "Novo mês! 🌟 Novas aulas liberadas. Bora! 🚀",
      obs: ""
    },
    87: {
      title: "Milestone 22 Meses",
      timing: "~22 meses",
      channel: "📱 WhatsApp",
      audience: "Renovados/Vitalícios",
      horario: "Tarde (14h-16h)",
      objective: "Celebração",
      tipo: "Celebração",
      message: "22 meses! 🏆 Quase 2 anos completos. {{nomedoaluno}}, sua jornada é inspiradora! Continue firme! 💙",
      obs: ""
    },
    92: {
      title: "Milestone 2 ANOS",
      timing: "~730 dias",
      channel: "📱 WhatsApp",
      audience: "Vitalícios (filtro: data início)",
      horario: "Tarde (14h-16h)",
      objective: "Celebração máxima",
      tipo: "Celebração",
      message: "2 ANOS! 🎉🎂🏆 {{nomedoaluno}}, você completou 730 dias de dedicação absoluta ao inglês! PARABÉNS! Você é exemplo de persistência e evolução! 🌟💙",
      obs: "Marco máximo da régua"
    },
    93: {
      title: "Quiz Avançado",
      timing: "Semana 93",
      channel: "📱 WhatsApp",
      audience: "Vitalícios",
      horario: "Tarde (14h-16h)",
      objective: "Desafio avançado",
      tipo: "Engajamento",
      message: "Advanced quiz! 🎯 'Had I known, I ___ differently.' (a) would act (b) would have acted (c) will act",
      obs: ""
    },
    96: {
      title: "Dica Master",
      timing: "Semana 96",
      channel: "📱 WhatsApp",
      audience: "Vitalícios",
      horario: "Tarde (14h-16h)",
      objective: "Nível avançado",
      tipo: "Dica",
      message: "Dica master! 🎯 Comece a ler livros em inglês no original. Escolha um autor que você AMA. Vale a pena!",
      obs: ""
    },
    97: {
      title: "Gratidão",
      timing: "Semana 97",
      channel: "📱 WhatsApp",
      audience: "Vitalícios",
      horario: "Tarde (14h-16h)",
      objective: "Conexão emocional",
      tipo: "Celebração",
      message: "{{nomedoaluno}}, só queria dizer: OBRIGADA por fazer parte dessa jornada! Sua dedicação inspira a gente todos os dias. Você é incrível! 💙🌟",
      obs: ""
    },
    98: {
      title: "🔀 RENOVAÇÃO OU CONCLUSÃO",
      timing: "Semana 98",
      channel: "📱 WhatsApp",
      audience: "Vitalícios",
      horario: "Manhã (9h-11h)",
      objective: "Avaliação final",
      tipo: "CONDICIONAL",
      message: "SE CONTINUA: 'Que alegria ter você ainda conosco! Vamos continuar essa jornada juntos!' | SE FINALIZA: 'Foi uma honra te acompanhar nesses 2 anos. Você evoluiu demais! Sucesso sempre! 🏆'",
      obs: "Ponto final da régua de 2 anos"
    }
  };

function renderFasesCompacta(container) {
  let html = "";
  
  // Gatilhos comportamentais
  const weekTriggers = {
    3: {
      timing: "Dia 15-21",
      objective: "Verificar engajamento inicial alunos com alta presença na aula",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "QUE SEMANA INCRÍVEL, {{nomedoaluno}}! 🔥 Você fez {{aulas_feitas}} aulas! Isso é comprometimento de verdade. Continue assim!",
          obs: "Reforço positivo para aluno engajado"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi {{nomedoaluno}}! Vi que você fez {{aulas_feitas}} aulas. Como posso te ajudar a encaixar mais Lives na sua rotina?",
          obs: "Oferecer suporte proativo"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, percebi que ainda não conseguiu participar de nenhuma Live. Quer ajuda pra começar? Estou aqui! 💙",
          obs: "Abordagem empática e acolhedora"
        }
      ]
    },
    7: {
      timing: "Dia 10-15 do mês",
      objective: "Engajamento contínuo",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "Você está ARRASANDO! 🌟 Já são {{aulas_feitas}} aulas! Esse ritmo está perfeito. Continue assim!",
          obs: "Celebrar frequência alta"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi! Vi que você tem {{aulas_feitas}} aulas feitas. Que tal a gente tentar 3 aulas por semana? Te ajudo a montar um cronograma!",
          obs: "Sugerir meta alcançável"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, sinto sua falta nas aulas! O que podemos fazer pra te ver por lá? Vamos conversar? 🤝",
          obs: "Abrir diálogo"
        }
      ]
    },
    10: {
      timing: "Semana 10",
      objective: "Manutenção de engajamento",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "{{aulas_feitas}} aulas já! 🏆 {{nomedoaluno}}, você está no TOP dos alunos mais dedicados. Inspirador!",
          obs: "Reconhecimento de destaque"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi {{nomedoaluno}}! Notei que você tem {{aulas_feitas}} aulas. Quer dicas pra aproveitar melhor o curso?",
          obs: "Oferecer orientação"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, ainda não te vi nas Lives! Tem alguma dificuldade que eu possa ajudar? Me conta! 💙",
          obs: "Investigar obstáculos"
        }
      ]
    },
    18: {
      timing: "Semana 18",
      objective: "Reforço mid-journey",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "{{nomedoaluno}}, {{aulas_feitas}} aulas! 🌟 Você está construindo fluência de verdade. Continue firme!",
          obs: "Reforçar progresso"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi! Vi que você tem {{aulas_feitas}} aulas. Vamos ajustar sua rotina? Posso te ajudar!",
          obs: "Propor ajuste"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, quero muito te ver estudando! Me fala o que posso fazer pra te ajudar a começar? 🤝",
          obs: "Convite ativo"
        }
      ]
    },
    24: {
      timing: "Semana 24",
      objective: "Check-in semestral",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "6 meses de excelência! 🏆 {{aulas_feitas}} aulas mostram sua dedicação. Você é inspiração!",
          obs: "Celebração + reconhecimento"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi {{nomedoaluno}}! Meio ano se passou. Com {{aulas_feitas}} aulas, que tal a gente ajustar algo pra você aproveitar mais?",
          obs: "Revisão de estratégia"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, 6 meses e quero te ver estudando! O que posso fazer pra te ajudar a começar de verdade? 💙",
          obs: "Urgência acolhedora"
        }
      ]
    },
    30: {
      timing: "Semana 30",
      objective: "Manutenção momentum",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "{{aulas_feitas}} aulas! 🔥 {{nomedoaluno}}, você está VOANDO! Esse ritmo é perfeito. Bora continuar!",
          obs: "Manter motivação alta"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi! Com {{aulas_feitas}} aulas até agora, que tal a gente criar uma meta juntos? Te ajudo!",
          obs: "Criar comprometimento"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, vamos conversar? Quero te ajudar a aproveitar o curso. Bora começar? 🤝",
          obs: "Convite direto"
        }
      ]
    },
    36: {
      timing: "Semana 36",
      objective: "Pre-renovação momentum",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "9 meses de dedicação! 🌟 {{aulas_feitas}} aulas provam que você é aluno exemplar. Orgulho!",
          obs: "Reconhecimento pré-renovação"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi {{nomedoaluno}}! 9 meses já. Com {{aulas_feitas}} aulas, vamos ajustar pra você aproveitar MUITO mais?",
          obs: "Otimização pré-renovação"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, 9 meses e ainda não começou. Me ajuda a entender o que posso fazer por você? 💙",
          obs: "Última tentativa pré-renovação"
        }
      ]
    },
    50: {
      timing: "Semana 50",
      objective: "Ano completo checkpoint",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "Um ano de excelência, {{nomedoaluno}}! 🎉 Sua frequência exemplar mostra que fluência é resultado de disciplina!",
          obs: "Celebração anual + reforço"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi {{nomedoaluno}}! Um ano se passou e quero te ajudar a aproveitar melhor o curso. Vamos ajustar a rotina de aulas?",
          obs: "Revisão anual"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, um ano se passou e quero muito te ver estudando! Me fala o que posso fazer pra te ajudar a começar? 💙",
          obs: "Apelo final ano 1"
        }
      ]
    },
    54: {
      timing: "Semana 54",
      objective: "Início ano 2",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "Segundo ano começando FORTE! 🔥 {{aulas_feitas}} aulas mostram sua dedicação. Vamos juntos!",
          obs: "Motivação ano 2"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Ano 2 é a hora de decolar! Com {{aulas_feitas}} aulas, vamos criar uma rotina top? Te ajudo!",
          obs: "Novo começo"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, ano 2 começou! Vamos fazer diferente? Me conta como posso te ajudar! 💙",
          obs: "Reset ano 2"
        }
      ]
    },
    60: {
      timing: "Semana 60",
      objective: "Meio do ano 2",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "15 meses de excelência! 🏆 {{aulas_feitas}} aulas = fluência em construção. Você é TOP!",
          obs: "Reconhecimento sustentado"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi! 15 meses de jornada. Com {{aulas_feitas}} aulas, vamos otimizar? Posso te ajudar!",
          obs: "Ajuste mid-ano 2"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, 15 meses e quero te ver nas aulas! Bora conversar sobre isso? 🤝",
          obs: "Persistência ano 2"
        }
      ]
    },
    66: {
      timing: "Semana 66",
      objective: "Momentum contínuo",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "{{aulas_feitas}} aulas! 🌟 {{nomedoaluno}}, você é exemplo de persistência. Continue assim!",
          obs: "Manter energia"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Oi! Vi que você tem {{aulas_feitas}} aulas. Vamos ajustar pra você aproveitar mais? Te ajudo!",
          obs: "Otimização contínua"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, quero muito te ajudar a começar! Vamos conversar? 💙",
          obs: "Convite permanente"
        }
      ]
    },
    73: {
      timing: "Semana 73",
      objective: "Pre-renovação ano 2",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "18 meses de excelência! 🏆 {{aulas_feitas}} aulas mostram sua determinação. Você é incrível!",
          obs: "Reforço pré-renovação ano 2"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "18 meses de jornada! Com {{aulas_feitas}} aulas, vamos otimizar os próximos meses? Te ajudo!",
          obs: "Ajuste final"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, 18 meses e ainda quero te ver estudando! Me ajuda a te ajudar? 💙",
          obs: "Último apelo estruturado"
        }
      ]
    },
    90: {
      timing: "Semana 90",
      objective: "Reta final",
      scenarios: [
        {
          type: "alta",
          title: "Alta Frequência",
          condition: "Presença > 55%",
          message: "Quase lá! 🎯 {{aulas_feitas}} aulas = dedicação total. {{nomedoaluno}}, você é inspiração!",
          obs: "Motivação final"
        },
        {
          type: "baixa",
          title: "Baixa Frequência",
          condition: "0% < Presença ≤ 55%",
          message: "Reta final! Com {{aulas_feitas}} aulas, vamos terminar FORTE? Te ajudo a fechar com chave de ouro!",
          obs: "Sprint final"
        },
        {
          type: "zero",
          title: "Zero Frequência",
          condition: "Presença = 0%",
          message: "{{nomedoaluno}}, última chance de aproveitar! Vamos começar agora? Estou aqui! 💙",
          obs: "Urgência final"
        }
      ]
    }
  };
  
  // Definir fases com seus períodos e semanas livres
  const phases = [
    {
      number: 1,
      name: "Onboarding",
      period: "Semana 0",
      weeks: [0],
      free_weeks: [1]
    },
    {
      number: 2,
      name: "Primeiros 30 Dias",
      period: "Semanas 2-4",
      weeks: [2, 3, 4],
      free_weeks: [5]
    },
    {
      number: 3,
      name: "Consolidação",
      period: "Semanas 6-10",
      weeks: [6, 7, 8, 9, 10],
      free_weeks: [11]
    },
    {
      number: 4,
      name: "Marcos da Jornada",
      period: "Semanas 12-15",
      weeks: [12, "12+", 13, 15],
      free_weeks: [14, 16]
    },
    {
      number: 5,
      name: "Nutrição Contínua",
      period: "Semanas 17-24",
      weeks: [17, 18, 20, 21, 23, "24+", 24],
      free_weeks: [19, 22, 25]
    },
    {
      number: 6,
      name: "Rotina Estabelecida",
      period: "Semanas 26-33",
      weeks: [26, 27, 29, 30, 32, 33],
      free_weeks: [28, 31, 34]
    },
    {
      number: 7,
      name: "Aprofundamento",
      period: "Semanas 35-40",
      weeks: [35, "36+", 36, 37, 39, 40],
      free_weeks: [38]
    },
    {
      number: 8,
      name: "Período Renovação",
      period: "Semanas 41-47",
      weeks: [41],
      free_weeks: [42, 43, 44, 45, 46, 47]  // Blackout
    },
    {
      number: 9,
      name: "Pós-Renovação",
      period: "Semanas 48-50",
      weeks: [48, 49, "50+", 50],
      free_weeks: [51]
    },
    {
      number: 10,
      name: "Ano 2 - Fluência",
      period: "Semanas 52-64",
      weeks: [52, 53, 54, 56, 57, "60+", 60, 61, 63, 64],
      free_weeks: [55, 58, 59, 62, 65]
    },
    {
      number: 11,
      name: "Refinamento",
      period: "Semanas 66-77",
      weeks: [66, 67, 69, "70+", 70, 72, 73, 75, 76, 77],
      free_weeks: [68, 71, 74]
    },
    {
      number: 12,
      name: "Período Renovação Final",
      period: "Semanas 78-83",
      weeks: [78],
      free_weeks: [79, 80, 81, 82, 83]  // Blackout ano 2
    },
    {
      number: 13,
      name: "Reta Final",
      period: "Semanas 84-91",
      weeks: [84, 85, 87, 90],
      free_weeks: [86, 88, 89, 91]
    },
    {
      number: 14,
      name: "Conclusão",
      period: "Semanas 92-98",
      weeks: [92, 93, 96, 97, 98],
      free_weeks: [94, 95]
    }
  ];
  
  // Renderizar cada fase
  phases.forEach(phase => {
    html += `
      <div class="journey-phase">
        <div class="phase-header-new">
          <div class="phase-number-new">FASE ${phase.number}</div>
          <div class="phase-info-new">
            <div class="phase-name-new">${phase.name}</div>
            <div class="phase-period-new">${phase.period}</div>
          </div>
          ${phase.free_weeks && phase.free_weeks.length > 0 ? `
            <div class="free-weeks-badge" title="Semanas sem envio de mensagens">
              📭 Semana Livre: ${phase.free_weeks.join(' | ')}
            </div>
          ` : ''}
        </div>
        <div class="week-grid">
    `;
    
    // Renderizar semanas dentro da fase
    phase.weeks.forEach(week => {
      // Se a semana tem gatilho
      if (weekTriggers[week]) {
        const trigger = weekTriggers[week];
        html += `
          <div class="trigger-card" data-week="${week}">
            <div class="trigger-header" onclick="toggleTrigger(${week})">
              <div class="trigger-title">
                <span class="trigger-week-badge">Semana ${week}</span>
                🎯 SLOT GATILHO
              </div>
              <div class="trigger-toggle">▼</div>
            </div>
            <div class="trigger-scenarios">
        `;
        
        trigger.scenarios.forEach(scenario => {
          html += `
            <div class="scenario-item ${scenario.type}">
              <div class="scenario-header">
                <span class="scenario-badge ${scenario.type}">${scenario.title}</span>
                <div class="message-actions">
                  <button class="action-btn" onclick="copyToClipboard(\`${scenario.message.replace(/`/g, '\\`').replace(/'/g, "\\'")}\`)" title="Copiar mensagem">
                    📋
                  </button>
                  ${scenario.obs ? `<button class="action-btn" onclick="showObservation(\`${scenario.obs.replace(/`/g, '\\`').replace(/'/g, "\\'")}\`)" title="Ver observação">ℹ️</button>` : ''}
                </div>
              </div>
              <div class="scenario-preview">${scenario.message}</div>
              ${scenario.condition ? `<div class="scenario-meta"><span class="meta-badge timing">${scenario.condition}</span></div>` : ''}
            </div>
          `;
        });
        
        html += `
            </div>
          </div>
        `;
      }
      // Se a semana tem mensagem normal
      else if (weekMessages[week]) {
        const msg = weekMessages[week];
        html += `
          <div class="message-card-compact">
            <div class="message-header-compact">
              <span class="message-week">Semana ${week}</span>
              <div class="message-actions">
                <button class="action-btn" onclick="copyToClipboard(\`${msg.message.replace(/`/g, '\\`').replace(/'/g, "\\'")}\`)" title="Copiar mensagem">
                  📋
                </button>
                ${msg.obs ? `<button class="action-btn" onclick="showObservation(\`${msg.obs.replace(/`/g, '\\`').replace(/'/g, "\\'")}\`)" title="Ver observação">ℹ️</button>` : ''}
              </div>
            </div>
            <div class="message-title-compact">${msg.title}</div>
            <div class="message-meta-compact">
              <span class="meta-badge timing">⏰ ${msg.timing}</span>
              <span class="meta-badge channel">${msg.channel}</span>
              <span class="meta-badge audience">👥 ${msg.audience}</span>
              <span class="meta-badge objective">🎯 ${msg.objective}</span>
            </div>
            ${msg.tipo ? `
              <div class="message-tags-compact">
                <span class="tag-badge-compact">${msg.tipo}</span>
                ${msg.horario ? `<span class="tag-badge-compact">🕐 ${msg.horario}</span>` : ''}
              </div>
            ` : ''}
            <div class="message-preview" onclick="toggleMessageExpand(this)">
              ${msg.message}
            </div>
          </div>
        `;
      }
    });
    
    html += `
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

// Funções auxiliares (mantidas iguais)
function toggleTrigger(week) {
  const card = document.querySelector(`.trigger-card[data-week="${week}"]`);
  if (card) {
    card.classList.toggle('expanded');
  }
}

function toggleMessageExpand(element) {
  element.classList.toggle('expanded');
}

function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(() => {
    showToast('✓ Mensagem copiada!');
  }).catch(err => {
    console.error('Erro ao copiar:', err);
    showToast('❌ Erro ao copiar');
  });
}

function showObservation(obs) {
  // Criar modal customizado em vez de alert
  const modal = document.createElement('div');
  modal.className = 'obs-modal';
  modal.innerHTML = `
    <div class="obs-modal-content">
      <div class="obs-modal-header">
        <span>ℹ️ Observação Importante</span>
        <button onclick="this.closest('.obs-modal').remove()" class="obs-modal-close">×</button>
      </div>
      <div class="obs-modal-body">
        ${obs}
      </div>
    </div>
  `;
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    animation: fadeIn 0.2s ease;
  `;
  modal.onclick = (e) => {
    if (e.target === modal) modal.remove();
  };
  document.body.appendChild(modal);
}

function showToast(message) {
  const existingToast = document.querySelector('.toast-notification');
  if (existingToast) {
    existingToast.remove();
  }
  
  const toast = document.createElement('div');
  toast.className = 'toast-notification';
  toast.textContent = message;
  toast.style.cssText = `
    position: fixed;
    bottom: 24px;
    right: 24px;
    background: var(--accent);
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    box-shadow: var(--shadow-lg);
    z-index: 10000;
    animation: slideIn 0.3s ease;
  `;
  
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.style.animation = 'slideOut 0.3s ease';
    setTimeout(() => toast.remove(), 300);
  }, 2000);
}

// Função para expandir/colapsar gatilho
function toggleTrigger(week) {
  const card = document.querySelector(`.trigger-card[data-week="${week}"]`);
  if (card) {
    card.classList.toggle('expanded');
  }
}

// Função para expandir/colapsar mensagem
function toggleMessageExpand(element) {
  element.classList.toggle('expanded');
}

// Função para copiar para clipboard
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(() => {
    // Mostrar feedback visual
    showToast('✓ Mensagem copiada!');
  }).catch(err => {
    console.error('Erro ao copiar:', err);
    showToast('❌ Erro ao copiar');
  });
}

// Função para mostrar observação
function showObservation(obs) {
  alert(obs);
}

// Função para mostrar toast de feedback
function showToast(message) {
  // Remover toast anterior se existir
  const existingToast = document.querySelector('.toast-notification');
  if (existingToast) {
    existingToast.remove();
  }
  
  // Criar novo toast
  const toast = document.createElement('div');
  toast.className = 'toast-notification';
  toast.textContent = message;
  toast.style.cssText = `
    position: fixed;
    bottom: 24px;
    right: 24px;
    background: var(--accent);
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    box-shadow: var(--shadow-lg);
    z-index: 10000;
    animation: slideIn 0.3s ease;
  `;
  
  document.body.appendChild(toast);
  
  // Remover após 2 segundos
  setTimeout(() => {
    toast.style.animation = 'slideOut 0.3s ease';
    setTimeout(() => toast.remove(), 300);
  }, 2000);
}

// ═══════════════════════════════════════════════════════════
// RENDER FASES (VERSÃO ANTIGA - MANTIDA PARA COMPATIBILIDADE)
// ═══════════════════════════════════════════════════════════
function renderFases(container) {
  let html = "";
  
  // ═══ Fase 1 - Onboarding ═══
  html += `
    <div class="phase phase-fase-1">
      <div class="phase-header">
        <div class="phase-title">Fase 1 - Onboarding</div>
        <div class="phase-badge">1 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Dentro de 24h da matrícula</div>
            <div class="msg-title">Boas-vindas</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dentro de 24h da matrícula</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Primeiro contato + agendamento Aula Zero
        </div>
        <div class="msg-text">
          Olá, {{nomedoaluno}}. Seja muito bem-vindo(a) ao Wise Up Online! Sou a Cecilia do suporte Live e vou te acompanhar nessa jornada incrível. 🎉 Como parte do processo inicial para novos alunos, precisamos de cerca de 10min com você para verificar o acesso ao Zoom e liberar seu documento de assinatura. Você poderia me informar qual o melhor horário hoje e em qual estado você está, para que eu confira o fuso corretamente?
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Olá, {{nomedoaluno}}. Seja muito bem-vindo(a) ao Wise Up Online! Sou a Cecilia do suporte Live e vou te acompanhar nessa jornada incrível. 🎉 Como parte do processo inicial para novos alunos, precisamos de cerca de 10min com você para verificar o acesso ao Zoom e liberar seu documento de assinatura. Você poderia me informar qual o melhor horário hoje e em qual estado você está, para que eu confira o fuso corretamente?')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('NÃO ALTERAR - Tour completo na plataforma + liberação documento. Duração: ~10min. ⚠️ Se não responder: Régua de Recuperação (8 dias): Dias 1-5: 1x/dia | Dias 6-7: 2x/dia | Dia 8: 3x/dia. Canais: WhatsApp, Ligação, Email')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 2 - Primeiros 30 Dias ═══
  html += `
    <div class="phase phase-fase-2">
      <div class="phase-header">
        <div class="phase-title">Fase 2 - Primeiros 30 Dias</div>
        <div class="phase-badge">5 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 2</div>
            <div class="msg-title">Check-in Inicial</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 9 após matrícula</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Verificar exploração do material
        </div>
        <div class="msg-text">
          Oi {{nomedoaluno}}! Passando só pra saber se já explorou o Material Didático? Tem alguma dúvida que eu possa te ajudar?
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Passando só pra saber se já explorou o Material Didático? Tem alguma dúvida que eu possa te ajudar?')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Mensagem leve de suporte')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 3</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-2-gatilho-3')">
            <span id="icon-fase-2-gatilho-3">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 3</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-2-gatilho-3">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">QUE SEMANA INCRÍVEL, {{nomedoaluno}}! 🔥 Você fez {total_aulas} aulas! Isso é comprometimento de verdade. Continue assim!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('QUE SEMANA INCRÍVEL, {{nomedoaluno}}! 🔥 Você fez {total_aulas} aulas! Isso é comprometimento de verdade. Continue assim!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, vi que você deu uma olhada na plataforma! 👀 Sabia que se perder alguma aula pode revisitar ela em outra turma dentro da mesma semana? É só acessar a aba live e clicar em &#x27;revisitar aulas&#x27;. 😊</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, vi que você deu uma olhada na plataforma! 👀 Sabia que se perder alguma aula pode revisitar ela em outra turma dentro da mesma semana? É só acessar a aba live e clicar em \'revisitar aulas\'. 😊')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, vi que você ainda não começou as aulas. Quer ajuda pra agendar? É super fácil! Posso te mostrar como fazer. 💙</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, vi que você ainda não começou as aulas. Quer ajuda pra agendar? É super fácil! Posso te mostrar como fazer. 💙')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 4</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês seguinte</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Celebração/Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Motivar início de módulo
        </div>
        <div class="msg-text">
          Passando pra te desejar um ótimo começo de mês! 😊 As aulas ao vivo iniciam nessa primeira semana com um novo conteúdo. Corre conferir qual módulo será abordado e inicie suas preparações para a primeira aula!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Passando pra te desejar um ótimo começo de mês! 😊 As aulas ao vivo iniciam nessa primeira semana com um novo conteúdo. Corre conferir qual módulo será abordado e inicie suas preparações para a primeira aula!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Enviar no dia 1 do mês')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 3 - Consolidação ═══
  html += `
    <div class="phase phase-fase-3">
      <div class="phase-header">
        <div class="phase-title">Fase 3 - Consolidação</div>
        <div class="phase-badge">9 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 6</div>
            <div class="msg-title">Dica de Estudo</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 6</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Engajamento educacional
        </div>
        <div class="msg-text">
          Dica da semana! 💡 Sabia que revisar o material antes da aula aumenta em 40% sua retenção? Dá uma olhadinha nas preparações da próxima aula. Você vai arrasar! 🌟
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Dica da semana! 💡 Sabia que revisar o material antes da aula aumenta em 40% sua retenção? Dá uma olhadinha nas preparações da próxima aula. Você vai arrasar! 🌟')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Dica prática')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 7</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-3-gatilho-7')">
            <span id="icon-fase-3-gatilho-7">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 7</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-3-gatilho-7">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">Você está VOANDO, {{nomedoaluno}}! 🚀 Seu inglês está ganhando forma a cada estudo! A constância que você vem mantendo é exatamente o que leva à fluência.</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Você está VOANDO, {{nomedoaluno}}! 🚀 Seu inglês está ganhando forma a cada estudo! A constância que você vem mantendo é exatamente o que leva à fluência.')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">Às vezes a rotina aperta mesmo, né {{nomedoaluno}}? 😊 Que tal a gente conversar pra ajustar o agendamento das suas aulas de inglês pra você conseguir aproveitar mais?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Às vezes a rotina aperta mesmo, né {{nomedoaluno}}? 😊 Que tal a gente conversar pra ajustar o agendamento das suas aulas de inglês pra você conseguir aproveitar mais?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! 💙 Quero te ajudar a aproveitar ao máximo seu curso de inglês. Se ainda não conseguiu entrar nas aulas, me conta o que está te travando que a gente resolve juntos.</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! 💙 Quero te ajudar a aproveitar ao máximo seu curso de inglês. Se ainda não conseguiu entrar nas aulas, me conta o que está te travando que a gente resolve juntos.')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 8</div>
            <div class="msg-title">Milestone 45 Dias</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Dia 45</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos (filtro: data início)</span>
          <span class="tag tag-tipo">Celebração</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Reconhecimento
        </div>
        <div class="msg-text">
          Você já completou 45+ dias no seu curso de inglês! Continue firme, cada dia conta na sua evolução. 🎉
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Você já completou 45+ dias no seu curso de inglês! Continue firme, cada dia conta na sua evolução. 🎉')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Comemorar persistência')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 9</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo módulo
        </div>
        <div class="msg-text">
          Um novo mês começou 🌟 E com ele, um novo módulo nas aulas ao vivo de inglês, perfeito pra dar mais um passo na sua evolução.
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Um novo mês começou 🌟 E com ele, um novo módulo nas aulas ao vivo de inglês, perfeito pra dar mais um passo na sua evolução.')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Repetir mensalmente')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 10</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-3-gatilho-10')">
            <span id="icon-fase-3-gatilho-10">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 10</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-3-gatilho-10">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">WOW {{nomedoaluno}}! Que ritmo de estudos é esse?! 🔥 Você está voando! Sua dedicação vai te levar muito longe. Parabéns!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('WOW {{nomedoaluno}}! Que ritmo de estudos é esse?! 🔥 Você está voando! Sua dedicação vai te levar muito longe. Parabéns!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! 💙 Vi que você tem feito poucas aulas ultimamente. Vamos ver juntos como encaixar mais aulas na sua rotina? Sua evolução depende da frequência! 💪</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! 💙 Vi que você tem feito poucas aulas ultimamente. Vamos ver juntos como encaixar mais aulas na sua rotina? Sua evolução depende da frequência! 💪')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, percebi que você está há bastante tempo sem fazer aulas. Vamos conversar? Quero muito te ajudar a retomar. Quando você tem um tempo?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, percebi que você está há bastante tempo sem fazer aulas. Vamos conversar? Quero muito te ajudar a retomar. Quando você tem um tempo?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 4 - Marcos da Jornada ═══
  html += `
    <div class="phase phase-fase-4">
      <div class="phase-header">
        <div class="phase-title">Fase 4 - Marcos da Jornada</div>
        <div class="phase-badge">4 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 12</div>
            <div class="msg-title">Dica Prática</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 12</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Engajamento cultural
        </div>
        <div class="msg-text">
          Dica 💡 Mudar o idioma do celular para inglês ajuda muito na familiaridade com palavras do dia a dia.
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Dica 💡 Mudar o idioma do celular para inglês ajuda muito na familiaridade com palavras do dia a dia.')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Dica aplicável')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 13</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo conteúdo
        </div>
        <div class="msg-text">
          [Nome], um novo mês começou! As aulas ao vivo já estão rolando com conteúdo novo preparado pra você 💙
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('[Nome], um novo mês começou! As aulas ao vivo já estão rolando com conteúdo novo preparado pra você 💙')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Padrão mensal')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 15</div>
            <div class="msg-title">Quiz Interativo</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 15</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Interação lúdica
        </div>
        <div class="msg-text">
          Quiz time 🎯 Complete: &#x27;This week, I ___ study English.&#x27; (a) will (b) am (c) did. Responde aqui 😊
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Quiz time 🎯 Complete: \'This week, I ___ study English.\' (a) will (b) am (c) did. Responde aqui 😊')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Gamificação')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 12+</div>
            <div class="msg-title">⭐ Lembrete Checkpoint</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 18 do mês (~3,5 meses)</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos com ~3,5 meses</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Lembrar do teste oficial
        </div>
        <div class="msg-text">
          Oi [Nome]! 📊 Seu Checkpoint Trimestral já está liberado na página inicial até o dia 27! É a chance de testar seus conhecimentos e, com 70 pontos ou mais, você avança de nível e recebe seu certificado. Bora lá! 🎓
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Oi [Nome]! 📊 Seu Checkpoint Trimestral já está liberado na página inicial até o dia 27! É a chance de testar seus conhecimentos e, com 70 pontos ou mais, você avança de nível e recebe seu certificado. Bora lá! 🎓')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ Enviar SOMENTE entre dias 18-27 do mês. Este é o teste oficial trimestral')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 5 - Nutrição Contínua ═══
  html += `
    <div class="phase phase-fase-5">
      <div class="phase-header">
        <div class="phase-title">Fase 5 - Nutrição Contínua</div>
        <div class="phase-badge">11 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 17</div>
            <div class="msg-title">Dica Semanal</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 17</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Imersão cultural
        </div>
        <div class="msg-text">
          Dica da Semana! 💡 Assista séries em inglês com legenda em inglês (não em português!). Seu cérebro vai fazer conexões incríveis entre som e escrita. Já tem alguma série favorita?
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Dica da Semana! 💡 Assista séries em inglês com legenda em inglês (não em português!). Seu cérebro vai fazer conexões incríveis entre som e escrita. Já tem alguma série favorita?')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Consumo de conteúdo')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 18</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-5-gatilho-18')">
            <span id="icon-fase-5-gatilho-18">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 18</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-5-gatilho-18">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, que evolução inspiradora! 🌟 Sua frequência nas aulas mostra que você está levando a sério. Continue nesse ritmo!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, que evolução inspiradora! 🌟 Sua frequência nas aulas mostra que você está levando a sério. Continue nesse ritmo!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, percebi que sua frequência caiu um pouco. Tudo bem por aí? Podemos ajustar os horários das aulas para facilitar pra você!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, percebi que sua frequência caiu um pouco. Tudo bem por aí? Podemos ajustar os horários das aulas para facilitar pra você!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}, tudo bem? Notei que você ainda não iniciou as aulas. Tem algo que eu possa fazer pra te ajudar a começar? Estou aqui! 💙</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}, tudo bem? Notei que você ainda não iniciou as aulas. Tem algo que eu possa fazer pra te ajudar a começar? Estou aqui! 💙')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 20</div>
            <div class="msg-title">Milestone Semestral</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Mês 5</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Filtro: data matrícula</span>
          <span class="tag tag-tipo">Celebração</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Reconhecimento
        </div>
        <div class="msg-text">
          Parabéns! Você completou 5 meses de jornada no inglês 🎉 Cada aula é um tijolo na construção da sua fluência. Continue assim!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Parabéns! Você completou 5 meses de jornada no inglês 🎉 Cada aula é um tijolo na construção da sua fluência. Continue assim!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Marco importante')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 21</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo módulo
        </div>
        <div class="msg-text">
          Novo mês, nova energia! 🌟 As aulas ao vivo desta semana trazem conteúdo fresquinho. Bora aproveitar?
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Novo mês, nova energia! 🌟 As aulas ao vivo desta semana trazem conteúdo fresquinho. Bora aproveitar?')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Padrão mensal')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 23</div>
            <div class="msg-title">Dica Cultural</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 23</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Vocabulário expandido
        </div>
        <div class="msg-text">
          💡 Dica: Siga perfis em inglês nas redes sociais sobre temas que você ama. Aprender fica natural quando é sobre algo que te interessa!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('💡 Dica: Siga perfis em inglês nas redes sociais sobre temas que você ama. Aprender fica natural quando é sobre algo que te interessa!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Aprendizado passivo')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 24</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-5-gatilho-24')">
            <span id="icon-fase-5-gatilho-24">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 24</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-5-gatilho-24">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">Parabéns pela disciplina, {{nomedoaluno}}! 🏆 6 meses de dedicação e você não deixou a peteca cair. Isso é ser vencedor!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Parabéns pela disciplina, {{nomedoaluno}}! 🏆 6 meses de dedicação e você não deixou a peteca cair. Isso é ser vencedor!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! Notei que você tem participado menos das aulas. Vamos achar um jeito de você aproveitar melhor o curso? Estou aqui pra ajudar! 💙</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Notei que você tem participado menos das aulas. Vamos achar um jeito de você aproveitar melhor o curso? Estou aqui pra ajudar! 💙')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, sinto sua falta nas aulas! 💙 Me conta o que está acontecendo? Vamos encontrar uma forma de você começar a estudar?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, sinto sua falta nas aulas! 💙 Me conta o que está acontecendo? Vamos encontrar uma forma de você começar a estudar?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 24+</div>
            <div class="msg-title">⭐ Lembrete Checkpoint</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 18 do mês (~7 meses)</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos com ~7 meses</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Lembrar do teste oficial
        </div>
        <div class="msg-text">
          Olá [Nome]! 📊 Seu segundo Checkpoint Trimestral está disponível na página inicial! Lembrando: 70 pontos ou mais = novo nível + certificado. Você tem até o dia 27! 💪
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Olá [Nome]! 📊 Seu segundo Checkpoint Trimestral está disponível na página inicial! Lembrando: 70 pontos ou mais = novo nível + certificado. Você tem até o dia 27! 💪')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ Enviar SOMENTE entre dias 18-27 do mês. Checkpoint oficial')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 6 - Rotina Estabelecida ═══
  html += `
    <div class="phase phase-fase-6">
      <div class="phase-header">
        <div class="phase-title">Fase 6 - Rotina Estabelecida</div>
        <div class="phase-badge">8 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 26</div>
            <div class="msg-title">Quiz Interativo</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 26</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Prática rápida
        </div>
        <div class="msg-text">
          Quick quiz! 🎯 What&#x27;s the past tense of &#x27;go&#x27;? (a) goed (b) went (c) gone. Responde aqui!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Quick quiz! 🎯 What\'s the past tense of \'go\'? (a) goed (b) went (c) gone. Responde aqui!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Revisão gramatical')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 27</div>
            <div class="msg-title">Dica de Pronúncia</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 27</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Melhoria técnica
        </div>
        <div class="msg-text">
          🎙️ Dica de pronúncia: Grave você mesmo falando em inglês e escute depois. Você vai identificar pontos de melhoria rapidinho!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🎙️ Dica de pronúncia: Grave você mesmo falando em inglês e escute depois. Você vai identificar pontos de melhoria rapidinho!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Autocorreção')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 29</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo ciclo
        </div>
        <div class="msg-text">
          Olá! Mais um mês de evolução começando 🚀 Seu módulo novo já está liberado nas aulas ao vivo!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Olá! Mais um mês de evolução começando 🚀 Seu módulo novo já está liberado nas aulas ao vivo!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Mensagem padrão')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 30</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-6-gatilho-30')">
            <span id="icon-fase-6-gatilho-30">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 30</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-6-gatilho-30">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, você é exemplo de comprometimento! 💪 Sua constância nas aulas é o diferencial que te levará à fluência.</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, você é exemplo de comprometimento! 💪 Sua constância nas aulas é o diferencial que te levará à fluência.')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, a rotina tá pesada? 😊 Vamos tentar reorganizar seus horários de aula pra você conseguir participar mais?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, a rotina tá pesada? 😊 Vamos tentar reorganizar seus horários de aula pra você conseguir participar mais?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! Quero muito te ver nas aulas. O que está impedindo você de começar? Posso te ajudar a resolver! 😊</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Quero muito te ver nas aulas. O que está impedindo você de começar? Posso te ajudar a resolver! 😊')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 32</div>
            <div class="msg-title">Milestone 8 Meses</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Mês 8</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Filtro: data matrícula</span>
          <span class="tag tag-tipo">Celebração</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Reconhecimento evolução
        </div>
        <div class="msg-text">
          8 meses de dedicação! 🎉 Você já percebeu como está mais confortável com o inglês? Continue, a fluência está cada vez mais próxima!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('8 meses de dedicação! 🎉 Você já percebeu como está mais confortável com o inglês? Continue, a fluência está cada vez mais próxima!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Celebrar constância')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 33</div>
            <div class="msg-title">Dica Listening</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 33</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Compreensão auditiva
        </div>
        <div class="msg-text">
          💡 Ouça podcasts em inglês enquanto faz outras atividades. Seu ouvido vai se acostumando naturalmente com o idioma!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('💡 Ouça podcasts em inglês enquanto faz outras atividades. Seu ouvido vai se acostumando naturalmente com o idioma!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Imersão casual')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 7 - Aprofundamento ═══
  html += `
    <div class="phase phase-fase-7">
      <div class="phase-header">
        <div class="phase-title">Fase 7 - Aprofundamento</div>
        <div class="phase-badge">8 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 35</div>
            <div class="msg-title">Quiz Cultural</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 35</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Curiosidade
        </div>
        <div class="msg-text">
          🌎 Quiz cultural! In which country do they say &#x27;lift&#x27; instead of &#x27;elevator&#x27;? (a) USA (b) UK (c) Australia
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🌎 Quiz cultural! In which country do they say \'lift\' instead of \'elevator\'? (a) USA (b) UK (c) Australia')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Variações do inglês')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 36</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-7-gatilho-36')">
            <span id="icon-fase-7-gatilho-36">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 36</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-7-gatilho-36">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">Incrível, {{nomedoaluno}}! 9 meses e você segue firme! 🎯 Esse é o caminho do sucesso no inglês!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Incrível, {{nomedoaluno}}! 9 meses e você segue firme! 🎯 Esse é o caminho do sucesso no inglês!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! Vi que você está com dificuldade pra manter a frequência. Que tal conversarmos sobre isso? Podemos encontrar uma solução juntos!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Vi que você está com dificuldade pra manter a frequência. Que tal conversarmos sobre isso? Podemos encontrar uma solução juntos!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, você tem um curso incrível esperando por você! Me conta o que posso fazer pra te ajudar a dar o primeiro passo?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, você tem um curso incrível esperando por você! Me conta o que posso fazer pra te ajudar a dar o primeiro passo?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 37</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo módulo
        </div>
        <div class="msg-text">
          Bom dia! 🌞 Novo mês, novas aulas ao vivo liberadas. Vamos juntos nessa!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Bom dia! 🌞 Novo mês, novas aulas ao vivo liberadas. Vamos juntos nessa!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Padrão mensal')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 39</div>
            <div class="msg-title">Dica Writing</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 39</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Todos os alunos</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Escrita ativa
        </div>
        <div class="msg-text">
          ✍️ Dica: Escreva pequenas anotações do dia a dia em inglês. Lista de compras, lembretes... Tudo conta!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('✍️ Dica: Escreva pequenas anotações do dia a dia em inglês. Lista de compras, lembretes... Tudo conta!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Prática diária')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 40</div>
            <div class="msg-title">Milestone 10 Meses</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Mês 10</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Filtro: data matrícula</span>
          <span class="tag tag-tipo">Celebração</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Marco importante
        </div>
        <div class="msg-text">
          10 meses! 🏆 Você está entre os alunos mais dedicados. Sua evolução é inspiradora!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('10 meses! 🏆 Você está entre os alunos mais dedicados. Sua evolução é inspiradora!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('🚨 ATENÇÃO: Não mencionar conclusão. Time de renovação entra em ação')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 36+</div>
            <div class="msg-title">⭐ Lembrete Checkpoint</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 18 do mês (~10,5 meses)</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos com ~10,5 meses</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Lembrar do teste oficial
        </div>
        <div class="msg-text">
          E aí, [Nome]! 📊 Já viu que seu Checkpoint Trimestral está liberado? É a hora de mostrar tudo que aprendeu! 70+ pontos = próximo nível + certificado. Disponível até dia 27! 🌟
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('E aí, [Nome]! 📊 Já viu que seu Checkpoint Trimestral está liberado? É a hora de mostrar tudo que aprendeu! 70+ pontos = próximo nível + certificado. Disponível até dia 27! 🌟')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ Enviar SOMENTE entre dias 18-27 do mês. Checkpoint oficial')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 7 - Período Renovação ═══
  html += `
    <div class="phase phase-fase-8">
      <div class="phase-header">
        <div class="phase-title">Fase 7 - Período Renovação</div>
        <div class="phase-badge">1 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semanas 42-47</div>
            <div class="msg-title">⚠️ BLACKOUT RENOVAÇÃO 12M</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semanas 42-47</span>
          <span class="meta-item">🚫 SEM ENVIO</span>
          <span class="meta-item">👥 Plano 12 meses</span>
          <span class="tag tag-tipo">PAUSA ESTRATÉGICA</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Espaço para time comercial
        </div>
        <div class="msg-text">
          🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua neste período
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua neste período')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ CRÍTICO: Verificar no CRM se aluno está em processo de renovação. Não enviar mensagens do suporte Live para não conflitar com abordagem comercial.')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 8 - Consolidação Avançada ═══
  html += `
    <div class="phase phase-fase-9">
      <div class="phase-header">
        <div class="phase-title">Fase 8 - Consolidação Avançada</div>
        <div class="phase-badge">5 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 49</div>
            <div class="msg-title">Quiz Gramática</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 49</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Somente renovados</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Revisão
        </div>
        <div class="msg-text">
          Grammar check! 🎯 &#x27;If I ___ you, I would study more.&#x27; (a) was (b) were (c) am
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Grammar check! 🎯 \'If I ___ you, I would study more.\' (a) was (b) were (c) am')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Enviar SOMENTE para alunos que renovaram')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 50</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-9-gatilho-50')">
            <span id="icon-fase-9-gatilho-50">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 50</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-9-gatilho-50">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">Um ano de excelência, {{nomedoaluno}}! 🎉 Sua frequência exemplar mostra que fluência é resultado de disciplina!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Um ano de excelência, {{nomedoaluno}}! 🎉 Sua frequência exemplar mostra que fluência é resultado de disciplina!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! Um ano se passou e quero te ajudar a aproveitar melhor o curso. Vamos ajustar a rotina de aulas?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Um ano se passou e quero te ajudar a aproveitar melhor o curso. Vamos ajustar a rotina de aulas?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, um ano se passou e quero muito te ver estudando! Me fala o que posso fazer pra te ajudar a começar? 💙</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, um ano se passou e quero muito te ver estudando! Me fala o que posso fazer pra te ajudar a começar? 💙')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 50+</div>
            <div class="msg-title">⭐ Lembrete Checkpoint</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 18 do mês (~14 meses)</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Renovados ~14 meses</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Lembrar do teste oficial
        </div>
        <div class="msg-text">
          Lembrete: O checkpoint Trimestral é liberado na pagina inicial do dia 18/ mês até 27/mês! Bora conquistar mais um certificado? 70+ pontos e você avança!🚀
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Lembrete: O checkpoint Trimestral é liberado na pagina inicial do dia 18/ mês até 27/mês! Bora conquistar mais um certificado? 70+ pontos e você avança!🚀')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ Checkpoint oficial para renovadose e vitalícios ')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 8 - Pós Renovação 12M ═══
  html += `
    <div class="phase phase-fase-10">
      <div class="phase-header">
        <div class="phase-title">Fase 8 - Pós Renovação 12M</div>
        <div class="phase-badge">1 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 48</div>
            <div class="msg-title">🔀 DECISÃO RENOVAÇÃO</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 48</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Filtro: status renovação</span>
          <span class="tag tag-tipo">CONDICIONAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Confirmação status
        </div>
        <div class="msg-text">
          SE RENOVOU: &#x27;Que alegria saber que você continua conosco! 🎉 Seus próximos 12 meses serão ainda mais incríveis!&#x27; | SE NÃO RENOVOU: Migrar para RÉGUA DE ENCERRAMENTO
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('SE RENOVOU: \'Que alegria saber que você continua conosco! 🎉 Seus próximos 12 meses serão ainda mais incríveis!\' | SE NÃO RENOVOU: Migrar para RÉGUA DE ENCERRAMENTO')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ PONTO DE DECISÃO: CRM deve ter flag \'RENOVADO=SIM/NÃO\'. Se SIM → continua régua principal. Se NÃO → ativa régua encerramento')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 9 - Ano 2 - Fluência ═══
  html += `
    <div class="phase phase-fase-11">
      <div class="phase-header">
        <div class="phase-title">Fase 9 - Ano 2 - Fluência</div>
        <div class="phase-badge">14 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 52</div>
            <div class="msg-title">Dica Imersão</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 52</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Imersão total
        </div>
        <div class="msg-text">
          🌍 Dica avançada: Tente pensar em inglês durante tarefas simples. É o próximo nível de imersão!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🌍 Dica avançada: Tente pensar em inglês durante tarefas simples. É o próximo nível de imersão!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Fluência mental')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 53</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo módulo
        </div>
        <div class="msg-text">
          Bom dia! Novo mês chegando com aulas incríveis preparadas pra você 🚀
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Bom dia! Novo mês chegando com aulas incríveis preparadas pra você 🚀')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Padrão mensal')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 54</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-11-gatilho-54')">
            <span id="icon-fase-11-gatilho-54">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 54</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-11-gatilho-54">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, você começou o segundo ano com tudo! 🚀 Continue com essa energia incrível!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, você começou o segundo ano com tudo! 🚀 Continue com essa energia incrível!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, você está no segundo ano! Vamos fazer ele ser ainda melhor que o primeiro? Te ajudo a reorganizar os horários!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, você está no segundo ano! Vamos fazer ele ser ainda melhor que o primeiro? Te ajudo a reorganizar os horários!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! Você tem mais 12 meses de curso pela frente. Vamos aproveitar esse tempo? Te ajudo a começar!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Você tem mais 12 meses de curso pela frente. Vamos aproveitar esse tempo? Te ajudo a começar!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 56</div>
            <div class="msg-title">Quiz Expressões</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 56</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Idioms
        </div>
        <div class="msg-text">
          💬 What does &#x27;piece of cake&#x27; mean? (a) difícil (b) fácil (c) doce. Responde!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('💬 What does \'piece of cake\' mean? (a) difícil (b) fácil (c) doce. Responde!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Expressões idiomáticas')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 57</div>
            <div class="msg-title">Dica Avançada</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 57</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Refinamento
        </div>
        <div class="msg-text">
          📖 Já tentou ler um livro inteiro em inglês? Escolha algo que você ama. A fluência vem naturalmente!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('📖 Já tentou ler um livro inteiro em inglês? Escolha algo que você ama. A fluência vem naturalmente!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Desafio literário')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 60</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-11-gatilho-60')">
            <span id="icon-fase-11-gatilho-60">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 60</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-11-gatilho-60">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">15 meses de consistência! 🏆 {{nomedoaluno}}, você está construindo fluência tijolo por tijolo!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('15 meses de consistência! 🏆 {{nomedoaluno}}, você está construindo fluência tijolo por tijolo!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, sinto que você pode aproveitar muito mais o curso. Vamos conversar sobre como aumentar sua frequência?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, sinto que você pode aproveitar muito mais o curso. Vamos conversar sobre como aumentar sua frequência?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, sinto que você está perdendo uma oportunidade incrível. Vamos conversar sobre como te ajudar a iniciar?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, sinto que você está perdendo uma oportunidade incrível. Vamos conversar sobre como te ajudar a iniciar?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 61</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo ciclo
        </div>
        <div class="msg-text">
          Olá! Mais um mês iniciando, mais conteúdo novo nas aulas ao vivo 💙
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Olá! Mais um mês iniciando, mais conteúdo novo nas aulas ao vivo 💙')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Mensagem padrão')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 63</div>
            <div class="msg-title">Milestone 16 Meses</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Mês 16</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Celebração</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Persistência
        </div>
        <div class="msg-text">
          16 meses de jornada! 🌟 Você está no caminho certo. Fluência é questão de tempo agora!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('16 meses de jornada! 🌟 Você está no caminho certo. Fluência é questão de tempo agora!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Reconhecimento')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 64</div>
            <div class="msg-title">Quiz Listening</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 64</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Compreensão
        </div>
        <div class="msg-text">
          🎧 Você tem conseguido entender filmes em inglês sem legenda? (a) Sim (b) Às vezes (c) Ainda não
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🎧 Você tem conseguido entender filmes em inglês sem legenda? (a) Sim (b) Às vezes (c) Ainda não')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Auto-avaliação')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 60+</div>
            <div class="msg-title">⭐ Lembrete Checkpoint</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 18 do mês (~17,5 meses)</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos ~17,5 meses</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Lembrar do teste oficial
        </div>
        <div class="msg-text">
          Olá [Nome]! 📊 Mais um Checkpoint Trimestral disponível pra você! Mostre sua evolução: 70+ pontos = certificado + novo nível. Liberado até dia 27! 💪
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Olá [Nome]! 📊 Mais um Checkpoint Trimestral disponível pra você! Mostre sua evolução: 70+ pontos = certificado + novo nível. Liberado até dia 27! 💪')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ Checkpoint oficial')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 10 - Refinamento ═══
  html += `
    <div class="phase phase-fase-12">
      <div class="phase-header">
        <div class="phase-title">Fase 10 - Refinamento</div>
        <div class="phase-badge">14 mensagens</div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 66</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-12-gatilho-66')">
            <span id="icon-fase-12-gatilho-66">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 66</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-12-gatilho-66">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, você é prova viva de que dedicação traz resultados! 💙 18 meses de excelência!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, você é prova viva de que dedicação traz resultados! 💙 18 meses de excelência!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! Faltam poucos meses e quero muito ver você aproveitando ao máximo. Podemos ajustar algo?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Faltam poucos meses e quero muito ver você aproveitando ao máximo. Podemos ajustar algo?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">Oi {{nomedoaluno}}! Ainda dá tempo de aproveitar seu curso. Me conta: o que posso fazer pra você começar?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Oi {{nomedoaluno}}! Ainda dá tempo de aproveitar seu curso. Me conta: o que posso fazer pra você começar?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 67</div>
            <div class="msg-title">Dica Profissional</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 67</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Aplicação prática
        </div>
        <div class="msg-text">
          💼 Dica: Use inglês no trabalho sempre que possível. Emails, apresentações... Cada oportunidade conta!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('💼 Dica: Use inglês no trabalho sempre que possível. Emails, apresentações... Cada oportunidade conta!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Contexto profissional')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 69</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo módulo
        </div>
        <div class="msg-text">
          Bom dia! Novo mês de aprendizado começando 🚀
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Bom dia! Novo mês de aprendizado começando 🚀')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Padrão mensal')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 70</div>
            <div class="msg-title">Quiz Avançado</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 70</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Desafio
        </div>
        <div class="msg-text">
          🧠 Advanced quiz! &#x27;Neither John ___ Mary came to the party.&#x27; (a) or (b) nor (c) and
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🧠 Advanced quiz! \'Neither John ___ Mary came to the party.\' (a) or (b) nor (c) and')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Gramática complexa')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 72</div>
            <div class="msg-title">Milestone 18 Meses</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Mês 18</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Celebração</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Marco 1,5 ano
        </div>
        <div class="msg-text">
          1 ano e meio! 🎉 Sua evolução é inspiradora. Continue firme nos estudos!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('1 ano e meio! 🎉 Sua evolução é inspiradora. Continue firme nos estudos!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Celebração intermediária')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 73</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-12-gatilho-73')">
            <span id="icon-fase-12-gatilho-73">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 73</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-12-gatilho-73">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, faltam poucos meses! 🎯 Sua frequência impecável te trouxe até aqui. Não pare agora!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, faltam poucos meses! 🎯 Sua frequência impecável te trouxe até aqui. Não pare agora!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, você está na reta final! Vamos fazer um esforço juntos pra você terminar com chave de ouro?</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, você está na reta final! Vamos fazer um esforço juntos pra você terminar com chave de ouro?')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">{{nomedoaluno}}, você ainda tem alguns meses. Vamos fazer valer a pena? Estou aqui pra te ajudar a dar o primeiro passo!</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('{{nomedoaluno}}, você ainda tem alguns meses. Vamos fazer valer a pena? Estou aqui pra te ajudar a dar o primeiro passo!')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 75</div>
            <div class="msg-title">Dica Cultural Avançada</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 75</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Refinamento cultural
        </div>
        <div class="msg-text">
          🎭 Assista stand-up comedy em inglês. Entender humor é sinal de fluência avançada!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🎭 Assista stand-up comedy em inglês. Entender humor é sinal de fluência avançada!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Nível avançado')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 76</div>
            <div class="msg-title">Quiz Expressões 2</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 76</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m + renovados</span>
          <span class="tag tag-tipo">Engajamento</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Idioms avançados
        </div>
        <div class="msg-text">
          &#x27;It&#x27;s raining cats and dogs&#x27; means: (a) chuva forte (b) chuva leve (c) sem chuva
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('\'It\'s raining cats and dogs\' means: (a) chuva forte (b) chuva leve (c) sem chuva')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Expressões')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 77</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Novo ciclo
        </div>
        <div class="msg-text">
          Novo mês chegando! Suas aulas ao vivo continuam com ótimo conteúdo 💙
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Novo mês chegando! Suas aulas ao vivo continuam com ótimo conteúdo 💙')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Mensagem padrão')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 70+</div>
            <div class="msg-title">⭐ Lembrete Checkpoint</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 18 do mês (~21 meses)</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos ~21 meses</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Lembrar do teste oficial
        </div>
        <div class="msg-text">
          E aí, [Nome]! 📊 Checkpoint Trimestral já está no ar! Você está quase na reta final. Bora garantir mais um certificado? 70+ pontos! Até dia 27! 🏆
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('E aí, [Nome]! 📊 Checkpoint Trimestral já está no ar! Você está quase na reta final. Bora garantir mais um certificado? 70+ pontos! Até dia 27! 🏆')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ Checkpoint oficial')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 11 - Reta Final ═══
  html += `
    <div class="phase phase-fase-13">
      <div class="phase-header">
        <div class="phase-title">Fase 11 - Reta Final</div>
        <div class="phase-badge">6 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 84</div>
            <div class="msg-title">Milestone 20+ Meses</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Semana 84</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Somente alunos 24m</span>
          <span class="tag tag-tipo">Celebração</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Reta final
        </div>
        <div class="msg-text">
          Você está na reta final! 🏆 Que jornada incrível até aqui. Continue aproveitando cada aula!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Você está na reta final! 🏆 Que jornada incrível até aqui. Continue aproveitando cada aula!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Alunos 24m próximos conclusão')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 85</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Penúltimo/último mês
        </div>
        <div class="msg-text">
          Olá! Estamos chegando ao final da jornada juntos 💙 Aproveite cada aula!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Olá! Estamos chegando ao final da jornada juntos 💙 Aproveite cada aula!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Tom emocional')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 87</div>
            <div class="msg-title">Dica Pós-Curso</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 87</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m</span>
          <span class="tag tag-tipo">Dica</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Preparação saída
        </div>
        <div class="msg-text">
          🌍 Já pensou em fazer intercâmbio ou viagem internacional? Seu inglês está pronto!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🌍 Já pensou em fazer intercâmbio ou viagem internacional? Seu inglês está pronto!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Aplicação real')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card gatilho-slot">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 90</div>
            <div class="msg-title">🎯 SLOT GATILHO</div>
          </div>
          <button class="toggle-btn" onclick="toggleGatilho('fase-13-gatilho-90')">
            <span id="icon-fase-13-gatilho-90">▼</span> 3 Cenários
          </button>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 90</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="tag tag-gatilho">GATILHO COMPORTAMENTAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Mensagem personalizada baseada na frequência do aluno
        </div>
        <div class="gatilho-cenarios" id="fase-13-gatilho-90">
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <span class="cenario-icon">🟢</span>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença &gt; 55%</div>
              </div>
            </div>
            <div class="cenario-message">Parabéns! Continue firme! 🎉</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Parabéns! Continue firme! 🎉')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 1 - Presença > 55% | Aluno participou de mais de 55% das aulas disponíveis até o momento')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <span class="cenario-icon">🟡</span>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% &lt; Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">Vamos ajustar sua rotina? 😊</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Vamos ajustar sua rotina? 😊')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 2 - 0% < Presença ≤ 55% | Aluno participou de alguma aula, mas tem menos de 55% de presença')">ℹ️</button>
            </div>
          </div>
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <span class="cenario-icon">🔴</span>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">Estou aqui pra te ajudar a começar! 💙</div>
            <div class="msg-actions">
              <button class="copy-btn" onclick="copyMessage('Estou aqui pra te ajudar a começar! 💙')">📋 Copiar</button>
              <button class="info-btn" onclick="showInfo('CENÁRIO 3 - Presença = 0% | Aluno não participou de nenhuma aula até o momento')">ℹ️</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 11 - Período Renovação Final ═══
  html += `
    <div class="phase phase-fase-14">
      <div class="phase-header">
        <div class="phase-title">Fase 11 - Período Renovação Final</div>
        <div class="phase-badge">1 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semanas 78-83</div>
            <div class="msg-title">⚠️ BLACKOUT RENOVAÇÃO 24M</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semanas 78-83</span>
          <span class="meta-item">🚫 SEM ENVIO</span>
          <span class="meta-item">👥 Plano 24 meses</span>
          <span class="tag tag-tipo">PAUSA ESTRATÉGICA</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Espaço para time comercial
        </div>
        <div class="msg-text">
          🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua para alunos de 24 meses próximos da conclusão
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🚫 SUPORTE LIVE NÃO ENVIA MENSAGENS - Time de Renovação atua para alunos de 24 meses próximos da conclusão')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('⚠️ CRÍTICO: Alunos de 24 meses entrando nas últimas semanas. Time comercial aborda para renovação/upgrade/continuidade')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  // ═══ Fase 12 - Conclusão ═══
  html += `
    <div class="phase phase-fase-15">
      <div class="phase-header">
        <div class="phase-title">Fase 12 - Conclusão</div>
        <div class="phase-badge">4 mensagens</div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 92</div>
            <div class="msg-title">Preparação Conclusão</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Semana 92</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m finalizando</span>
          <span class="tag tag-tipo">Operacional</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Certificado/próximos passos
        </div>
        <div class="msg-text">
          Parabéns por chegar até aqui! Em breve você receberá informações sobre seu certificado de conclusão 🎓
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Parabéns por chegar até aqui! Em breve você receberá informações sobre seu certificado de conclusão 🎓')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Informações práticas')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 93</div>
            <div class="msg-title">Início do Mês</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Dia 1 do mês</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Alunos 24m</span>
          <span class="tag tag-tipo">Lembrete</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> Último mês
        </div>
        <div class="msg-text">
          Último mês de jornada formal! 💙 Que orgulho da sua trajetória!
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Último mês de jornada formal! 💙 Que orgulho da sua trajetória!')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Mensagem especial')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 96</div>
            <div class="msg-title">Milestone 2 ANOS</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 ~Mês 24</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Concluintes 24m</span>
          <span class="tag tag-tipo">Celebração ESPECIAL</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> CONCLUSÃO 24 MESES
        </div>
        <div class="msg-text">
          🎉🎓 PARABÉNS! 2 ANOS DE DEDICAÇÃO COMPLETOS! Você transformou completamente seu inglês. Essa conquista é gigante e você deve se orgulhar muito! 🏆
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('🎉🎓 PARABÉNS! 2 ANOS DE DEDICAÇÃO COMPLETOS! Você transformou completamente seu inglês. Essa conquista é gigante e você deve se orgulhar muito! 🏆')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('CELEBRAÇÃO FINAL - NÃO mencionar continuidade')">ℹ️</button>
        </div>
      </div>
      <div class="msg-card">
        <div class="msg-header">
          <div>
            <div class="msg-week">Semana 97</div>
            <div class="msg-title">Pesquisa Satisfação</div>
          </div>
        </div>
        <div class="msg-meta">
          <span class="meta-item">📅 Pós-conclusão +2 dias</span>
          <span class="meta-item">📱 WhatsApp</span>
          <span class="meta-item">👥 Concluintes</span>
          <span class="tag tag-tipo">Feedback</span>
        </div>
        <div class="msg-objetivo">
          <strong>Objetivo:</strong> NPS/Feedback
        </div>
        <div class="msg-text">
          Olá! Gostaríamos muito de saber sobre sua experiência conosco. Pode responder nossa breve pesquisa de satisfação? Sua opinião é muito importante! [link]
        </div>
        <div class="msg-actions">
          <button class="copy-btn" onclick="copyMessage('Olá! Gostaríamos muito de saber sobre sua experiência conosco. Pode responder nossa breve pesquisa de satisfação? Sua opinião é muito importante! [link]')">📋 Copiar</button>
          <button class="info-btn" onclick="showInfo('Coleta NPS - SEM mencionar renovação')">ℹ️</button>
        </div>
      </div>
    </div>
  `;
  
  container.innerHTML = html;
}

// Funções auxiliares
function toggleGatilho(id) {
  const el = document.getElementById(id);
  const icon = document.getElementById("icon-" + id);
  if (el.style.display === "none") {
    el.style.display = "grid";
    icon.textContent = "▼";
  } else {
    el.style.display = "none";
    icon.textContent = "▶";
  }
}

function copyMessage(text) {
  navigator.clipboard.writeText(text).then(() => {
    // Feedback visual
  }).catch(err => {
    console.error('Erro ao copiar:', err);
  });
}

function showInfo(text) {
  alert(text);
}



// ═══════════════════════════════════════════════════════════
// RENDER GATILHOS
// ═══════════════════════════════════════════════════════════
function renderGatilhos(container) {
  let html = '';
  
  GATILHOS.forEach((gatilho, gIdx) => {
    html += `
      <div class="gatilho-card">
        <div class="card-header">
          <div class="card-title">🎯 ${gatilho.titulo}</div>
          <button class="collapse-btn" onclick="toggleCenarios(${gIdx})" style="background:var(--card-hi);border:1px solid var(--border);border-radius:8px;padding:8px 16px;cursor:pointer;color:var(--txt2);font-size:0.85rem">
            <span id="collapse-icon-${gIdx}">▼</span> Cenários
          </button>
        </div>
        <div class="msg-body">
          <strong>Condição:</strong> ${gatilho.condicao}<br>
          <strong>Canal:</strong> ${gatilho.canal}<br>
          <strong>Horário:</strong> ${gatilho.horario}<br>
          <strong>Objetivo:</strong> ${gatilho.objetivo}
        </div>
        <div class="msg-meta" style="margin-top:12px">
          ${gatilho.tags.map(tag => {
            const tagClass = tag.replace(/\s+/g, '-');
            return `<span class="tag tag-${tagClass}">${tag}</span>`;
          }).join('')}
        </div>
        
        <div class="cenarios-container" id="cenarios-${gIdx}">
          <div class="variant-label" style="margin-top:16px;margin-bottom:12px">
            💬 3 Mensagens - uma para cada cenário de frequência:
          </div>
          
          <!-- Cenário Alta Frequência -->
          <div class="cenario-card cenario-alta">
            <div class="cenario-header">
              <div class="cenario-icon">🟢</div>
              <div>
                <div class="cenario-title">Alta Frequência</div>
                <div class="cenario-condition">Presença > 55%</div>
              </div>
            </div>
            <div class="cenario-message">
              ${gatilho.cenarios.alta}
            </div>
            <button class="copy-btn" onclick="copyTextDirect('${gatilho.cenarios.alta.replace(/'/g, "\\'")}')">📋 Copiar</button>
          </div>
          
          <!-- Cenário Baixa Frequência -->
          <div class="cenario-card cenario-baixa">
            <div class="cenario-header">
              <div class="cenario-icon">🟡</div>
              <div>
                <div class="cenario-title">Baixa Frequência</div>
                <div class="cenario-condition">0% < Presença ≤ 55%</div>
              </div>
            </div>
            <div class="cenario-message">
              ${gatilho.cenarios.baixa}
            </div>
            <button class="copy-btn" onclick="copyTextDirect('${gatilho.cenarios.baixa.replace(/'/g, "\\'")}')">📋 Copiar</button>
          </div>
          
          <!-- Cenário Zero Frequência -->
          <div class="cenario-card cenario-zero">
            <div class="cenario-header">
              <div class="cenario-icon">🔴</div>
              <div>
                <div class="cenario-title">Zero Frequência</div>
                <div class="cenario-condition">Presença = 0%</div>
              </div>
            </div>
            <div class="cenario-message">
              ${gatilho.cenarios.zero}
            </div>
            <button class="copy-btn" onclick="copyTextDirect('${gatilho.cenarios.zero.replace(/'/g, "\\'")}')">📋 Copiar</button>
          </div>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

// Função para colapsar/expandir cenários
function toggleCenarios(gIdx) {
  const container = document.getElementById(`cenarios-${gIdx}`);
  const icon = document.getElementById(`collapse-icon-${gIdx}`);
  
  if (container.style.display === 'none') {
    container.style.display = 'block';
    icon.textContent = '▼';
  } else {
    container.style.display = 'none';
    icon.textContent = '▶';
  }
}

// Função auxiliar para copiar texto diretamente
function copyTextDirect(text) {
  navigator.clipboard.writeText(text).then(() => {
    // Feedback visual (opcional)
    console.log('Texto copiado!');
  });
}

// ═══════════════════════════════════════════════════════════
// RENDER RECUPERAÇÃO
// ═══════════════════════════════════════════════════════════
// ═══════════════════════════════════════════════════════════
// RENDER RECUPERAÇÃO - RÉGUA DE 8 DIAS
// ═══════════════════════════════════════════════════════════

// ═══════════════════════════════════════════════════════════
// RENDER RECUPERAÇÃO - RÉGUA DE 8 DIAS
// ═══════════════════════════════════════════════════════════

// ═══════════════════════════════════════════════════════════
// RENDER RECUPERAÇÃO - RÉGUA DE 8 DIAS
// ═══════════════════════════════════════════════════════════

function renderRecuperacao(container) {
  let html = `
    <!-- Header Explicativo -->
    <div class="recuperacao-header">
      <div class="recuperacao-title">
        <span class="recuperacao-icon">🔄</span>
        <div>
          <h3>Régua de Recuperação - Aluno Não Respondeu Boas-Vindas</h3>
          <p>Protocolo de tentativas de contato quando aluno não responde à mensagem inicial de agendamento da Aula Zero</p>
        </div>
      </div>
    </div>

    <!-- Regras da Régua -->
    <div class="regras-recuperacao">
      <div class="regras-header">
        <span>⚠️</span>
        <strong>Regras da Régua de Recuperação</strong>
      </div>
      <div class="regras-grid">
        <div class="regra-item">
          <div class="regra-icon">📅</div>
          <div class="regra-content">
            <strong>Período Total</strong>
            <span>8 dias de tentativas</span>
          </div>
        </div>
        
        <div class="regra-item">
          <div class="regra-icon">🎯</div>
          <div class="regra-content">
            <strong>Dias 1-3</strong>
            <span>1 tentativa/dia (gentil)</span>
          </div>
        </div>
        
        <div class="regra-item">
          <div class="regra-icon">⚡</div>
          <div class="regra-content">
            <strong>Dias 4-6</strong>
            <span>2 tentativas/dia (urgência)</span>
          </div>
        </div>
        
        <div class="regra-item">
          <div class="regra-icon">🚨</div>
          <div class="regra-content">
            <strong>Dias 7-8</strong>
            <span>3 tentativas/dia (última chance)</span>
          </div>
        </div>
        
        <div class="regra-item">
          <div class="regra-icon">📱</div>
          <div class="regra-content">
            <strong>Canais</strong>
            <span>WhatsApp, Ligação, Email</span>
          </div>
        </div>
        
        <div class="regra-item">
          <div class="regra-icon">🕐</div>
          <div class="regra-content">
            <strong>Horários</strong>
            <span>Manhã (9h-11h), Tarde (14h-16h), Noite (19h-20h)</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Timeline de Recuperação -->
    <div class="recuperacao-timeline">
  `;

  // DADOS DA RÉGUA
  const recuperacao_dados = [
    {
      dia: "Dia 1",
      fase: "Abordagem Gentil",
      tentativas: 1,
      horario: "Manhã (10h)",
      canal: "📱 WhatsApp",
      variantes: [
        "Oi [Nome], tudo bem? 😊 Passei aqui pra confirmar se conseguiu ver minha mensagem de ontem! Preciso agendar sua instrução para liberarmos seu documento oficial de assinatura. Consegue hoje? Me manda o melhor horário pra você!",
        "Oi [Nome]! Vi que ainda não conseguimos agendar. Você está recebendo minhas mensagens? Me confirma quando você consegue um tempinho pra gente fazer a instrução rápida! 😊",
        "Olá [Nome]! Preciso agendar sua Aula Zero urgente pra liberar o documento. Você está vendo essas mensagens? Quando você pode?"
      ]
    },
    {
      dia: "Dia 2",
      fase: "Abordagem Gentil",
      tentativas: 1,
      horario: "Tarde (15h)",
      canal: "📱 WhatsApp",
      variantes: [
        "Oi [Nome]! Vamos agendar sua instrução? 😊 É nela que libero seu documento de assinatura e te mostro como aproveitar a plataforma da melhor forma. Prometo que é rápido! Consegue hoje às [horário] ou [horário]?",
        "Oi [Nome], tudo certo? Ainda preciso fazer sua instrução pra liberar tudo certinho. São só 10 minutinhos! Que tal hoje à tarde? Me fala um horário bom!",
        "[Nome], oi! Tô passando aqui de novo pra ver se hoje rola de fazer a instrução. É super rápida e importante! Me confirma?"
      ]
    },
    {
      dia: "Dia 3",
      fase: "Abordagem Gentil",
      tentativas: 1,
      horario: "Manhã (11h)",
      canal: "🎤 Áudio + 📱 WhatsApp",
      variantes: [
        "🎤 [ÁUDIO] Oii, tudo bem? Consegue hoje às [horário] (horário de Brasília) para realizarmos a liberação do seu documento e verificação via Zoom?\n\n📱 [TEXTO] Caso precise ajustar o horário, posso tentar encaixar conforme sua disponibilidade. Me avisa por aqui? 😊",
        "🎤 [ÁUDIO] Oi [Nome]! Tô tentando te alcançar há alguns dias. Preciso fazer sua instrução pra liberar o documento. Me responde quando puder, por favor!\n\n📱 [TEXTO] Qualquer horário que funcione pra você, me avisa!",
        "🎤 [ÁUDIO] [Nome], oi! É a Cecilia. Tô precisando agendar sua instrução. É rapidinho, prometo! Me retorna?\n\n📱 [TEXTO] Pode ser qualquer horário que seja bom pra você! 💙"
      ]
    },
    {
      dia: "Dia 4",
      fase: "Aumenta Urgência",
      tentativas: 2,
      horario: "Manhã (10h) + Tarde (16h)",
      canal: "📱 WhatsApp / 🎤 Áudio",
      variantes: [
        "Oii [Nome]! Tudo bem por aí? 😊 Imagino que a correria do dia a dia esteja grande… Mas assim que fizermos essa instrução, já deixamos tudo certo. 🎤 [ÁUDIO] Estou te chamando de novo só pra garantir que você não perca a etapa da liberação de documento.",
        "[Nome], sei que você deve estar super ocupado(a), mas é importante a gente fazer essa instrução. São só 10min! Qualquer horário que funcione pra você, tô disponível! Me retorna? 🙏",
        "Oi [Nome]! Tentativa da tarde. Preciso muito fazer sua instrução. Quando você consegue? Qualquer horário! Estou aqui esperando seu retorno. 💙"
      ]
    },
    {
      dia: "Dia 5",
      fase: "Aumenta Urgência",
      tentativas: 2,
      horario: "Manhã (9h) + Tarde (15h)",
      canal: "📱 WhatsApp / 🎤 Áudio",
      variantes: [
        "Bom dia [Nome]! Continuamos tentando te alcançar. A instrução é importante pra conclusão da sua assinatura. Pode me retornar com um horário bom pra você? Obrigada! 😊",
        "[Nome], boa tarde! Sei que já mandei várias mensagens, mas é porque realmente preciso fazer sua instrução. Me ajuda aqui? Qualquer horário serve! 🙏",
        "🎤 [ÁUDIO] Oi [Nome], desculpa as várias tentativas. Mas sem essa instrução não consigo liberar seu documento e você não consegue avançar. Por favor, me retorna! É rapidinho!\n\n📱 [TEXTO] Aguardo seu contato! 💙"
      ]
    },
    {
      dia: "Dia 6",
      fase: "Aumenta Urgência",
      tentativas: 2,
      horario: "Manhã (10h) + Noite (19h)",
      canal: "📱 WhatsApp / 🎤 Áudio",
      variantes: [
        "Bom dia [Nome]! Estamos chegando ao final do período de tentativas. A instrução é essencial pra você conseguir avançar no curso. Me retorna com um horário? 🙏",
        "Oi [Nome], boa noite! Tentando de novo. Realmente preciso fazer essa instrução com você. São só 10 minutinhos! Quando você pode? 😊",
        "🎤 [ÁUDIO] [Nome], último dia antes da fase final. Preciso muito que você me retorne pra gente fazer essa instrução. É super rápido!\n\n📱 [TEXTO] Por favor, me ajuda! Qualquer horário serve! 💙"
      ]
    },
    {
      dia: "Dia 7",
      fase: "Última Chance",
      tentativas: 3,
      horario: "Manhã (9h) + Tarde (15h) + Noite (19h)",
      canal: "📞 Ligação + 📱 WhatsApp + 📧 Email",
      variantes: [
        "🚨 [LIGAÇÃO] Tentativa de contato direto via telefone.\n\n📱 [SE NÃO ATENDER] Oi [Nome], tentei te ligar. Essa é nossa última semana de tentativas. Preciso URGENTE fazer sua instrução. Me retorna, por favor! 🙏",
        "Oi [Nome], estamos na reta final das tentativas. Sem a instrução, não consigo liberar seu documento e você não consegue avançar no curso. Por favor, me ajuda aqui! Quando você pode? 🙏",
        "📧 [EMAIL] Prezado(a) [Nome], tentamos contato através de diversos canais nos últimos 7 dias para realizar sua instrução obrigatória. Sem ela, não é possível liberar seu documento de assinatura. Por favor, retorne com um horário. Atenciosamente, Cecilia - CS Wise Up"
      ]
    },
    {
      dia: "Dia 8",
      fase: "Encerramento",
      tentativas: 3,
      horario: "Manhã (10h) + Tarde (14h) + Noite (19h)",
      canal: "📞 Ligação + 📱 WhatsApp + 📧 Email",
      variantes: [
        "🚨 [LIGAÇÃO FINAL] Última tentativa de contato telefônico.\n\n📱 [SE NÃO ATENDER] [Nome], essa é a última tentativa oficial. Fizemos várias tentativas nos últimos 8 dias. Se precisar de suporte ou quiser retomar, é só me chamar. Caso contrário, vou entender que você não pode dar seguimento agora. Mas saiba que estou aqui! 💙",
        "Oi [Nome], último dia de tentativas. Foram 8 dias tentando te alcançar. Se você quiser retomar o curso a qualquer momento, estarei aqui pra te ajudar! Apenas me chame. Caso contrário, vou respeitar sua decisão. Desejo tudo de bom! 🙏",
        "📧 [EMAIL FORMAL] Prezado(a) [Nome],\n\nTentamos contato através de WhatsApp, ligações e email nos últimos 8 dias para realizar sua instrução obrigatória. Infelizmente, sem ela, não é possível dar continuidade ao curso.\n\nSe houver interesse em retomar, estamos à disposição. Entre em contato quando quiser.\n\nAtenciosamente,\nCecilia - Customer Success\nWise Up Online"
      ]
    }
  ];

  // Renderizar cada dia
  recuperacao_dados.forEach((dia, index) => {
    html += `
      <div class="rec-day-card">
        <div class="rec-day-header">
          <div class="rec-day-info">
            <div class="rec-day-number">${dia.dia}</div>
            <div class="rec-day-details">
              <div class="rec-fase ${dia.fase.toLowerCase().replace(/ /g, '-')}">${dia.fase}</div>
              <div class="rec-meta">
                <span class="rec-tentativas">${dia.tentativas} tentativa${dia.tentativas > 1 ? 's' : ''}</span>
                <span class="rec-separator">•</span>
                <span class="rec-horario">${dia.horario}</span>
                <span class="rec-separator">•</span>
                <span class="rec-canal">${dia.canal}</span>
              </div>
            </div>
          </div>
          <button class="rec-expand-btn" onclick="toggleRecDay(${index})">
            <span id="rec-icon-${index}">▼</span>
          </button>
        </div>
        
        <div class="rec-day-content" id="rec-day-${index}">
          <div class="rec-variantes-header">
            <span class="variantes-icon">💬</span>
            <span class="variantes-title">Escolha uma das 3 variantes de mensagem:</span>
          </div>
          
          <div class="rec-variantes-grid">
    `;
    
    // Renderizar as 3 variantes
    dia.variantes.forEach((variante, vIndex) => {
      html += `
        <div class="rec-variante-card">
          <div class="rec-variante-header">
            <span class="variante-number">Opção ${vIndex + 1}</span>
            <div class="rec-variante-actions">
              <button class="action-btn" onclick="copyToClipboard(\`${variante.replace(/`/g, '\\`').replace(/'/g, "\\'").replace(/\n/g, '\\n')}\`)" title="Copiar mensagem">
                📋
              </button>
            </div>
          </div>
          <div class="rec-variante-text">${variante.replace(/\n/g, '<br>')}</div>
        </div>
      `;
    });
    
    html += `
          </div>
        </div>
      </div>
    `;
  });

  html += `
    </div>

    <!-- Próximos Passos (Compacto) -->
    <div class="proximos-passos-compact">
      <div class="passos-header-compact">
        <span class="passos-icon">✅</span>
        <strong>O que fazer após os 8 dias?</strong>
      </div>
      
      <div class="passos-grid-compact">
        <!-- NÃO Respondeu -->
        <div class="passo-compact passo-danger">
          <div class="passo-icon-compact">🚫</div>
          <div class="passo-content-compact">
            <div class="passo-title-compact">NÃO Respondeu</div>
            <div class="passo-actions-compact">
              • Marcar "INACESSÍVEL" no <a href="https://shuri.wisereducacao.com/" target="_blank" class="link-mercury">Mercury</a><br>
              • Enviar para Auditoria
            </div>
          </div>
        </div>

        <!-- Respondeu sem confirmar -->
        <div class="passo-compact passo-warning">
          <div class="passo-icon-compact">⏰</div>
          <div class="passo-content-compact">
            <div class="passo-title-compact">Respondeu mas não agendou</div>
            <div class="passo-actions-compact">
              • Retomar agendamento<br>
              • Ser mais flexível com horários
            </div>
          </div>
        </div>

        <!-- REALIZOU Aula Zero -->
        <div class="passo-compact passo-success">
          <div class="passo-icon-compact">🎉</div>
          <div class="passo-content-compact">
            <div class="passo-title-compact">REALIZOU Aula Zero - Sucesso!</div>
            <div class="passo-actions-compact">
              • Anotar CRM: <code>"Onboarding OK"</code><br>
              • Entrar na Régua Principal (Semana 2)<br>
              • Check-in extra no dia 3 após aula
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  
  container.innerHTML = html;
}

// Função para expandir/colapsar dia
function toggleRecDay(index) {
  const content = document.getElementById(`rec-day-${index}`);
  const icon = document.getElementById(`rec-icon-${index}`);
  
  if (content.style.maxHeight && content.style.maxHeight !== '0px') {
    content.style.maxHeight = '0px';
    icon.textContent = '▼';
  } else {
    content.style.maxHeight = content.scrollHeight + 'px';
    icon.textContent = '▲';
  }
}


function toggleRecDay(index) {
  const content = document.getElementById(`rec-day-${index}`);
  const icon = document.getElementById(`rec-icon-${index}`);
  
  if (content.style.maxHeight && content.style.maxHeight !== '0px') {
    content.style.maxHeight = '0px';
    icon.textContent = '▼';
  } else {
    content.style.maxHeight = content.scrollHeight + 'px';
    icon.textContent = '▲';
  }
}


function toggleRecDay(index) {
  const content = document.getElementById(`rec-day-${index}`);
  const icon = document.getElementById(`rec-icon-${index}`);
  
  if (content.style.maxHeight && content.style.maxHeight !== '0px') {
    content.style.maxHeight = '0px';
    icon.textContent = '▼';
  } else {
    content.style.maxHeight = content.scrollHeight + 'px';
    icon.textContent = '▲';
  }
}


function selectVariant(key, index) {
  selectedVariants[key] = index;
  // Re-render current view to update UI
  const activeView = document.querySelector('.filter-btn.active').dataset.view;
  renderTimeline(activeView);
}

// ═══════════════════════════════════════════════════════════
// COPY TEXT
// ═══════════════════════════════════════════════════════════
function copyText(btn, id) {
  const textElement = btn.parentElement;
  const text = textElement.textContent.replace('📋 Copiar', '').replace('✓ Copiado!', '').trim();
  
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = '✓ Copiado!';
    btn.classList.add('copied');
    setTimeout(() => {
      btn.textContent = '📋 Copiar';
      btn.classList.remove('copied');
    }, 2000);
  }).catch(err => {
    console.error('Erro ao copiar:', err);
  });
}

// ═══════════════════════════════════════════════════════════
// EXCEL EXPORT FUNCTION
// ═══════════════════════════════════════════════════════════
function exportToExcel() {
  const data = [];
  
  // Add header
  data.push(['Fase', 'Canal', 'Tag(s)', 'Mensagem/Título', 'Data/Timing', 'Objetivo', 'Texto Completo']);
  
  // Add Fases data
  MENSAGENS_FASES.forEach(fase => {
    fase.mensagens.forEach(msg => {
      data.push([
        fase.nome,
        msg.canal,
        msg.tags.join(', '),
        msg.titulo,
        msg.timing,
        msg.objetivo,
        msg.texto
      ]);
    });
  });
  
  // Add separator
  data.push(['', '', '', '', '', '', '']);
  data.push(['=== GATILHOS ===', '', '', '', '', '', '']);
  data.push(['', '', '', '', '', '', '']);
  
  // Add Gatilhos data
  GATILHOS.forEach(gatilho => {
    gatilho.variantes.forEach((variante, idx) => {
      data.push([
        'Gatilho',
        gatilho.canal,
        gatilho.tags.join(', '),
        `${gatilho.titulo} - Variante ${idx + 1}`,
        gatilho.condicao,
        gatilho.objetivo,
        variante
      ]);
    });
  });
  
  // Add separator
  data.push(['', '', '', '', '', '', '']);
  data.push(['=== RECUPERAÇÃO ===', '', '', '', '', '', '']);
  data.push(['', '', '', '', '', '', '']);
  
  // Add Recuperação data
  RECUPERACAO.forEach(rec => {
    rec.variantes.forEach((variante, idx) => {
      data.push([
        'Recuperação',
        rec.canal,
        rec.tags.join(', '),
        `${rec.dia} - ${rec.tentativa} - Variante ${idx + 1}`,
        rec.horario,
        'Reengajamento de usuário inativo',
        variante
      ]);
    });
  });
  
  // Create workbook
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(data);
  
  // Set column widths
  ws['!cols'] = [
    { wch: 30 },  // Fase
    { wch: 20 },  // Canal
    { wch: 25 },  // Tags
    { wch: 35 },  // Mensagem/Título
    { wch: 25 },  // Data/Timing
    { wch: 40 },  // Objetivo
    { wch: 80 }   // Texto Completo
  ];
  
  XLSX.utils.book_append_sheet(wb, ws, "Régua de Comunicação");
  
  // Generate filename with date
  const today = new Date();
  const filename = `Regua_CS_WiseUp_${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}.xlsx`;
  
  // Download
  XLSX.writeFile(wb, filename);
}

// ═══════════════════════════════════════════════════════════
// SUMMARY / RESUMO FUNCTIONS
// ═══════════════════════════════════════════════════════════
// ═══════════════════════════════════════════════════════════
// RENDER RESUMO ATUALIZADO COM ANÁLISE DE VOLUME
// ═══════════════════════════════════════════════════════════

// ═══════════════════════════════════════════════════════════
// DASHBOARD DE ANÁLISE - VISUALIZAÇÃO SEMANAL
// ═══════════════════════════════════════════════════════════

function renderResumo() {
  const container = document.getElementById('resumo');
  
  let html = `
    <!-- Hero Section -->
    <div class="hero-section">
      <h2>📊 Dashboard de Análise de Comunicação</h2>
      <p>Visualização completa do volume de mensagens semana por semana ao longo de 24 meses</p>
      
      <div class="hero-highlights">
        <div class="highlight-item">
          <div class="highlight-icon">📨</div>
          <div class="highlight-label">Total Mensagens Régua</div>
          <div class="highlight-value">61</div>
        </div>
        <div class="highlight-item">
          <div class="highlight-icon">⚡</div>
          <div class="highlight-label">Pico Máximo</div>
          <div class="highlight-value">3/sem</div>
        </div>
        <div class="highlight-item">
          <div class="highlight-icon">📈</div>
          <div class="highlight-label">Média (Exemplar)</div>
          <div class="highlight-value">1.0/sem</div>
        </div>
        <div class="highlight-item">
          <div class="highlight-icon">🔴</div>
          <div class="highlight-label">Média (Pior Caso)</div>
          <div class="highlight-value">1.7/sem</div>
        </div>
      </div>
    </div>

    <!-- GRÁFICO PRINCIPAL: Mensagens por Semana -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        <span>📈 Gráfico: Mensagens por Semana (24 meses completos)</span>
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="chart-description">
          Visualize EXATAMENTE quantas mensagens o aluno recebe em cada semana, considerando:
          <strong>Régua Principal + Feriados + Renovação + Cobranças (se inadimplente)</strong>
        </div>
        
        <div class="scenario-selector">
          <button class="scenario-btn active" data-scenario="exemplar" onclick="toggleScenario('exemplar')">
            🟢 Aluno Exemplar (Adimplente)
          </button>
          <button class="scenario-btn" data-scenario="inadimplente" onclick="toggleScenario('inadimplente')">
            🔴 Aluno Inadimplente (Pior Caso)
          </button>
          <button class="scenario-btn" data-scenario="comparacao" onclick="toggleScenario('comparacao')">
            📊 Comparar Cenários
          </button>
        </div>
        
        <div class="chart-container-large">
          <canvas id="chartSemanaASemana"></canvas>
        </div>
        
        <div class="chart-info">
          <div class="info-card">
            <div class="info-icon">💡</div>
            <div class="info-text">
              <strong>Como ler:</strong> Cada ponto representa UMA semana. 
              A altura mostra quantas mensagens o aluno receberá naquela semana específica.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Distribuição de Frequência -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        <span>📊 Distribuição: Quantas Semanas com X Mensagens?</span>
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="chart-description">
          Entenda a frequência: em quantas semanas o aluno recebe 0, 1, 2, 3+ mensagens?
        </div>
        
        <div class="distribution-grid">
          <div class="dist-column">
            <div class="dist-header">
              <span class="dist-icon">🟢</span>
              <span class="dist-title">Aluno Exemplar</span>
            </div>
            <div class="chart-container-medium">
              <canvas id="chartDistExemplar"></canvas>
            </div>
            <div class="dist-stats">
              <div class="dist-stat">
                <span>Pico máximo:</span>
                <strong>3 msgs/semana</strong>
              </div>
              <div class="dist-stat">
                <span>Média:</span>
                <strong>1.02 msgs/semana</strong>
              </div>
              <div class="dist-stat highlight">
                <span>68.7% das semanas:</span>
                <strong>1 mensagem apenas</strong>
              </div>
            </div>
          </div>
          
          <div class="dist-column">
            <div class="dist-header">
              <span class="dist-icon">🔴</span>
              <span class="dist-title">Aluno Inadimplente</span>
            </div>
            <div class="chart-container-medium">
              <canvas id="chartDistInadimplente"></canvas>
            </div>
            <div class="dist-stats">
              <div class="dist-stat">
                <span>Pico máximo:</span>
                <strong>3 msgs/semana</strong>
              </div>
              <div class="dist-stat">
                <span>Média:</span>
                <strong>1.72 msgs/semana</strong>
              </div>
              <div class="dist-stat highlight">
                <span>58.6% das semanas:</span>
                <strong>2 mensagens</strong>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Análise de Picos -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        <span>⚡ Análise de Picos de Comunicação</span>
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="peaks-analysis">
          <div class="peak-insight">
            <div class="peak-insight-header">
              <span class="peak-insight-icon">✅</span>
              <span class="peak-insight-title">Ótima Notícia!</span>
            </div>
            <div class="peak-insight-body">
              <p><strong>Zero semanas com 4+ mensagens</strong> em ambos os cenários!</p>
              <p>A régua está bem equilibrada. Mesmo no pior caso (aluno inadimplente), 
              o máximo é 3 mensagens/semana, o que mantém a comunicação respeitosa.</p>
            </div>
          </div>
          
          <div class="peak-breakdown">
            <div class="peak-breakdown-title">Quando Ocorrem os Picos de 3 Mensagens?</div>
            
            <div class="peak-scenarios">
              <div class="peak-scenario">
                <div class="peak-scenario-header">
                  <span>🟢 Aluno Exemplar</span>
                  <span class="peak-count">1 semana apenas (1.0%)</span>
                </div>
                <div class="peak-scenario-detail">
                  Quando há <strong>sobreposição rara</strong> de:
                  Régua + Feriado + Renovação na mesma semana
                </div>
              </div>
              
              <div class="peak-scenario alert">
                <div class="peak-scenario-header">
                  <span>🔴 Aluno Inadimplente</span>
                  <span class="peak-count">8 semanas (8.1%)</span>
                </div>
                <div class="peak-scenario-detail">
                  Quando há <strong>sobreposição</strong> de:
                  Régua + Feriado/Renovação + Cobrança
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Resumo Executivo -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        <span>📋 Resumo Executivo</span>
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="executive-summary">
          <div class="exec-card">
            <div class="exec-number">61</div>
            <div class="exec-label">Mensagens Programadas</div>
            <div class="exec-detail">Régua principal ao longo de 24 meses (99 semanas)</div>
          </div>
          
          <div class="exec-card">
            <div class="exec-number">13</div>
            <div class="exec-label">Gatilhos Comportamentais</div>
            <div class="exec-detail">Cada um com 3 variantes (Alta/Baixa/Zero Frequência)</div>
          </div>
          
          <div class="exec-card">
            <div class="exec-number">38</div>
            <div class="exec-label">Semanas Livres</div>
            <div class="exec-detail">38.4% do tempo sem envios - evita sobrecarga</div>
          </div>
          
          <div class="exec-card">
            <div class="exec-number">~24</div>
            <div class="exec-label">Feriados/Ano</div>
            <div class="exec-detail">Comunicações de datas comemorativas</div>
          </div>
          
          <div class="exec-card">
            <div class="exec-number">~36</div>
            <div class="exec-label">Cobranças/Ano</div>
            <div class="exec-detail">Apenas para inadimplentes (3 msgs/mês)</div>
          </div>
          
          <div class="exec-card">
            <div class="exec-number">~16</div>
            <div class="exec-label">Msgs Renovação</div>
            <div class="exec-detail">8 msgs em cada período de renovação (2 períodos)</div>
          </div>
        </div>
        
        <div class="exec-conclusion">
          <div class="conclusion-title">🎯 Conclusão Estratégica</div>
          <div class="conclusion-text">
            A régua de comunicação está <strong>bem balanceada</strong>:
            <ul>
              <li>✅ <strong>Aluno exemplar</strong>: recebe em média apenas 1 mensagem/semana</li>
              <li>✅ <strong>Mesmo inadimplente</strong>: média de 1.7 msgs/semana - não invasivo</li>
              <li>✅ <strong>Zero picos extremos</strong>: máximo de 3 msgs/semana em situações raras</li>
              <li>✅ <strong>38% de descanso</strong>: semanas sem nenhuma comunicação</li>
            </ul>
            <strong>Recomendação:</strong> A régua atual está aprovada. Monitorar taxa de opt-out 
            e ajustar apenas se houver feedback negativo dos alunos.
          </div>
        </div>
      </div>
    </div>

    <!-- Insights e Ações -->
    <div class="summary-section">
      <div class="summary-title" onclick="toggleSection(this)">
        <span>💡 Insights e Próximas Ações</span>
        <span class="summary-toggle">▼</span>
      </div>
      <div class="summary-content">
        <div class="insights-grid">
          <div class="insight-card insight-success">
            <div class="insight-icon">✅</div>
            <div class="insight-content">
              <div class="insight-title">Comunicação Não-Invasiva</div>
              <div class="insight-text">
                Com média de 1-1.7 msgs/semana, a comunicação é respeitosa e não sobrecarrega o aluno.
                A maioria das semanas (68.7%) tem apenas 1 mensagem.
              </div>
            </div>
          </div>
          
          <div class="insight-card insight-info">
            <div class="insight-icon">📊</div>
            <div class="insight-content">
              <div class="insight-title">Monitoramento Recomendado</div>
              <div class="insight-text">
                Acompanhar taxa de opt-out por tipo de mensagem. Meta: < 2% de descadastramento.
                Se ultrapassar, reduzir feriados ou ajustar frequência de cobranças.
              </div>
            </div>
          </div>
          
          <div class="insight-card insight-warning">
            <div class="insight-icon">⚠️</div>
            <div class="insight-content">
              <div class="insight-title">Atenção: Período de Renovação</div>
              <div class="insight-text">
                Semanas 41-48 e 78-85 têm aumento de mensagens. Coordenar com time comercial 
                para evitar comunicações conflitantes.
              </div>
            </div>
          </div>
          
          <div class="insight-card insight-action">
            <div class="insight-icon">🎯</div>
            <div class="insight-content">
              <div class="insight-title">Próxima Ação: A/B Test</div>
              <div class="insight-text">
                Testar 2 grupos: um recebe feriados, outro não. Comparar engajamento e 
                taxa de conversão para validar se mensagens de feriado agregam valor.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  
  container.innerHTML = html;
  
  // Renderizar gráficos após inserir HTML
  setTimeout(() => {
    renderGraficoSemanaASemana('exemplar');
    renderGraficoDistribuicao();
  }, 100);
}

// Estado global para o gráfico principal
let chartSemanaASemana = null;
let currentScenario = 'exemplar';

function toggleScenario(scenario) {
  // Atualizar botões
  document.querySelectorAll('.scenario-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  document.querySelector(`[data-scenario="${scenario}"]`).classList.add('active');
  
  // Atualizar gráfico
  currentScenario = scenario;
  renderGraficoSemanaASemana(scenario);
}

function renderGraficoSemanaASemana(scenario) {
  const ctx = document.getElementById('chartSemanaASemana');
  if (!ctx) return;
  
  // Destruir gráfico anterior se existir
  if (chartSemanaASemana) {
    chartSemanaASemana.destroy();
  }
  
  // Dados: semanas 0-98
  const semanas = Array.from({length: 99}, (_, i) => i);
  
  // Semanas com mensagens da régua
  const semanas_regua = [0,2,3,4,6,7,8,9,10,12,13,15,17,18,20,21,23,24,26,27,29,30,32,33,35,36,37,39,40,41,48,49,50,52,53,54,56,57,60,61,63,64,66,67,69,70,72,73,75,76,77,78,84,85,87,90,92,93,96,97,98];
  const feriados = [1,8,13,16,19,22,26,30,34,39,43,47,53,60,65,68,71,74,78,82,86,91,95,98];
  const renovacao = [41,42,43,44,45,46,47,48,78,79,80,81,82,83,84,85];
  
  // Cobranças por semana (3/mês, distribuído)
  const cobrancas = [2,3,4,6,7,8,10,11,12,15,16,17,19,20,21,23,24,25,27,28,29,32,33,34,36,37,38,40,41,42,45,46,47,49,50,51,54,55,56,58,59,60,62,63,64,67,68,69,71,72,73,75,76,77,79,80,81,84,85,86,88,89,90,92,93,94,96,97,98];
  
  // Calcular mensagens por semana
  const dados_exemplar = semanas.map(s => {
    let count = 0;
    if (semanas_regua.includes(s)) count++;
    if (feriados.includes(s)) count++;
    if (renovacao.includes(s)) count++;
    return count;
  });
  
  const dados_inadimplente = semanas.map(s => {
    let count = 0;
    if (semanas_regua.includes(s)) count++;
    if (feriados.includes(s)) count++;
    if (renovacao.includes(s)) count++;
    if (cobrancas.includes(s)) count++;
    return count;
  });
  
  // Configurar datasets baseado no cenário
  let datasets = [];
  
  if (scenario === 'exemplar') {
    datasets = [{
      label: 'Aluno Exemplar (Adimplente)',
      data: dados_exemplar,
      borderColor: '#00FFB3',
      backgroundColor: 'rgba(0, 255, 179, 0.1)',
      borderWidth: 2,
      fill: true,
      tension: 0.1,
      pointRadius: 2,
      pointHoverRadius: 5,
      pointBackgroundColor: '#00FFB3'
    }];
  } else if (scenario === 'inadimplente') {
    datasets = [{
      label: 'Aluno Inadimplente (Pior Caso)',
      data: dados_inadimplente,
      borderColor: '#FF3366',
      backgroundColor: 'rgba(255, 51, 102, 0.1)',
      borderWidth: 2,
      fill: true,
      tension: 0.1,
      pointRadius: 2,
      pointHoverRadius: 5,
      pointBackgroundColor: '#FF3366'
    }];
  } else {
    datasets = [
      {
        label: 'Aluno Exemplar',
        data: dados_exemplar,
        borderColor: '#00FFB3',
        backgroundColor: 'rgba(0, 255, 179, 0.05)',
        borderWidth: 2,
        fill: true,
        tension: 0.1,
        pointRadius: 1,
        pointHoverRadius: 5
      },
      {
        label: 'Aluno Inadimplente',
        data: dados_inadimplente,
        borderColor: '#FF3366',
        backgroundColor: 'rgba(255, 51, 102, 0.05)',
        borderWidth: 2,
        fill: true,
        tension: 0.1,
        pointRadius: 1,
        pointHoverRadius: 5
      }
    ];
  }
  
  chartSemanaASemana = new Chart(ctx, {
    type: 'line',
    data: {
      labels: semanas.map(s => `S${s}`),
      datasets: datasets
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      interaction: {
        mode: 'index',
        intersect: false,
      },
      plugins: {
        legend: {
          position: 'top',
          labels: {
            color: '#E8F0FF',
            font: { size: 13, family: 'Outfit', weight: '600' },
            usePointStyle: true,
            padding: 15
          }
        },
        tooltip: {
          backgroundColor: 'rgba(20, 27, 46, 0.95)',
          titleColor: '#E8F0FF',
          bodyColor: '#94A8D8',
          borderColor: 'rgba(0, 102, 255, 0.5)',
          borderWidth: 1,
          padding: 15,
          displayColors: true,
          callbacks: {
            title: function(context) {
              const semana = context[0].label.replace('S', '');
              const mes = Math.floor(parseInt(semana) / 4) + 1;
              return `Semana ${semana} (Mês ~${mes})`;
            },
            label: function(context) {
              const msgs = context.parsed.y;
              const label = context.dataset.label;
              return `${label}: ${msgs} mensagem${msgs !== 1 ? 's' : ''}`;
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          max: 4,
          ticks: {
            stepSize: 1,
            color: '#94A8D8',
            font: { family: 'JetBrains Mono', size: 11 },
            callback: function(value) {
              return value + ' msg' + (value !== 1 ? 's' : '');
            }
          },
          grid: {
            color: 'rgba(0, 102, 255, 0.08)'
          }
        },
        x: {
          ticks: {
            color: '#94A8D8',
            font: { family: 'JetBrains Mono', size: 9 },
            maxRotation: 0,
            autoSkip: true,
            autoSkipPadding: 5,
            callback: function(value, index) {
              // Mostrar apenas múltiplos de 4 (1 por mês)
              return index % 4 === 0 ? this.getLabelForValue(value) : '';
            }
          },
          grid: {
            color: 'rgba(0, 102, 255, 0.05)'
          }
        }
      }
    }
  });
}

function renderGraficoDistribuicao() {
  // Gráfico Exemplar
  const ctxEx = document.getElementById('chartDistExemplar');
  if (ctxEx) {
    new Chart(ctxEx, {
      type: 'doughnut',
      data: {
        labels: ['0 msgs (15.2%)', '1 msg (68.7%)', '2 msgs (15.2%)', '3 msgs (1.0%)'],
        datasets: [{
          data: [15, 68, 15, 1],
          backgroundColor: [
            'rgba(148, 168, 216, 0.3)',
            'rgba(0, 255, 179, 0.8)',
            'rgba(255, 215, 0, 0.6)',
            'rgba(255, 51, 102, 0.5)'
          ],
          borderColor: [
            '#94A8D8',
            '#00FFB3',
            '#FFD700',
            '#FF3366'
          ],
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              color: '#E8F0FF',
              font: { size: 11, family: 'Outfit' },
              padding: 10
            }
          },
          tooltip: {
            backgroundColor: 'rgba(20, 27, 46, 0.95)',
            titleColor: '#E8F0FF',
            bodyColor: '#94A8D8',
            callbacks: {
              label: function(context) {
                return context.label + ': ' + context.parsed + ' semanas';
              }
            }
          }
        }
      }
    });
  }
  
  // Gráfico Inadimplente
  const ctxIn = document.getElementById('chartDistInadimplente');
  if (ctxIn) {
    new Chart(ctxIn, {
      type: 'doughnut',
      data: {
        labels: ['0 msgs (3.0%)', '1 msg (30.3%)', '2 msgs (58.6%)', '3 msgs (8.1%)'],
        datasets: [{
          data: [3, 30, 58, 8],
          backgroundColor: [
            'rgba(148, 168, 216, 0.3)',
            'rgba(0, 255, 179, 0.6)',
            'rgba(255, 215, 0, 0.8)',
            'rgba(255, 51, 102, 0.7)'
          ],
          borderColor: [
            '#94A8D8',
            '#00FFB3',
            '#FFD700',
            '#FF3366'
          ],
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              color: '#E8F0FF',
              font: { size: 11, family: 'Outfit' },
              padding: 10
            }
          },
          tooltip: {
            backgroundColor: 'rgba(20, 27, 46, 0.95)',
            titleColor: '#E8F0FF',
            bodyColor: '#94A8D8',
            callbacks: {
              label: function(context) {
                return context.label + ': ' + context.parsed + ' semanas';
              }
            }
          }
        }
      }
    });
  }
}


function renderGraficoVolumePorCenario() {
  const ctx = document.getElementById('chartVolumePorCenario');
  if (!ctx) return;
  
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Ano 1 (12 meses)', 'Ano 2 (12 meses)', 'Total (24 meses)'],
      datasets: [
        {
          label: 'Aluno Exemplar',
          data: [45, 48, 93],
          backgroundColor: 'rgba(0, 255, 179, 0.7)',
          borderColor: '#00FFB3',
          borderWidth: 2
        },
        {
          label: 'Baixa Frequência',
          data: [45, 48, 93],
          backgroundColor: 'rgba(255, 215, 0, 0.7)',
          borderColor: '#FFD700',
          borderWidth: 2
        },
        {
          label: 'Pior Caso',
          data: [81, 84, 165],
          backgroundColor: 'rgba(255, 51, 102, 0.7)',
          borderColor: '#FF3366',
          borderWidth: 2
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'top',
          labels: {
            color: '#E8F0FF',
            font: { size: 12, family: 'Outfit' }
          }
        },
        tooltip: {
          backgroundColor: 'rgba(20, 27, 46, 0.95)',
          titleColor: '#E8F0FF',
          bodyColor: '#94A8D8',
          borderColor: 'rgba(0, 102, 255, 0.3)',
          borderWidth: 1,
          padding: 12,
          displayColors: true,
          callbacks: {
            label: function(context) {
              return context.dataset.label + ': ' + context.parsed.y + ' mensagens';
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          grid: {
            color: 'rgba(0, 102, 255, 0.1)'
          },
          ticks: {
            color: '#94A8D8',
            font: { family: 'JetBrains Mono' }
          }
        },
        x: {
          grid: {
            display: false
          },
          ticks: {
            color: '#94A8D8',
            font: { family: 'Outfit' }
          }
        }
      }
    }
  });
}

// Gráfico 2: Média Semanal
function renderGraficoMediaSemanal() {
  const ctx = document.getElementById('chartMediaSemanal');
  if (!ctx) return;
  
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Ano 1', 'Ano 2'],
      datasets: [
        {
          label: 'Aluno Exemplar',
          data: [0.9, 1.0],
          borderColor: '#00FFB3',
          backgroundColor: 'rgba(0, 255, 179, 0.2)',
          borderWidth: 3,
          tension: 0.4,
          fill: true,
          pointRadius: 6,
          pointHoverRadius: 8
        },
        {
          label: 'Baixa Frequência',
          data: [0.9, 1.0],
          borderColor: '#FFD700',
          backgroundColor: 'rgba(255, 215, 0, 0.2)',
          borderWidth: 3,
          tension: 0.4,
          fill: true,
          pointRadius: 6,
          pointHoverRadius: 8
        },
        {
          label: 'Pior Caso',
          data: [1.6, 1.8],
          borderColor: '#FF3366',
          backgroundColor: 'rgba(255, 51, 102, 0.2)',
          borderWidth: 3,
          tension: 0.4,
          fill: true,
          pointRadius: 6,
          pointHoverRadius: 8
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'top',
          labels: {
            color: '#E8F0FF',
            font: { size: 12, family: 'Outfit' }
          }
        },
        tooltip: {
          backgroundColor: 'rgba(20, 27, 46, 0.95)',
          titleColor: '#E8F0FF',
          bodyColor: '#94A8D8',
          borderColor: 'rgba(0, 102, 255, 0.3)',
          borderWidth: 1,
          padding: 12,
          displayColors: true,
          callbacks: {
            label: function(context) {
              return context.dataset.label + ': ' + context.parsed.y + ' msgs/semana';
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          max: 2.5,
          grid: {
            color: 'rgba(0, 102, 255, 0.1)'
          },
          ticks: {
            color: '#94A8D8',
            font: { family: 'JetBrains Mono' },
            callback: function(value) {
              return value + ' msgs/sem';
            }
          }
        },
        x: {
          grid: {
            color: 'rgba(0, 102, 255, 0.05)'
          },
          ticks: {
            color: '#94A8D8',
            font: { family: 'Outfit' }
          }
        }
      }
    }
  });
}


function renderAnalyticsDashboard() {
  renderAnalyticsKPIs();
  renderWeeklyChart();
  renderPerformanceTable();
  renderTopMessages();
  renderABTests();
}

function renderAnalyticsKPIs() {
  const container = document.getElementById('analyticsKPIs');
  
  const kpis = [
    {
      label: 'Taxa de Abertura Média',
      value: '68%',
      trend: 'up',
      trendValue: '+5%',
      trendLabel: 'vs mês anterior'
    },
    {
      label: 'Taxa de Clique',
      value: '24%',
      trend: 'up',
      trendValue: '+2%',
      trendLabel: 'vs mês anterior'
    },
    {
      label: 'Taxa de Conversão',
      value: '12%',
      trend: 'down',
      trendValue: '-1%',
      trendLabel: 'vs mês anterior'
    },
    {
      label: 'Engajamento Geral',
      value: '8.2/10',
      trend: 'up',
      trendValue: '+0.3',
      trendLabel: 'vs mês anterior'
    }
  ];
  
  let html = '';
  kpis.forEach(kpi => {
    html += `
      <div class="metric-card">
        <div class="metric-label">${kpi.label}</div>
        <div class="metric-value">${kpi.value}</div>
        <div class="metric-trend ${kpi.trend}">
          ${kpi.trend === 'up' ? '↑' : kpi.trend === 'down' ? '↓' : '→'} 
          ${kpi.trendValue} <span style="opacity: 0.7; font-size: 0.75rem; margin-left: 4px;">${kpi.trendLabel}</span>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

function renderWeeklyChart() {
  const container = document.getElementById('weeklyChart');
  const legend = document.getElementById('chartLegend');
  
  const channels = [
    { name: 'WhatsApp', color: '#00FF88' },
    { name: 'E-mail', color: '#0066FF' },
    { name: 'Push', color: '#9D5CFF' },
    { name: 'SMS', color: '#FFB800' }
  ];
  
  const weekData = [
    { week: 'Semana 1', values: [45, 30, 15, 5] },
    { week: 'Semana 2', values: [52, 35, 18, 8] },
    { week: 'Semana 3', values: [48, 32, 20, 6] },
    { week: 'Semana 4', values: [50, 38, 16, 7] }
  ];
  
  // Render legend
  let legendHtml = '';
  channels.forEach(channel => {
    legendHtml += `
      <div class="legend-item">
        <div class="legend-color" style="background: ${channel.color}"></div>
        ${channel.name}
      </div>
    `;
  });
  legend.innerHTML = legendHtml;
  
  // Render chart
  let chartHtml = '';
  weekData.forEach(week => {
    const total = week.values.reduce((sum, val) => sum + val, 0);
    
    chartHtml += `
      <div class="bar-group">
        <div class="bar-label">${week.week}</div>
        <div class="bar-stack">
    `;
    
    week.values.forEach((value, idx) => {
      const percentage = (value / total) * 100;
      chartHtml += `
        <div class="bar-segment" 
             style="width: ${percentage}%; background: ${channels[idx].color}" 
             data-value="${value}"
             title="${channels[idx].name}: ${value} mensagens">
        </div>
      `;
    });
    
    chartHtml += `
        </div>
      </div>
    `;
  });
  
  container.innerHTML = chartHtml;
}

function renderPerformanceTable() {
  const tbody = document.getElementById('performanceBody');
  
  const phases = [
    { 
      name: 'Onboarding', 
      messages: 234, 
      open: 82, 
      click: 35, 
      conversion: 18,
      openTrend: 'up',
      clickTrend: 'up',
      conversionTrend: 'up'
    },
    { 
      name: 'Engajamento', 
      messages: 456, 
      open: 72, 
      click: 28, 
      conversion: 14,
      openTrend: 'neutral',
      clickTrend: 'up',
      conversionTrend: 'neutral'
    },
    { 
      name: 'Progressão', 
      messages: 189, 
      open: 65, 
      click: 22, 
      conversion: 10,
      openTrend: 'down',
      clickTrend: 'neutral',
      conversionTrend: 'down'
    },
    { 
      name: 'Recuperação', 
      messages: 78, 
      open: 45, 
      click: 12, 
      conversion: 5,
      openTrend: 'down',
      clickTrend: 'down',
      conversionTrend: 'down'
    }
  ];
  
  const getTrendIcon = (trend) => {
    if (trend === 'up') return '<span style="color: var(--green)">↑</span>';
    if (trend === 'down') return '<span style="color: var(--rose)">↓</span>';
    return '<span style="color: var(--txt3)">→</span>';
  };
  
  let html = '';
  phases.forEach(phase => {
    html += `
      <tr>
        <td>${phase.name}</td>
        <td><strong>${phase.messages}</strong></td>
        <td><strong>${phase.open}%</strong> ${getTrendIcon(phase.openTrend)}</td>
        <td><strong>${phase.click}%</strong> ${getTrendIcon(phase.clickTrend)}</td>
        <td><strong>${phase.conversion}%</strong> ${getTrendIcon(phase.conversionTrend)}</td>
      </tr>
    `;
  });
  
  tbody.innerHTML = html;
}

function renderTopMessages() {
  const container = document.getElementById('topMessages');
  
  const topMessages = [
    { rank: 1, name: 'Boas-vindas - Dia 1', open: 92, click: 45, class: 'gold' },
    { rank: 2, name: 'Primeira Conquista', open: 88, click: 40, class: 'silver' },
    { rank: 3, name: 'Marco de 25%', open: 85, click: 38, class: 'bronze' },
    { rank: 4, name: 'Dica de Estudo - Dia 5', open: 78, click: 32, class: '' },
    { rank: 5, name: 'Check-in Semanal', open: 75, click: 28, class: '' }
  ];
  
  let html = '';
  topMessages.forEach(msg => {
    html += `
      <div class="top-message-card">
        <div class="message-rank ${msg.class}">
          ${msg.rank === 1 ? '🥇' : msg.rank === 2 ? '🥈' : msg.rank === 3 ? '🥉' : msg.rank}
        </div>
        <div class="message-info">
          <div class="message-name">${msg.name}</div>
          <div class="message-stats">
            <div class="message-stat">
              📧 <strong>${msg.open}%</strong> abertura
            </div>
            <div class="message-stat">
              👆 <strong>${msg.click}%</strong> clique
            </div>
          </div>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

function renderABTests() {
  const container = document.getElementById('abTests');
  
  const tests = [
    {
      title: 'Teste: Horário de Envio',
      subtitle: 'E-mail Boas-vindas',
      status: 'active',
      variants: [
        { label: 'Variante A (9h)', value: '75%', winner: false },
        { label: 'Variante B (19h)', value: '82%', winner: true }
      ],
      confidence: 95
    },
    {
      title: 'Teste: Tom de Voz',
      subtitle: 'WhatsApp Recuperação',
      status: 'active',
      variants: [
        { label: 'Variante A (Formal)', value: '42%', winner: false },
        { label: 'Variante B (Casual)', value: '58%', winner: true }
      ],
      confidence: 89
    }
  ];
  
  let html = '';
  tests.forEach(test => {
    html += `
      <div class="ab-test-card">
        <div class="ab-test-header">
          <div class="ab-test-info">
            <div class="ab-test-title">🧪 ${test.title}</div>
            <div class="ab-test-subtitle">${test.subtitle}</div>
          </div>
          <div class="ab-test-badge ${test.status}">
            ${test.status === 'active' ? '✓ ATIVO' : 'CONCLUÍDO'}
          </div>
        </div>
        
        <div class="ab-variants">
    `;
    
    test.variants.forEach(variant => {
      html += `
        <div class="ab-variant ${variant.winner ? 'winner' : ''}">
          <div class="ab-variant-label">
            ${variant.label}
            ${variant.winner ? '<span style="margin-left: 8px;">✓</span>' : ''}
          </div>
          <div class="ab-variant-value">${variant.value}</div>
        </div>
      `;
    });
    
    html += `
        </div>
        <div class="ab-confidence">
          Confiança estatística: <strong>${test.confidence}%</strong>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

// ═══════════════════════════════════════════════════════════
// CÁLCULOS E ANÁLISES ATUALIZADAS DA RÉGUA COMPLETA
// ═══════════════════════════════════════════════════════════

function calcularMensagensAno() {
  // ═══════════════════════════════════════════════════════════
  // CONTAGEM REAL baseada na análise completa do weekMessages
  // ═══════════════════════════════════════════════════════════
  
  // 1. SEMANAS NUMÉRICAS: 61 semanas com mensagens (0, 2, 4, 6... até 98)
  const semanasNumericas = 61;
  
  // 2. CHECKPOINTS OFICIAIS: 6 checkpoints trimestrais
  // (12+, 24+, 36+, 48+, 50+, 60+)
  const checkpoints = 6;
  
  // 3. BLACKOUTS (não enviam mensagem):
  // - Semana 41: BLACKOUT 12M (semanas 41-47 = 7 semanas paradas)
  // - Semana 78: BLACKOUT 24M (semanas 78-83 = 6 semanas paradas)
  const blackouts = 2;
  
  // 4. CONDICIONAL (semana 48 - só envia se renovar, não conta)
  const condicionais = 1;
  
  // TOTAL: 61 + 6 - 2 blackouts - 1 condicional = 64 mensagens
  const totalMensagensRegua = semanasNumericas + checkpoints - blackouts - condicionais;
  
  // Análise temporal (2 anos = 104 semanas)
  const semanasTotal = 104;
  const semanasComMensagem = totalMensagensRegua; // 64
  const semanasSemMensagem = semanasTotal - semanasComMensagem; // 40
  
  // Período de BLACKOUTS
  const semanasBLACKOUT12M = 7; // semanas 41-47
  const semanasBLACKOUT24M = 6; // semanas 78-83
  const totalSemanasBLACKOUT = semanasBLACKOUT12M + semanasBLACKOUT24M; // 13
  
  // Semanas livres (sem mensagem e sem BLACKOUT)
  const semanasLivres = semanasSemMensagem - totalSemanasBLACKOUT; // 27
  
  return {
    // Composição
    numericas: semanasNumericas,
    checkpoints: checkpoints,
    blackouts: blackouts,
    
    // Total
    total: totalMensagensRegua, // 64
    
    // Análise temporal
    semanasTotal: semanasTotal, // 104
    semanasComMensagem: semanasComMensagem, // 64
    semanasSemMensagem: semanasSemMensagem, // 40
    
    // BLACKOUTs
    semanasBLACKOUT12M: semanasBLACKOUT12M,
    semanasBLACKOUT24M: semanasBLACKOUT24M,
    totalSemanasBLACKOUT: totalSemanasBLACKOUT,
    
    // Semanas livres
    semanasLivres: semanasLivres, // 27
    
    // Métricas
    taxaCobertura: ((semanasComMensagem / semanasTotal) * 100).toFixed(1),
    mediaSemanal: (totalMensagensRegua / semanasTotal).toFixed(1),
    mediaMensal: (totalMensagensRegua / 24).toFixed(1),
    
    // Distribuição
    ano1Estimado: 38,
    ano2Estimado: 26
  };
}

function calcularCenarioFinanceiro() {
  const dados = calcularMensagensAno();
  
  // Cenário 1: Aluno em dia (pagamentos normais)
  const emDia = {
    cs: dados.total, // 64 mensagens
    financeiro: 0,
    total: dados.total,
    descricao: 'Pagando em dia',
    porSemana: (dados.total / dados.semanasTotal).toFixed(1) // 0.6/semana
  };
  
  // Cenário 2: Devendo 1 mensalidade
  // Time financeiro envia 1 msg/dia durante 30 dias
  const umaMensalidade = {
    cs: dados.total,
    financeiro: 30,
    total: dados.total + 30,
    descricao: 'Devendo 1 mês',
    porSemana: ((dados.total + 30) / dados.semanasTotal).toFixed(1)
  };
  
  // Cenário 3: Devedor crônico (5 meses atrasados)
  // Time financeiro envia 1 msg/dia durante 150 dias
  const devedorCronico = {
    cs: dados.total,
    financeiro: 150,
    total: dados.total + 150,
    descricao: 'Devendo 5 meses',
    porSemana: ((dados.total + 150) / dados.semanasTotal).toFixed(1)
  };
  
  return { emDia, umaMensalidade, devedorCronico };
}

function renderStats() {
  const container = document.getElementById('statsGrid');
  const dados = calcularMensagensAno();
  const cenarios = calcularCenarioFinanceiro();
  
  const stats = [
    {
      icon: '📨',
      label: 'Total de Mensagens',
      value: dados.total,
      detail: `em 24 meses (2 anos)`,
      color: 'var(--wu-blue)'
    },
    {
      icon: '📅',
      label: 'Semanas com Mensagem',
      value: dados.semanasComMensagem,
      detail: `de ${dados.semanasTotal} semanas (${dados.taxaCobertura}%)`,
      color: 'var(--green)'
    },
    {
      icon: '🎯',
      label: 'Checkpoints Oficiais',
      value: dados.checkpoints,
      detail: 'testes trimestrais obrigatórios',
      color: 'var(--purple)'
    },
    {
      icon: '🔕',
      label: 'Semanas Livres',
      value: dados.semanasLivres,
      detail: `respiração estratégica`,
      color: 'var(--teal)'
    },
    {
      icon: '⏸️',
      label: 'Semanas BLACKOUT',
      value: dados.totalSemanasBLACKOUT,
      detail: `${dados.semanasBLACKOUT12M} (12M) + ${dados.semanasBLACKOUT24M} (24M)`,
      color: 'var(--amber)'
    },
    {
      icon: '📊',
      label: 'Densidade Média',
      value: dados.mediaMensal,
      detail: 'mensagens/mês',
      color: 'var(--wu-cyan)'
    }
  ];
  
  let html = '';
  stats.forEach(stat => {
    html += `
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon" style="background: ${stat.color}22; border-color: ${stat.color};">
            ${stat.icon}
          </div>
        </div>
        <div class="stat-label">${stat.label}</div>
        <div class="stat-value">${stat.value}</div>
        <div class="stat-detail">${stat.detail}</div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

function renderTimelineChart() {
  const container = document.getElementById('timelineChart');
  const dados = calcularMensagensAno();
  
  const phases = [
    { 
      name: 'Mensagens Regulares', 
      count: dados.numericas - dados.blackouts, 
      max: 70, 
      color: 'var(--wu-blue)',
      detail: `${dados.numericas} semanas - ${dados.blackouts} BLACKOUTs`
    },
    { 
      name: 'Checkpoints Trimestrais', 
      count: dados.checkpoints, 
      max: 70, 
      color: 'var(--purple)',
      detail: 'Testes oficiais obrigatórios'
    },
    { 
      name: 'Semanas Livres (Respiração)', 
      count: dados.semanasLivres, 
      max: 70, 
      color: 'var(--green)',
      detail: 'Sem mensagem programada'
    },
    { 
      name: 'Períodos BLACKOUT', 
      count: dados.totalSemanasBLACKOUT, 
      max: 70, 
      color: 'var(--amber)',
      detail: `${dados.semanasBLACKOUT12M} semanas (12M) + ${dados.semanasBLACKOUT24M} (24M)`
    }
  ];
  
  let html = '';
  phases.forEach(phase => {
    const percentage = (phase.count / phase.max) * 100;
    html += `
      <div class="timeline-bar">
        <div class="timeline-label">
          ${phase.name}
          <div style="font-size:0.7rem;color:var(--txt3);margin-top:4px">${phase.detail}</div>
        </div>
        <div class="timeline-bar-container">
          <div class="timeline-bar-fill" style="width: ${Math.min(percentage, 100)}%; background: ${phase.color}">
            <span class="timeline-bar-value">${phase.count}</span>
          </div>
        </div>
      </div>
    `;
  });
  
  // Adicionar resumo visual
  html += `
    <div style="margin-top:24px;padding:20px;background:var(--card-hi);border-radius:12px;border:1px solid var(--border)">
      <div style="font-size:0.9rem;font-weight:600;color:var(--txt1);margin-bottom:12px">📊 Distribuição Temporal (104 semanas)</div>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;font-size:0.85rem">
        <div style="padding:12px;background:var(--card);border-radius:8px;border-left:3px solid var(--wu-blue)">
          <div style="color:var(--txt3);margin-bottom:4px">Com Mensagem</div>
          <div style="font-size:1.5rem;font-weight:700;color:var(--wu-blue)">${dados.semanasComMensagem}</div>
          <div style="color:var(--txt3);font-size:0.75rem">${dados.taxaCobertura}% da jornada</div>
        </div>
        <div style="padding:12px;background:var(--card);border-radius:8px;border-left:3px solid var(--green)">
          <div style="color:var(--txt3);margin-bottom:4px">Livres (Respiração)</div>
          <div style="font-size:1.5rem;font-weight:700;color:var(--green)">${dados.semanasLivres}</div>
          <div style="color:var(--txt3);font-size:0.75rem">${((dados.semanasLivres/dados.semanasTotal)*100).toFixed(1)}% sem contato</div>
        </div>
        <div style="padding:12px;background:var(--card);border-radius:8px;border-left:3px solid var(--amber)">
          <div style="color:var(--txt3);margin-bottom:4px">BLACKOUT (Comercial)</div>
          <div style="font-size:1.5rem;font-weight:700;color:var(--amber)">${dados.totalSemanasBLACKOUT}</div>
          <div style="color:var(--txt3);font-size:0.75rem">Time de renovação atua</div>
        </div>
      </div>
    </div>
  `;
  
  container.innerHTML = html;
}

function renderTagBreakdown() {
  const container = document.getElementById('tagBreakdown');
  const cenarios = calcularCenarioFinanceiro();
  
  const items = [
    { 
      icon: '📱', 
      name: 'WhatsApp', 
      count: '~95%',
      detail: 'Canal principal de CS'
    },
    { 
      icon: '📧', 
      name: 'E-mail', 
      count: '~5%',
      detail: 'Checkpoints e formais'
    },
    { 
      icon: '✅', 
      name: 'Em Dia', 
      count: cenarios.emDia.total,
      detail: `${cenarios.emDia.porSemana} msgs/sem`
    },
    { 
      icon: '⚠️', 
      name: '1 Mês Atraso', 
      count: cenarios.umaMensalidade.total,
      detail: `${cenarios.umaMensalidade.porSemana} msgs/sem`
    },
    { 
      icon: '🚨', 
      name: '5 Meses Atraso', 
      count: cenarios.devedorCronico.total,
      detail: `${cenarios.devedorCronico.porSemana} msgs/sem`
    },
    {
      icon: '💰',
      name: 'Time Financeiro',
      count: '1/dia',
      detail: 'Para alunos inadimplentes'
    }
  ];
  
  let html = '';
  items.forEach(item => {
    html += `
      <div class="channel-item">
        <div class="channel-icon">${item.icon}</div>
        <div class="channel-info">
          <div class="channel-name">${item.name}</div>
          <div class="channel-count">${item.count}</div>
          <div style="font-size:0.7rem;color:var(--txt3);margin-top:2px">${item.detail}</div>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

function renderCenariosFinanceiros() {
  const container = document.getElementById('cenariosFinanceiros');
  const cenarios = calcularCenarioFinanceiro();
  
  const cards = [
    {
      titulo: '✅ Aluno em Dia',
      cor: 'var(--green)',
      bg: 'var(--green-lo)',
      dados: cenarios.emDia
    },
    {
      titulo: '⚠️ Devendo 1 Mês',
      cor: 'var(--amber)',
      bg: 'var(--amber-lo)',
      dados: cenarios.umaMensalidade
    },
    {
      titulo: '🚨 Devendo 5 Meses',
      cor: 'var(--rose)',
      bg: 'var(--rose-lo)',
      dados: cenarios.devedorCronico
    }
  ];
  
  let html = '';
  cards.forEach(card => {
    html += `
      <div style="background:${card.bg};border:2px solid ${card.cor};border-radius:12px;padding:20px">
        <div style="font-size:1rem;font-weight:700;color:${card.cor};margin-bottom:16px">${card.titulo}</div>
        <div style="display:grid;gap:12px">
          <div>
            <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:4px">Total de Mensagens/Ano</div>
            <div style="font-size:2.5rem;font-weight:800;color:var(--txt1)">${card.dados.total}</div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;font-size:0.8rem">
            <div style="padding:10px;background:var(--card);border-radius:8px">
              <div style="color:var(--txt3);margin-bottom:2px">CS</div>
              <div style="font-weight:700;color:var(--txt1)">${card.dados.cs}</div>
            </div>
            <div style="padding:10px;background:var(--card);border-radius:8px">
              <div style="color:var(--txt3);margin-bottom:2px">Fin.</div>
              <div style="font-weight:700;color:${card.cor}">${card.dados.financeiro}</div>
            </div>
          </div>
          <div style="padding:10px;background:var(--card);border-radius:8px;text-align:center">
            <div style="font-size:0.75rem;color:var(--txt3);margin-bottom:2px">Média Semanal</div>
            <div style="font-size:1.3rem;font-weight:700;color:${card.cor}">${card.dados.porSemana}</div>
            <div style="font-size:0.7rem;color:var(--txt3)">msgs/semana</div>
          </div>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

function renderComparisonChart() {
  const container = document.getElementById('comparisonChart');
  const cenarios = calcularCenarioFinanceiro();
  
  const maxValue = cenarios.devedorCronico.total;
  
  const data = [
    {
      label: 'Aluno em Dia',
      cs: cenarios.emDia.cs,
      fin: cenarios.emDia.financeiro,
      total: cenarios.emDia.total,
      cor: 'var(--green)'
    },
    {
      label: 'Devendo 1 Mês',
      cs: cenarios.umaMensalidade.cs,
      fin: cenarios.umaMensalidade.financeiro,
      total: cenarios.umaMensalidade.total,
      cor: 'var(--amber)'
    },
    {
      label: 'Devendo 5 Meses',
      cs: cenarios.devedorCronico.cs,
      fin: cenarios.devedorCronico.financeiro,
      total: cenarios.devedorCronico.total,
      cor: 'var(--rose)'
    }
  ];
  
  let html = '<div style="display:grid;gap:20px">';
  
  data.forEach(item => {
    const percentCS = (item.cs / maxValue) * 100;
    const percentFin = (item.fin / maxValue) * 100;
    
    html += `
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <div style="font-weight:600;color:var(--txt1)">${item.label}</div>
          <div style="font-weight:700;color:${item.cor};font-size:1.1rem">${item.total} msgs</div>
        </div>
        <div style="display:flex;gap:4px;height:40px;border-radius:8px;overflow:hidden;background:var(--card)">
          <div style="width:${percentCS}%;background:var(--wu-blue);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;font-size:0.85rem">
            ${item.cs > 0 ? `CS: ${item.cs}` : ''}
          </div>
          <div style="width:${percentFin}%;background:${item.cor};display:flex;align-items:center;justify-content:center;color:white;font-weight:600;font-size:0.85rem">
            ${item.fin > 0 ? `Fin: ${item.fin}` : ''}
          </div>
        </div>
      </div>
    `;
  });
  
  html += '</div>';
  
  // Legenda
  html += `
    <div style="display:flex;gap:20px;justify-content:center;margin-top:24px;flex-wrap:wrap">
      <div style="display:flex;align-items:center;gap:8px">
        <div style="width:20px;height:20px;background:var(--wu-blue);border-radius:4px"></div>
        <span style="font-size:0.85rem;color:var(--txt2)">Mensagens CS</span>
      </div>
      <div style="display:flex;align-items:center;gap:8px">
        <div style="width:20px;height:20px;background:var(--amber);border-radius:4px"></div>
        <span style="font-size:0.85rem;color:var(--txt2)">Mensagens Financeiro</span>
      </div>
    </div>
  `;
  
  container.innerHTML = html;
  
  // Atualizar valores nos breakdowns
  document.getElementById('cenario1-cs').textContent = cenarios.emDia.cs;
  document.getElementById('cenario1-total').textContent = cenarios.emDia.total;
  document.getElementById('cenario1-semanal').textContent = cenarios.emDia.porSemana;
  
  document.getElementById('cenario2-cs').textContent = cenarios.umaMensalidade.cs;
  document.getElementById('cenario2-fin').textContent = cenarios.umaMensalidade.financeiro;
  document.getElementById('cenario2-total').textContent = cenarios.umaMensalidade.total;
  document.getElementById('cenario2-semanal').textContent = cenarios.umaMensalidade.porSemana;
  
  document.getElementById('cenario3-cs').textContent = cenarios.devedorCronico.cs;
  document.getElementById('cenario3-fin').textContent = cenarios.devedorCronico.financeiro;
  document.getElementById('cenario3-total').textContent = cenarios.devedorCronico.total;
  document.getElementById('cenario3-semanal').textContent = cenarios.devedorCronico.porSemana;
}

function getUniqueTags() {
  // Função mantida para compatibilidade mas não mais usada no resumo
  return [];
}

// ═══════════════════════════════════════════════════════════
// TOGGLE SECTION (MINIMIZE/EXPAND)
// ═══════════════════════════════════════════════════════════
function toggleSection(titleElement) {
  const content = titleElement.nextElementSibling;
  const toggle = titleElement.querySelector('.summary-toggle');
  
  content.classList.toggle('collapsed');
  toggle.classList.toggle('collapsed');
}

// ═══════════════════════════════════════════════════════════
// TOGGLE PREFERENCE (ON/OFF SWITCHES)
// ═══════════════════════════════════════════════════════════
function togglePreference(toggleElement) {
  const isActive = toggleElement.getAttribute('data-active') === 'true';
  toggleElement.setAttribute('data-active', !isActive);
}

// ═══════════════════════════════════════════════════════════
// INITIALIZE
// ═══════════════════════════════════════════════════════════
document.addEventListener('DOMContentLoaded', function() {
  renderTimeline('fases');
  renderResumo();
  
  // Renderizar novos dashboards financeiros
  renderCenariosFinanceiros();
  renderComparisonChart();
  
  // Iniciar todas as seções do resumo colapsadas
  document.querySelectorAll('#resumo .summary-content').forEach(content => {
    content.classList.add('collapsed');
  });
  document.querySelectorAll('#resumo .summary-toggle').forEach(toggle => {
    toggle.classList.add('collapsed');
  });
});
</script>

</body>
</html>
